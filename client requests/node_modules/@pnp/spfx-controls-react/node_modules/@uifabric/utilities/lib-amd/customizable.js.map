{"version":3,"file":"customizable.js","sourceRoot":"../src/","sources":["customizable.tsx"],"names":[],"mappings":";;;IASA,sBACE,KAAa,EACb,MAAgB;IAChB,kCAAkC;;QAGlC,gDAAgD;QAChD,OAAO;QACL,kCAAkC;QAClC,iBAA4E;QAC5E,kCAAkC;;YAElC,IAAM,WAAW;oBAA4C,sDAAsB;oBASjF,kCAAkC;oBAClC,oCAAY,KAAQ,EAAE,OAAY;wBAAlC,YACE,kBAAM,KAAK,EAAE,OAAO,CAAC,SAGtB;wBADC,KAAI,CAAC,iBAAiB,GAAG,KAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;oBAC7D,CAAC;oBAEM,sDAAiB,GAAxB;wBACE,+BAAc,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;oBACjD,CAAC;oBAEM,yDAAoB,GAA3B;wBACE,+BAAc,CAAC,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;oBACnD,CAAC;oBAEM,2CAAM,GAAb;wBACE,IAAM,YAAY,GAAG,+BAAc,CAAC,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;wBAE5F,OAAO;wBACL,kCAAkC;wBAClC,oBAAC,iBAAiB,uBAAM,YAAY,EAAQ,IAAI,CAAC,KAAY,EAAK,CACnE,CAAC;oBACJ,CAAC;oBAEO,sDAAiB,GAAzB;wBACE,IAAI,CAAC,WAAW,EAAE,CAAC;oBACrB,CAAC;oBAEH,iCAAC;gBAAD,CAAC,AArCmB,CAAyC,KAAK,CAAC,SAAS;gBAC5D,cAAW,GAAW,YAAY,GAAG,KAAM;gBAE3C,eAAY,GAEtB;oBACA,cAAc,EAAE,SAAS,CAAC,MAAM;iBAChC;mBA8BL,CAAC;YAEF,OAAO,2BAAY,CAAC,iBAAiB,EAAE,WAAW,CAAC,CAAC;;QACtD,CAAC,CAAC;IACJ,CAAC;IArDD,oCAqDC","sourcesContent":["import * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport {\n  Customizations,\n} from './Customizations';\nimport {\n  hoistStatics\n} from './hoistStatics';\n\nexport function customizable(\n  scope: string,\n  fields: string[]\n  // tslint:disable-next-line:no-any\n): <P, S>(ComposedComponent: new (props: P, ...args: any[]) => React.Component<P, S>) => any {\n\n  // tslint:disable-next-line:no-shadowed-variable\n  return function customizableFactory<P, S>(\n    // tslint:disable-next-line:no-any\n    ComposedComponent: (new (props: P, ...args: any[]) => React.Component<P, S>)\n    // tslint:disable-next-line:no-any\n  ): any {\n    const resultClass = class ComponentWithInjectedProps extends React.Component<P, {}> {\n      public static displayName: string = 'Customized' + scope;\n\n      public static contextTypes: {\n        customizations: PropTypes.Requireable<{}>;\n      } = {\n          customizations: PropTypes.object\n        };\n\n      // tslint:disable-next-line:no-any\n      constructor(props: P, context: any) {\n        super(props, context);\n\n        this._onSettingChanged = this._onSettingChanged.bind(this);\n      }\n\n      public componentDidMount(): void {\n        Customizations.observe(this._onSettingChanged);\n      }\n\n      public componentWillUnmount(): void {\n        Customizations.unobserve(this._onSettingChanged);\n      }\n\n      public render(): JSX.Element {\n        const defaultProps = Customizations.getSettings(fields, scope, this.context.customizations);\n\n        return (\n          // tslint:disable-next-line:no-any\n          <ComposedComponent { ...defaultProps } { ...this.props as any } />\n        );\n      }\n\n      private _onSettingChanged(): void {\n        this.forceUpdate();\n      }\n\n    };\n\n    return hoistStatics(ComposedComponent, resultClass);\n  };\n}\n"]}