{"version":3,"sources":["services/FolderExplorerService.ts"],"names":[],"mappings":"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","file":"services/FolderExplorerService.js","sourcesContent":["import { ServiceKey, ServiceScope } from \"@microsoft/sp-core-library\";\nimport { PageContext } from \"@microsoft/sp-page-context\";\nimport { IFolderExplorerService } from \"./IFolderExplorerService\";\nimport { IFolder } from \"./IFolderExplorerService\";\nimport { sp, Web, List, FolderAddResult } from \"@pnp/sp\";\n\nexport class FolderExplorerService implements IFolderExplorerService {\n\n  public static readonly serviceKey: ServiceKey<IFolderExplorerService> = ServiceKey.create<IFolderExplorerService>('SPFx:SPService', FolderExplorerService);\n\n  constructor(serviceScope: ServiceScope) {\n\n    serviceScope.whenFinished(() => {\n\n      const pageContext = serviceScope.consume(PageContext.serviceKey);\n      sp.setup({\n        sp: {\n          baseUrl: pageContext.web.absoluteUrl\n        }\n      });\n    });\n  }\n\n  /**\n   * Get libraries within a given site\n   * @param webAbsoluteUrl - the url of the target site\n   */\n  public GetDocumentLibraries = async (webAbsoluteUrl: string): Promise<IFolder[]> => {\n    return this._getDocumentLibraries(webAbsoluteUrl);\n  }\n\n  /**\n   * Get libraries within a given site\n   * @param webAbsoluteUrl - the url of the target site\n   */\n  private _getDocumentLibraries = async (webAbsoluteUrl: string): Promise<IFolder[]> => {\n    let results: IFolder[] = [];\n    try {\n      const web = new Web(webAbsoluteUrl);\n      const libraries: any[] = await web.lists.filter('BaseTemplate eq 101 and Hidden eq false').expand('RootFolder').select('Title', 'RootFolder/ServerRelativeUrl').orderBy('Title').get();\n\n      results = libraries.map((library): IFolder => {\n        return { Name: library.Title, ServerRelativeUrl: library.RootFolder.ServerRelativeUrl };\n      });\n    } catch (error) {\n      console.error('Error loading folders', error);\n    }\n    return results;\n\n  }\n\n  /**\n * Get folders within a given library or sub folder\n * @param webAbsoluteUrl - the url of the target site\n * @param folderRelativeUrl - the relative url of the folder\n */\n  public GetFolders = async (webAbsoluteUrl: string, folderRelativeUrl: string): Promise<IFolder[]> => {\n    return this._getFolders(webAbsoluteUrl, folderRelativeUrl);\n  }\n\n  /**\n   * Get folders within a given library or sub folder\n   * @param webAbsoluteUrl - the url of the target site\n   * @param folderRelativeUrl - the relative url of the folder\n   */\n  private _getFolders = async (webAbsoluteUrl: string, folderRelativeUrl: string): Promise<IFolder[]> => {\n    let results: IFolder[] = [];\n    try {\n      const web = new Web(webAbsoluteUrl);\n      folderRelativeUrl = folderRelativeUrl.replace(/\\'/ig, \"''\");\n      let foldersResult: IFolder[] = await web.getFolderByServerRelativeUrl(folderRelativeUrl).folders.select('Name', 'ServerRelativeUrl').orderBy('Name').get();\n      results = foldersResult.filter(f => f.Name != \"Forms\");\n    } catch (error) {\n      console.error('Error loading folders', error);\n    }\n    return results;\n  }\n\n  /**\n   * Create a new folder\n   * @param webAbsoluteUrl - the url of the target site\n   * @param folderRelativeUrl - the relative url of the base folder\n   * @param name - the name of the folder to be created\n   */\n  public AddFolder = async (webAbsoluteUrl: string, folderRelativeUrl: string, name: string): Promise<IFolder> => {\n    return this._addFolder(webAbsoluteUrl, folderRelativeUrl, name);\n  }\n\n  /**\n * Create a new folder\n * @param webAbsoluteUrl - the url of the target site\n * @param folderRelativeUrl - the relative url of the base folder\n * @param name - the name of the folder to be created\n */\n  private _addFolder = async (webAbsoluteUrl: string, folderRelativeUrl: string, name: string): Promise<IFolder> => {\n    let folder: IFolder = null;\n    try {\n      const web = new Web(webAbsoluteUrl);\n      let folderAddResult: FolderAddResult = await web.getFolderByServerRelativeUrl(folderRelativeUrl).folders.add(name);\n      if (folderAddResult && folderAddResult.data) {\n        folder = {\n          Name: folderAddResult.data.Name,\n          ServerRelativeUrl: folderAddResult.data.ServerRelativeUrl\n        };\n      }\n    } catch (error) {\n      console.error('Error adding folder', error);\n    }\n    return folder;\n  }\n\n}\n"],"sourceRoot":"../../src"}