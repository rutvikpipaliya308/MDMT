{"version":3,"sources":["controls/iFramePanel/IFramePanelContent.tsx"],"names":[],"mappings":"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","file":"controls/iFramePanel/IFramePanelContent.js","sourcesContent":["import * as React from \"react\";\nimport styles from './IFramePanelContent.module.scss';\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/Spinner';\nimport omit = require('lodash/omit');\nimport { IIFramePanelContentProps, IIFramePanelContentState } from \".\";\n\n/**\n * IFrame Panel content\n */\nexport class IFramePanelContent extends React.Component<IIFramePanelContentProps, IIFramePanelContentState> {\n  private _iframe: any;\n\n  constructor(props: IIFramePanelContentProps) {\n    super(props);\n\n    this.state = {\n      isContentVisible: false\n    };\n    window.onresize = this.resizeIframe;\n  }\n\n  /**\n   * Resize the iframe element\n   */\n  private resizeIframe = () => {\n    if (!this.props.height) {\n      if (this._iframe) {\n        const mainDiv = this.findParent(this._iframe, \"ms-Panel-main\");\n        const commandsDiv = mainDiv.querySelector(\".ms-Panel-commands\") as HTMLDivElement;\n        const headerDiv = mainDiv.querySelector(\".ms-Panel-header\") as HTMLDivElement;\n        const footerDiv = mainDiv.querySelector(\".ms-Panel-footer\") as HTMLDivElement;\n\n        let height = this.getTrueHeight(mainDiv);\n        height = height - this.getTrueHeight(commandsDiv);\n        height = height - this.getTrueHeight(headerDiv);\n        height = height - this.getTrueHeight(footerDiv);\n        height = height - 25;  // padding on content div\n\n        this._iframe.height = height.toString() + 'px';\n      }\n    }\n  }\n\n  /**\n   * Find the parent element\n   *\n   * @param elm\n   * @param className\n   */\n  private findParent(elm: HTMLElement, className: string) {\n    while ((elm = elm.parentElement) && !elm.classList.contains(className));\n    return elm;\n  }\n\n  /**\n   * Get the element its height\n   *\n   * @param elm\n   */\n  private getTrueHeight(elm: HTMLElement): number {\n    if (elm) {\n      const style = window.getComputedStyle && window.getComputedStyle(elm) || elm.style;\n      let marginTop = parseInt((style.marginTop as string).replace(\"px\", \"\"));\n      let marginBottom = parseInt((style.marginBottom as string).replace(\"px\", \"\"));\n      if (isNaN(marginTop)) {\n        marginTop = 0;\n      }\n      if (isNaN(marginBottom)) {\n        marginBottom = 0;\n      }\n      return elm.offsetHeight + marginTop + marginBottom;\n    } else {\n      return 0;\n    }\n  }\n\n  /**\n   * On iframe load event\n   */\n  private iframeOnLoad = () => {\n    try { // for cross origin requests we can have issues with accessing frameElement\n      this._iframe.contentWindow.frameElement.cancelPopUp = this.props.close;\n      this._iframe.contentWindow.frameElement.commitPopUp = this.props.close;\n      // SP.UI.Dialog has misspelling of commitPopUp\n      this._iframe.contentWindow.frameElement.commitPopup = this.props.close;\n    }\n    catch (err) {\n      if (err.name !== 'SecurityError') {\n        throw err;\n      }\n    }\n\n    this.resizeIframe();\n\n    if (this.props.iframeOnLoad) {\n      this.props.iframeOnLoad(this._iframe);\n    }\n\n    this.setState({\n      isContentVisible: true\n    });\n  }\n\n  /**\n   * Default React render\n   */\n  public render(): JSX.Element {\n    return (\n      <div className={styles.iFrameDialog}>\n        <iframe ref={(iframe) => { this._iframe = iframe; }} frameBorder={0} onLoad={this.iframeOnLoad} style={{ width: '100%', height: this.props.height, visibility: this.state.isContentVisible ? 'visible' : 'hidden' }} {...omit(this.props, 'height')} />\n\n        {\n          !this.state.isContentVisible && (\n            <div className={styles.spinnerContainer}>\n              <Spinner size={SpinnerSize.large} />\n            </div>\n          )\n        }\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"../../../src"}