{"version":3,"sources":["controls/richText/RichText.tsx"],"names":[],"mappings":"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","file":"controls/richText/RichText.js","sourcesContent":["import * as React from 'react';\nimport * as strings from 'ControlStrings';\nimport 'react-quill/dist/quill.snow.css';\nimport RichTextPropertyPane from './RichTextPropertyPane';\nimport ReactQuill, { Quill } from 'react-quill';\nimport styles from './RichText.module.scss';\nimport { IRichTextProps, IRichTextState } from './RichText.types';\nimport { IconButton } from 'office-ui-fabric-react/lib/Button';\nimport { Guid } from '@microsoft/sp-core-library';\nimport { TooltipHost } from 'office-ui-fabric-react/lib/Tooltip';\nimport { Dialog, DialogType, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\nimport { Link } from 'office-ui-fabric-react/lib/Link';\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\nimport { Icon } from 'office-ui-fabric-react/lib/Icon';\nimport { elementContains } from 'office-ui-fabric-react/lib/Utilities';\nimport * as telemetry from '../../common/telemetry';\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons';\nimport isEqual = require('lodash/isEqual');\n\n\nconst TOOLBARPADDING: number = 28;\n/**\n * Creates a rich text editing control that mimics the out-of-the-box\n * SharePoint Rich Text control.\n * NOTE:\n * Quill.js has a few quirks that we can't work around\n * - Block quotes only work on single lines. This is a frequently-requested feature with Quill that isn't available yet.\n * - Tables aren't supported yet. I'll gladly add table formatting support if users request it.\n */\n\ninitializeIcons();\n\nexport class RichText extends React.Component<IRichTextProps, IRichTextState> {\n  private _quillElem: ReactQuill = undefined;\n  private _wrapperRef: HTMLDivElement = undefined;\n  private _propertyPaneRef: RichTextPropertyPane = undefined;\n  private _toolbarId = undefined;\n\n  private ddStyleOpts = [{\n    key: 0,\n    text: strings.HeaderNormalText,\n    data: { }\n  }, {\n    key: 2,\n    text: strings.HeaderH2,\n    data:\n      { className: styles.toolbarButtonH2 }\n  }, {\n    key: 3,\n    text: strings.HeaderH3,\n    data:\n      { className: styles.toolbarButtonH3 }\n  }, {\n    key: 4,\n    text: strings.HeaderH4,\n    data:\n      { className: styles.toolbarButtonH4 }\n  }, {\n    key: 7,\n    text: strings.HeaderBlockQuote,\n    data:\n      { className: styles.toolbarButtonBlockQuote }\n  }];\n\n  private ddAlignOpts = [{\n    key: 'left',\n    text: strings.AlignLeft,\n    data: { icon: 'AlignLeft' }\n  }, {\n    key: 'center',\n    text: strings.AlignCenter,\n    data: { icon: 'AlignCenter' }\n  }, {\n    key: 'right',\n    text: strings.AlignRight,\n    data: { icon: 'AlignRight' }\n  }];\n\n  private ddListOpts = [{\n    key: 'bullet',\n    text: strings.ListBullet,\n    data: { icon: 'BulletedList' }\n  }, {\n    key: 'ordered',\n    text: strings.ListNumbered,\n    data: { icon: 'NumberedList' }\n  }];\n\n  /**\n   * Sets default properties\n   */\n  public static defaultProps: Partial<IRichTextProps> = {\n    isEditMode: true,\n    styleOptions: {\n      showStyles: true,\n      showBold: true,\n      showItalic: true,\n      showUnderline: true,\n      showAlign: true,\n      showList: true,\n      showLink: true,\n      showMore: true\n    }\n  };\n\n  constructor(props: IRichTextProps) {\n    super(props);\n    telemetry.track('ReactRichText', {\n      className: !!props.className\n    });\n\n    this.state = {\n      text: this.props.value,\n      editing: false,\n      morePaneVisible: false,\n      hideDialog: true,\n      formats: {},\n      insertUrl: undefined,\n      insertUrlText: undefined,\n      selectedText: undefined,\n      selectedUrl: undefined,\n      wrapperTop: 0\n    };\n\n    // Get a unique toolbar id\n    this._toolbarId = \"toolbar_\" + Guid.newGuid().toString();\n  }\n\n  /**\n   * Attaches to mouse down events to determine if we clicked outside\n   */\n  public componentDidMount() {\n    // If we're in edit mode, attach the mouse down event\n    if (this.props.isEditMode) {\n      document.addEventListener('click', this.handleClickOutside);\n      document.addEventListener('focus', this.handleClickOutside);\n\n      const clientRect: ClientRect = this._wrapperRef.getBoundingClientRect();\n      const parentClientRect: ClientRect = this._wrapperRef.parentElement.getBoundingClientRect();\n      const toolbarTop: number = clientRect.top - parentClientRect.top - TOOLBARPADDING;\n\n      this.setState({\n        wrapperTop: toolbarTop\n      });\n    }\n  }\n\n  /**\n   * Removes the mouse down event\n   */\n  public componentWillUnmount() {\n    // If we were in edit mode, remove the mouse down handler\n    if (this.props.isEditMode) {\n      document.removeEventListener('click', this.handleClickOutside);\n      document.removeEventListener('focus', this.handleClickOutside);\n    }\n  }\n\n  /**\n   * If we're switching from non-edit mode to edit mode, attach mouse down event\n   * If we're going from edit mode to non-edit mode, remove mouse down event\n   * @param prevProps\n   * @param prevState\n   */\n  public componentDidUpdate(prevProps: IRichTextProps, prevState: IRichTextState): void {\n    // If we're going from non-edit to edit mode\n    if (this.props.isEditMode && !prevProps.isEditMode) {\n      document.addEventListener('click', this.handleClickOutside);\n      document.addEventListener('focus', this.handleClickOutside);\n    }\n\n    // If we're going from edit mode to non-edit mode\n    if (!this.props.isEditMode && prevProps.isEditMode) {\n      document.removeEventListener('click', this.handleClickOutside);\n      document.removeEventListener('focus', this.handleClickOutside);\n    }\n  }\n\n  /**\n   * shouldComponentUpdate lifecycle hook\n   *\n   * @param nextProps\n   * @param nextState\n   */\n  public shouldComponentUpdate(nextProps: IRichTextProps, nextState: IRichTextState): boolean {\n    // Checks if the value coming in is the same\n    if (isEqual(nextState, this.state) && isEqual(nextProps, this.props)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Returns a handle to the Quill editor\n   */\n  public getEditor = (): Quill => {\n    try {\n      return this._quillElem!.getEditor();\n    } catch (error) {\n      return undefined;\n    }\n  }\n\n  /**\n   * Render style option\n   *\n   * @param option\n   */\n  private onRenderStyleOption (option: IDropdownOption): JSX.Element {\n    return (\n      <TooltipHost content={option.text}\n                   id={`${option.text}-toolbarButton`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={`${styles.toolbarDropDownOption} ${option.data!.className ? option.data!.className : \"\"}`}\n             aria-describedby={`${option.text}-toolbarButton`}>\n          <span>{option.text}</span>\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Render the title of the style dropdown\n   *\n   * @param options\n   */\n  private onRenderStyleTitle (options: IDropdownOption[]): JSX.Element {\n    const option = options[0];\n\n    return (\n      <TooltipHost content={option.text}\n                   id={`${option.text}-dropDownTitle`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={styles.toolbarSubmenuDisplayButton}\n             aria-describedby={`${option.text}-dropDownTitle`}>\n          <span>{option.text}</span>\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Render align option\n   *\n   * @param option\n   */\n  private onRenderAlignOption (option: IDropdownOption): JSX.Element {\n    return (\n      <TooltipHost content={option.text}\n                   id={`${option.text}-toolbarButton`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={`${styles.toolbarDropDownOption} ${option.data!.className ? option.data!.className : \"\"}`}\n             aria-describedby={`${option.text}-toolbarButton`}>\n          <Icon className={styles.toolbarDropDownIcon}\n                iconName={option.data.icon}\n                aria-hidden=\"true\" />\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Render the list dropdown title\n   *\n   * @param options\n   */\n  private onRenderListTitle (options: IDropdownOption[]): JSX.Element {\n    const option = options[0];\n\n    return (\n      <TooltipHost content={option.text}\n                   id={`${option.text}-dropDownTitle`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={styles.toolbarSubmenuDisplayButton}\n             aria-describedby={`${option.text}-dropDownTitle`}>\n          <Icon className={styles.toolbarDropDownTitleIcon}\n                iconName={option.data.icon}\n                aria-hidden=\"true\" />\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Render the title of the align dropdown\n   *\n   * @param options\n   */\n  private onRenderAlignTitle (options: IDropdownOption[]): JSX.Element {\n    const option = options[0];\n\n    return (\n      <TooltipHost content={option.text}\n                   id={`${option.text}-dropDownTitle`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={styles.toolbarSubmenuDisplayButton}\n             aria-describedby={`${option.text}-dropDownTitle`}>\n          <Icon className={styles.toolbarDropDownTitleIcon}\n                iconName={option.data.icon}\n                aria-hidden=\"true\" />\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Render list dropdown option\n   *\n   * @param option\n   */\n  private onRenderListOption (option: IDropdownOption): JSX.Element {\n    return (\n      <TooltipHost content={option.text}\n                   id={`${option.text}-toolbarButton`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={`${styles.toolbarDropDownOption} ${option.data!.className ? option.data!.className : \"\"}`}\n             aria-describedby={`${option.text}-toolbarButton`}>\n          <Icon className={styles.toolbarDropDownIcon}\n                iconName={option.data.icon}\n                aria-hidden=\"true\" />\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Render the list dropdown placeholder\n   */\n  private onRenderListPlaceholder (): JSX.Element {\n    return (\n      <TooltipHost content={\"Placeholder\"}\n                   id={`Placeholder-dropDownTitle`}\n                   calloutProps={{ gapSpace: 0 }}>\n        <div className={styles.toolbarSubmenuDisplayButton}\n             aria-describedby={`Placeholder-dropDownTitle`}>\n          <Icon className={styles.toolbarDropDownTitleIcon}\n                iconName={'BulletedList'}\n                aria-hidden=\"true\" />\n        </div>\n      </TooltipHost>\n    );\n  }\n\n  /**\n   * Renders the \"Insert Link\" dialog\n   */\n  private renderLinkDialog = (): JSX.Element => {\n    return (\n      <Dialog hidden={this.state.hideDialog}\n              onDismiss={this.closeDialog}\n              dialogContentProps={{\n                type: DialogType.normal,\n                title: strings.InsertLinkTitle,\n              }}\n              modalProps={{\n                className: styles.insertLinkDialog,\n                isBlocking: true,\n                containerClassName: 'ms-dialogMainOverride'\n              }}>\n        <TextField label={strings.AddressFieldLabel}\n                   value={this.state.insertUrl !== undefined ? this.state.insertUrl : \"https://\"}\n                   onChanged={(newValue?: string) => {\n                    this.setState({\n                      insertUrl: newValue\n                    });\n                  }} />\n\n        <TextField label={strings.TextToDisplayLabel}\n                   value={this.state.insertUrlText || this.state.insertUrl}\n                   onChanged={(newValue?: string) => {\n                    if (newValue !== this.state.insertUrl) {\n                      this.setState({\n                        insertUrlText: newValue\n                      });\n                    }\n                   }} />\n\n        <DialogFooter className={styles.actions}>\n          <div className={`ms-Dialog-actionsRight ${styles.actionsRight}`}>\n            {\n              this.state.selectedUrl && (\n                <Link className={`${styles.action} ${styles.unlinkButton}`} onClick={this.handleRemoveLink}>{strings.RemoveLinkLabel}</Link>\n              )\n            }\n            <PrimaryButton className={styles.action} onClick={this.handleCreateLink} text={strings.SaveButtonLabel} />\n            <DefaultButton className={styles.action} onClick={this.closeDialog} text={strings.CancelButtonLabel} />\n          </div>\n        </DialogFooter>\n      </Dialog>\n    );\n  }\n\n  /**\n   * Renders the Rich Text Editor\n   */\n  public render(): React.ReactElement<IRichTextProps> {\n    const { text } = this.state;\n    const { isEditMode } = this.props;\n\n    // If we're not in edit mode, display read-only version of the html\n    if (!isEditMode) {\n      return (\n        <div className={`ql-editor ${styles.richtext} ${this.props.className || ''}`}\n             dangerouslySetInnerHTML={{ __html: text }}>\n        </div>\n      );\n    }\n\n    // Okay, we're in edit mode.\n    const { placeholder, styleOptions: { showStyles, showBold, showItalic, showUnderline, showAlign, showList, showLink, showMore } } = this.props;\n\n    // Get a unique id for the toolbar\n    const modules = {\n      toolbar: {\n        container: \"#\" + this._toolbarId,\n        handlers: [\n          \"link\" // disable the link handler so we can add our own\n        ]\n      },\n      clipboard: {\n        matchVisual: false // prevents weird bug that inserts blank lines when loading stored text\n      }\n    };\n\n    // Remove fonts and set Segoe UI as the main font\n    let font = Quill.import('formats/font');\n    font.whitelist = ['Segoe UI'];\n    Quill.register(font, true);\n\n    // Set headers and add blockquote capability\n    let header = Quill.import('formats/header');\n    header.tagName = [\n      'H1',\n      'H2',\n      'H3',\n      'H4',\n      'H5',\n      'H6',\n      'blockquote'];\n    Quill.register(header, true);\n\n    // Add the SharePoint font sizes\n    let SizeClass = Quill.import('formats/size');\n    SizeClass.whitelist = [\n      'small',\n      'medium',\n      'mediumplus',\n      'large',\n      'xlarge',\n      'xlargeplus',\n      'xxlarge',\n      'xxxlarge',\n      'xxlargeplus',\n      'super'];\n    Quill.register(SizeClass, true);\n\n    return (\n      <div ref={(ref) => this._wrapperRef = ref} className={`${styles.richtext && this.state.editing ? 'ql-active' : ''} ${this.props.className}`}>\n        <div id={this._toolbarId} style={{top:this.state.wrapperTop}}>\n          {\n            showStyles && (\n              <Dropdown\nid=\"DropDownStyles\"\n              className={`${styles.headerDropDown} ${styles.toolbarDropDown}`}\n                        onRenderCaretDown={() => <Icon className={styles.toolbarSubmenuCaret} iconName=\"CaretDownSolid8\" />}\n                        selectedKey={this.state.formats.header || 0}\n                        options={this.ddStyleOpts}\n                        onChanged={this.onChangeHeading}\n                        onRenderOption={this.onRenderStyleOption}\n                        onRenderTitle={this.onRenderStyleTitle}\n                      />\n            )\n          }\n          {\n            showBold && (\n              <TooltipHost content={strings.BoldTitle}\n                           id=\"bold-richtextbutton\"\n                           calloutProps={{ gapSpace: 0 }}>\n                <IconButton iconProps={{ iconName: 'Bold' }}\n                            aria-describedby=\"bold-richtextbutton\"\n                            checked={this.state.formats.bold}\n                            onClick={this.onChangeBold} />\n              </TooltipHost>\n            )\n          }\n          {\n            showItalic && (\n              <TooltipHost content={strings.ItalicTitle}\n                           id=\"italic-richtextbutton\"\n                           calloutProps={{ gapSpace: 0 }}>\n                <IconButton iconProps={{ iconName: 'Italic' }}\n                            aria-describedby=\"italic-richtextbutton\"\n                            checked={this.state.formats.italic}\n                            onClick={this.onChangeItalic} />\n              </TooltipHost>\n            )\n          }\n          {\n            showUnderline && (\n              <TooltipHost content={strings.UnderlineTitle}\n                           id=\"underline-richtextbutton\"\n                           calloutProps={{ gapSpace: 0 }}>\n                <IconButton iconProps={{ iconName: 'Underline' }}\n                            aria-describedby=\"underline-richtextbutton\"\n                            checked={this.state.formats.underline}\n                            onClick={this.onChangeUnderline} />\n            </TooltipHost>\n            )\n          }\n          {\n            showAlign && (\n              <Dropdown className={`${styles.toolbarDropDown}`}\n              id=\"DropDownAlign\"\n                        onRenderCaretDown={() => <Icon className={styles.toolbarSubmenuCaret} iconName=\"CaretDownSolid8\" />}\n                        selectedKey={this.state.formats.align || 'left'}\n                        options={this.ddAlignOpts}\n                        onChanged={this.onChangeAlign}\n                        onRenderOption={this.onRenderAlignOption}\n                        onRenderTitle={this.onRenderAlignTitle}\n              />\n            )\n          }\n          {\n            showList && (\n              <Dropdown className={styles.toolbarDropDown}\n              id=\"DropDownLists\"\n                        onRenderCaretDown={() => <Icon className={styles.toolbarSubmenuCaret} iconName=\"CaretDownSolid8\" />}\n                        selectedKey={this.state.formats.list}\n                        options={this.ddListOpts}\n                        // this option is not available yet\n                        // notifyOnReselect={true} // allows re-selecting selected item to turn it off\n                        onChanged={this.onChangeList}\n                        onRenderOption={this.onRenderListOption}\n                        onRenderTitle={this.onRenderListTitle}\n                        onRenderPlaceHolder={this.onRenderListPlaceholder}\n              />\n            )\n          }\n          {\n            showLink && (\n              <TooltipHost content={strings.LinkTitle}\n                           id=\"link-richtextbutton\"\n                           calloutProps={{ gapSpace: 0 }}>\n                <IconButton checked={this.state.formats!.link !== undefined}\n                            onClick={this.showInsertLinkDialog}\n                            aria-describedby=\"link-richtextbutton\"\n                            iconProps={{\n                              iconName: 'Link'\n                            }} />\n              </TooltipHost>\n            )\n          }\n          {\n            showMore && (\n              <TooltipHost content={strings.MoreTitle}\n                           id=\"more-richtextbutton\"\n                           calloutProps={{ gapSpace: 0 }}>\n                <IconButton iconProps={{ iconName: 'More' }}\n                            aria-describedby=\"more-richtextbutton\"\n                            onClick={this.handleShowMore} />\n              </TooltipHost>\n            )\n          }\n        </div>\n\n        <ReactQuill ref={this.linkQuill}\n                    placeholder={placeholder}\n                    modules={modules}\n                    value={text || ''}\n                    onChange={this.handleChange}\n                    onChangeSelection={this.handleChangeSelection}\n                    onFocus={this.handleOnFocus} />\n\n        <RichTextPropertyPane ref={this.linkPropertyPane}\n                              editor={this.getEditor()}\n                              isOpen={this.state.morePaneVisible}\n                              onClose={this.handleClosePanel}\n                              onLink={this.showInsertLinkDialog}\n                              customColors={this.props.customColors}/>\n\n        {\n          this.renderLinkDialog()\n        }\n      </div>\n    );\n  }\n\n  /**\n   * Style trigger events\n   */\n  private onChangeBold = (): void => {\n    const newBoldValue = !this.state.formats.bold;\n    this.applyFormat(\"bold\", newBoldValue);\n  }\n\n  private onChangeItalic = (): void => {\n    const newValue = !this.state.formats.italic;\n    this.applyFormat(\"italic\", newValue);\n  }\n\n  private onChangeUnderline = (): void => {\n    const newValue = !this.state.formats.underline;\n    this.applyFormat(\"underline\", newValue);\n  }\n  private onChangeHeading = (item: IDropdownOption): void => {\n    const newHeadingValue = item.key === 0 ? '' : item.key.toString();\n    this.applyFormat(\"header\", newHeadingValue);\n  }\n\n  private onChangeAlign = (item: IDropdownOption): void => {\n    const newAlignValue = item.key === 'left' ? false : item.key.toString();\n    this.applyFormat(\"align\", newAlignValue);\n  }\n\n  private onChangeList = (item: IDropdownOption): void => {\n    // if we're already in list mode, toggle off\n    const key = item.key;\n    const newAlignValue = (key === 'bullet' && this.state.formats.list === 'bullet') || (key === 'numbered' && this.state.formats.list === 'numbered') ? false : key;\n    this.applyFormat(\"list\", newAlignValue);\n  }\n\n  /**\n   * Displays the insert link dialog\n   */\n  private showInsertLinkDialog = () => {\n    const quill = this.getEditor();\n    const range = quill.getSelection();\n\n    let linkText = this.state.selectedText;\n    if (this.state.selectedUrl !== undefined && this.state.selectedText === \"\") {\n      const { text } = this.state;\n      const urlStartIndex = text.indexOf(this.state.selectedUrl);\n      const startTextIndex = text.indexOf(\">\", urlStartIndex) + 1;\n      const endTextIndex = text.indexOf(\"<\", startTextIndex);\n      const realLength = endTextIndex - startTextIndex;\n      linkText = text.substr(startTextIndex, realLength);\n\n      //Find where the link text starts and select that\n      const editorText = quill.getText();\n      const linkStart = editorText.indexOf(linkText);\n      range.index = linkStart;\n      range.length = linkText.length;\n    }\n\n    this.setState({\n      hideDialog: false,\n      insertUrlText: linkText,\n      insertUrl: this.state.selectedUrl,\n      selectedRange: range\n    });\n  }\n\n  /**\n   * Hides the insert link dialog\n   */\n  private closeDialog = () => {\n    this.setState({ hideDialog: true });\n  }\n\n  /**\n   * When user enters the richtext editor, displays the border\n   */\n  private handleOnFocus = (range, source, editor) => {\n    if (!this.state.editing) {\n      this.setState({ editing: true });\n    }\n  }\n\n  /**\n   * Called when user removes the link\n   */\n  private handleRemoveLink = () => {\n    const quill = this.getEditor();\n    quill.format('link', false);\n    this.closeDialog();\n  }\n\n  /**\n   * Called when user creates a new link\n   */\n  private handleCreateLink = () => {\n    const quill = this.getEditor();\n    const range = this.state.selectedRange;\n    const cursorPosition: number = range!.index;\n    if (range.length > 0) {\n      quill.deleteText(range.index, range.length);\n    }\n\n    if (cursorPosition > -1) {\n      const textToInsert: string = this.state.insertUrlText !== undefined ? this.state.insertUrlText : this.state.insertUrl;\n      const urlToInsert: string = this.state.insertUrl;\n      quill.insertText(cursorPosition, textToInsert);\n      quill.setSelection(cursorPosition, textToInsert.length);\n      quill.formatText(cursorPosition, textToInsert.length, 'link', urlToInsert);\n    }\n\n    this.setState({\n      hideDialog: true,\n      insertUrl: undefined,\n      insertUrlText: undefined\n    });\n  }\n\n  /**\n   * Applies a format to the selection\n   * @param name format name\n   * @param value format value, or false to unset format\n   */\n  private applyFormat(name: string, value: any) {\n    const quill = this.getEditor();\n    quill.format(name, value);\n\n    // We use a timeout to ensure that format has been applied and buttons are updated\n    setTimeout(() => {\n      this.handleChangeSelection(quill.getSelection(), undefined, undefined);\n    }, 100);\n  }\n\n  /**\n   * Called when richtext selection changes\n   */\n  private handleChangeSelection = (range, oldRange, source) => {\n    const quill = this.getEditor();\n    try {\n      if (quill) {\n        // Get the selected text\n        const selectedText = quill.getText(range);\n\n        // Get the current format\n        const formats = quill.getFormat(range);\n\n        // Get the currently selected url\n        const selectedUrl = formats.link ? formats.link : undefined;\n\n        this.setState({\n          selectedText: selectedText,\n          selectedUrl: selectedUrl,\n          formats: formats\n        });\n\n        if (this._propertyPaneRef && this.state.morePaneVisible) {\n          this._propertyPaneRef.onChangeSelection(range, oldRange, source);\n        }\n      }\n    } catch (error) {\n\n    }\n  }\n\n  /**\n   * Called when user clicks on the close icon\n   */\n  private handleClosePanel = (): void => {\n    this.closePanel();\n  }\n\n  /**\n   * Closes the panel\n   */\n  private closePanel = (): void => {\n    this.setState({ morePaneVisible: false });\n  }\n\n  /**\n   * Called when user clicks on the more button\n   */\n  private handleShowMore = () => {\n    this.setState({\n      morePaneVisible: !this.state.morePaneVisible\n    }, () => {\n      this.getEditor().focus();\n    });\n  }\n\n  /**\n   * Called when user changes the text of the editor\n   */\n  private handleChange = (value: string) => {\n    const { onChange } = this.props;\n\n    // do we need to pass this to a handler?\n    if (onChange) {\n      // yes, get the changed text from the handler\n      let newText: string = onChange(value);\n      this.setState({ text: newText });\n    } else {\n      // no, write the text to the state\n      this.setState({ text: value });\n    }\n  }\n\n  /**\n   * Keeps track of whether we clicked outside the element\n   */\n  private handleClickOutside = (event) => {\n    let outside: boolean = !elementContains(this._wrapperRef, event.target);\n\n    // Did we click outside?\n    if (outside) {\n      // If we are currently editing, stop editing\n      // -- unless we're using the property pane or the dialog\n      if (this.state.editing) {\n        this.setState({\n          editing: false\n        });\n      }\n    } else {\n      // We clicked inside\n      if (!this.state.editing) {\n        // if we aren't currently editing, start editing\n        this.setState({ editing: true });\n      }\n    }\n  }\n\n  /**\n   * Links to the quill reference\n   */\n  private linkQuill = (e: any) => {\n    this._quillElem = e;\n  }\n\n  /**\n   * Links to the property pane element\n   */\n  private linkPropertyPane = (e: any) => {\n    this._propertyPaneRef = e;\n  }\n}\n"],"sourceRoot":"../../../src"}