{"version":3,"sources":["controls/folderExplorer/NewFolder/NewFolder.tsx"],"names":[],"mappings":"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","file":"controls/folderExplorer/NewFolder/NewFolder.js","sourcesContent":["import * as React from 'react';\nimport { Icon, IIconProps } from 'office-ui-fabric-react/lib/Icon';\nimport { IconButton } from 'office-ui-fabric-react/lib/Button';\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\nimport { Spinner, SpinnerSize } from \"office-ui-fabric-react/lib/Spinner\";\nimport styles from './NewFolder.module.scss';\nimport * as strings from 'ControlStrings';\nimport { INewFolderProps, INewFolderState } from '.';\nimport { FolderExplorerService } from '../../../services/FolderExplorerService';\nimport { IFolder, IFolderExplorerService } from '../../../services/IFolderExplorerService';\n\nconst addIcon: IIconProps = { iconName: 'CheckMark' };\n\nexport class NewFolder extends React.Component<INewFolderProps, INewFolderState> {\n\n  private _spService: IFolderExplorerService;\n\n  constructor(props: INewFolderProps) {\n    super(props);\n\n    this._spService = new FolderExplorerService(this.props.context.serviceScope);\n\n    this.state = {\n      folderName: '',\n      showInput: false,\n      loading: false,\n    };\n  }\n\n\n  public render(): React.ReactElement<INewFolderProps> {\n    return (\n      <div className={styles.libraryItem}>\n        {this.state.loading &&\n          <span className={styles.spinner}><Spinner size={SpinnerSize.xSmall} /></span>\n        }\n        {!this.state.loading &&\n          <Icon iconName=\"FabricNewFolder\" className={styles.folderIcon}></Icon>\n        }\n        {!this.state.showInput &&\n          <div className={styles.defaultText} onClick={this._onShowInputChange}>New folder</div>\n        }\n        {this.state.showInput &&\n          <TextField\n            placeholder={strings.NewFolderNamePlaceholder}\n            value={this.state.folderName}\n            onChanged={this._onFolderNameChange}\n          // styles={{ fieldGroup: { width: 300 } }}\n          />\n        }\n        {this.state.folderName.length > 0 &&\n          <IconButton\n            iconProps={addIcon}\n            title=\"Add\"\n            ariaLabel=\"Add\"\n            className={styles.button}\n            disabled={this.state.loading}\n            onClick={this._addSubFolder} />\n        }\n      </div>\n    );\n  }\n\n  private _onFolderNameChange = (newValue?: string) => {\n    this.setState({ folderName: newValue || '' });\n  }\n\n  private _onShowInputChange = (event: React.MouseEvent<HTMLDivElement>) => {\n    this.setState({ showInput: true });\n  }\n\n  /**\n * Add new subfolder to current folder\n */\n  private _addSubFolder = async (): Promise<void> => {\n\n    let newFolder: IFolder = null;\n\n    this.setState({ loading: true });\n\n    try {\n      const siteAbsoluteUrl = this.props.siteAbsoluteUrl || this.props.context.pageContext.web.absoluteUrl;\n\n      const folder = await this._spService.AddFolder(\n        siteAbsoluteUrl,\n        this.props.selectedFolder.ServerRelativeUrl,\n        this.state.folderName);\n\n      // update folder variable to be used on the callback\n      newFolder = { Name: folder.Name, ServerRelativeUrl: folder.ServerRelativeUrl };\n      // update return variable\n\n      this.setState({ loading: false, folderName: '' });\n\n    } catch (error) {\n      console.error('Error adding folder', error);\n    }\n\n    // callback\n    this.props.addSubFolder(newFolder);\n  }\n}\n"],"sourceRoot":"../../../../src"}