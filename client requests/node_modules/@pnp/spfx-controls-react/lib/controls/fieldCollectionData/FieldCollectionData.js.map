{"version":3,"sources":["controls/fieldCollectionData/FieldCollectionData.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,6BAA+B;AAC/B,kDAAoD;AACpD,uEAA6E;AAC7E,qEAA+E;AAC/E,qEAAoE;AACpE,+DAA8D;AAE9D,qEAAqE;AACrE,wCAA0C;AAC1C,oEAAmF;AAEnF;IAAyC,uCAAqE;IAC5G,6BAAY,KAAgC;QAA5C,YACE,kBAAM,KAAK,CAAC,SAOb;QAED;;WAEG;QACK,eAAS,GAAG;YAClB,KAAI,CAAC,QAAQ,CAAC;gBACZ,SAAS,EAAE,IAAI;aAChB,CAAC,CAAC;QACL,CAAC,CAAA;QAED;;WAEG;QACK,gBAAU,GAAG;YACnB,KAAI,CAAC,QAAQ,CAAC;gBACZ,SAAS,EAAE,KAAK;aACjB,CAAC,CAAC;QACL,CAAC,CAAA;QAED;;WAEG;QACK,YAAM,GAAG,UAAC,KAAY;YAC5B,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAC5B,KAAI,CAAC,QAAQ,CAAC;gBACZ,SAAS,EAAE,KAAK;aACjB,CAAC,CAAC;QACL,CAAC,CAAA;QAjCC,KAAI,CAAC,KAAK,GAAG;YACX,SAAS,EAAE,KAAK;SACjB,CAAC;QAEF,SAAS,CAAC,KAAK,CAAC,qBAAqB,EAAE,EAAE,CAAC,CAAC;;IAC7C,CAAC;IA8BM,oCAAM,GAAb;QACE,MAAM,CAAC,CACL;YACE,oBAAC,aAAK,QAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAS;YAEjC,oBAAC,sBAAa,IAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,cAAc,EAC/B,OAAO,EAAE,IAAI,CAAC,SAAS,EACvB,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAI;YAGhF,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC;gBACtD,oBAAC,uBAAU,IAAC,cAAc,EAAE,2BAAc,CAAC,KAAK,IAAG,OAAO,CAAC,+BAA+B,CAAc;YAG1G,oBAAC,aAAK,IAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,EAC5B,SAAS,EAAE,IAAI,CAAC,UAAU,EAC1B,IAAI,EAAE,iBAAS,CAAC,KAAK,EACrB,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAClC,YAAY,EAAE,cAAK,CAAC,EACpB,SAAS,EAAE,iCAA8B,IAAI,CAAC,KAAK,CAAC,cAAc,IAAI,EAAE,CAAE;gBAE7E,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,CAC7B,2BAAG,SAAS,EAAC,yCAAyC,IAAE,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAK,CACzF;gBAGH,oBAAC,2CAAoB,eAAK,IAAI,CAAC,KAAK,IAAE,OAAO,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,UAAU,IAAI,CACnF,CACJ,CACP,CAAC;IACJ,CAAC;IACH,0BAAC;AAAD,CAtEA,AAsEC,CAtEwC,KAAK,CAAC,SAAS,GAsEvD;AAtEY,kDAAmB","file":"controls/fieldCollectionData/FieldCollectionData.js","sourcesContent":["import * as React from 'react';\nimport * as telemetry from '../../common/telemetry';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/components/Button';\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/components/Panel';\nimport { Label } from 'office-ui-fabric-react/lib/components/Label';\nimport { CollectionDataViewer } from './collectionDataViewer';\nimport { IFieldCollectionDataProps, IFieldCollectionDataState } from \"./IFieldCollectionData\";\n// import FieldErrorMessage from '../errorMessage/FieldErrorMessage';\nimport * as strings from 'ControlStrings';\nimport { MessageBar, MessageBarType } from 'office-ui-fabric-react/lib/MessageBar';\n\nexport class FieldCollectionData extends React.Component<IFieldCollectionDataProps, IFieldCollectionDataState> {\n  constructor(props: IFieldCollectionDataProps) {\n    super(props);\n\n    this.state = {\n      panelOpen: false\n    };\n\n    telemetry.track('FieldCollectionData', {});\n  }\n\n  /**\n   * Open the panel\n   */\n  private openPanel = () => {\n    this.setState({\n      panelOpen: true\n    });\n  }\n\n  /**\n   * Closes the panel\n   */\n  private closePanel = () => {\n    this.setState({\n      panelOpen: false\n    });\n  }\n\n  /**\n   * On save action\n   */\n  private onSave = (items: any[]) => {\n    this.props.onChanged(items);\n    this.setState({\n      panelOpen: false\n    });\n  }\n\n  public render(): JSX.Element {\n    return (\n      <div>\n        <Label>{this.props.label}</Label>\n\n        <DefaultButton text={this.props.manageBtnLabel}\n                       onClick={this.openPanel}\n                       disabled={this.props.fields.length === 0 || this.props.disabled} />\n\n        {\n          (!this.props.fields || this.props.fields.length === 0) && //<FieldErrorMessage errorMessage={strings.CollectionDataEmptyFields} />\n          <MessageBar messageBarType={MessageBarType.error}>{strings.CollectionDataItemMissingFields}</MessageBar>\n        }\n\n        <Panel isOpen={this.state.panelOpen}\n               onDismiss={this.closePanel}\n               type={PanelType.large}\n               headerText={this.props.panelHeader}\n               onOuterClick={()=>{}}\n               className={`FieldCollectionData__panel ${this.props.panelClassName || \"\"}`}>\n          {\n            this.props.panelDescription && (\n              <p className=\"FieldCollectionData__panel__description\">{this.props.panelDescription}</p>\n            )\n          }\n\n          <CollectionDataViewer {...this.props} fOnSave={this.onSave} fOnClose={this.closePanel} />\n        </Panel>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"../../../src"}