{"version":3,"sources":["controls/filePicker/UploadFilePickerTab/UploadFilePickerTab.tsx"],"names":[],"mappings":";;;;;;;;;;;;AAAA,6BAA+B;AAI/B,uDAA0D;AAC1D,uEAA4F;AAE5F,wCAA0C;AAC1C,qFAAuD;AAIvD;IAAiD,uCAAqE;IACpH,6BAAY,KAAgC;QAA5C,YACE,kBAAM,KAAK,CAAC,SAIb;QA+CD;;WAEG;QACK,uBAAiB,GAAG,UAAC,KAA0C;YACrE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;gBACzD,MAAM,CAAC;YACT,CAAC;YAED,mCAAmC;YACnC,IAAI,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC;YAE/B,yDAAyD;YACzD,IAAM,IAAI,GAAS,KAAK,CAAC,CAAC,CAAC,CAAC;YAE5B,IAAM,gBAAgB,GAAsB;gBAC1C,eAAe,EAAE,IAAI;gBACrB,QAAQ,EAAE,IAAI,CAAC,IAAI;gBACnB,wBAAwB,EAAE,yBAAa,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC;gBAC9E,mBAAmB,EAAE,cAAQ,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aAC7D,CAAC;YAEF,EAAE,CAAC,CAAC,yBAAa,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACrC,0BAA0B;gBAC1B,IAAM,QAAM,GAAG,IAAI,UAAU,EAAE,CAAC;gBAEhC,QAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;gBAC3B,QAAM,CAAC,MAAM,GAAG;oBACd,KAAI,CAAC,QAAQ,CAAC;wBACZ,WAAW,EAAE,QAAM,CAAC,MAAgB;qBACrC,CAAC,CAAC;gBACL,CAAC,CAAC;YACJ,CAAC;YACD,KAAI,CAAC,QAAQ,CAAC;gBACZ,gBAAgB,kBAAA;gBAChB,WAAW,EAAE,SAAS;aACvB,CAAC,CAAC;QACL,CAAC,CAAA;QAED;;WAEG;QACK,iBAAW,GAAG;YACpB,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;QACjD,CAAC,CAAA;QAED;;WAEG;QACK,kBAAY,GAAG;YACrB,KAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QACvB,CAAC,CAAA;QApGC,KAAI,CAAC,KAAK,GAAG;YACX,gBAAgB,EAAE,SAAS;SAC5B,CAAC;;IACJ,CAAC;IAEM,oCAAM,GAAb;QAAA,iBA2CC;QA1CO,IAAA,eAA8C,EAA5C,sCAAgB,EAAE,4BAAW,CAAgB;QACrD,IAAM,QAAQ,GAAW,gBAAgB,GAAG,gBAAgB,CAAC,QAAQ,GAAG,IAAI,CAAC;QAC7E,IAAM,uBAAuB,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;QAEzF,MAAM,CAAC,CACL,6BAAK,SAAS,EAAE,yCAAM,CAAC,YAAY;YACjC,6BAAK,SAAS,EAAE,yCAAM,CAAC,kBAAkB;gBACvC,4BAAI,SAAS,EAAE,yCAAM,CAAC,SAAS,IAAG,OAAO,CAAC,gBAAgB,CAAM,CAC5D;YACN,6BAAK,SAAS,EAAE,yCAAM,CAAC,GAAG;gBACxB,+BACE,SAAS,EAAE,yCAAM,CAAC,aAAa,EAC/B,IAAI,EAAC,MAAM,EAAC,EAAE,EAAC,WAAW,EAC1B,MAAM,EAAE,uBAAuB,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,UAAC,KAA0C,IAAK,OAAA,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,EAA7B,CAA6B,GACzI;gBAEA,QAAQ,IAAI,WAAW;oBACvB,4BAA4B;oBAC5B,6BAAK,SAAS,EAAE,yCAAM,CAAC,qBAAqB;wBACxC,6BAAK,SAAS,EAAE,yCAAM,CAAC,0BAA0B,EAAE,GAAG,EAAE,WAAW,EAAE,GAAG,EAAE,gBAAgB,CAAC,QAAQ,GAAI;wBACvG,kCAAO,QAAQ,CAAQ,CACrB;gBAER;oBACE,+BAAO,SAAS,EAAE,yCAAM,CAAC,gBAAgB,IACvC,CAAC,CAAC,WAAW,IAAI,QAAQ,GAAG,QAAQ,GAAG,EAAE,CAAC,CACnC,CACL;gBACN,+BAAO,SAAS,EAAE,yCAAM,CAAC,aAAa,EAAE,OAAO,EAAC,WAAW,IACzD,CAAC,QAAQ,GAAG,OAAO,CAAC,mBAAmB,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAC/D,CACL;YACN,6BAAK,SAAS,EAAE,yCAAM,CAAC,sBAAsB;gBAC3C,6BAAK,SAAS,EAAE,yCAAM,CAAC,aAAa;oBAClC,oBAAC,sBAAa,IACZ,QAAQ,EAAE,CAAC,gBAAgB,EAC3B,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,WAAW,EAAE,EAAlB,CAAkB,EAAE,SAAS,EAAE,yCAAM,CAAC,YAAY,IAAG,OAAO,CAAC,kBAAkB,CAAiB;oBACjH,oBAAC,sBAAa,IAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,YAAY,EAAE,EAAnB,CAAmB,EAAE,SAAS,EAAE,yCAAM,CAAC,YAAY,IAAG,OAAO,CAAC,iBAAiB,CAAiB,CAC1H,CACF,CACF,CACP,CAAC;IACJ,CAAC;IAqDH,0BAAC;AAAD,CAxGA,AAwGC,CAxGgD,KAAK,CAAC,SAAS,GAwG/D","file":"controls/filePicker/UploadFilePickerTab/UploadFilePickerTab.js","sourcesContent":["import * as React from 'react';\n\nimport { IUploadFilePickerTabProps, IUploadFilePickerTabState } from '.';\nimport { IFilePickerResult } from '../FilePicker.types';\nimport { GeneralHelper } from '../../../common/utilities';\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react/lib/components/Button';\n\nimport * as strings from 'ControlStrings';\nimport styles from './UploadFilePickerTab.module.scss';\n\n\n\nexport default class UploadFilePickerTab extends React.Component<IUploadFilePickerTabProps, IUploadFilePickerTabState> {\n  constructor(props: IUploadFilePickerTabProps) {\n    super(props);\n    this.state = {\n      filePickerResult: undefined\n    };\n  }\n\n  public render(): React.ReactElement<IUploadFilePickerTabProps> {\n    const { filePickerResult, filePreview } = this.state;\n    const fileName: string = filePickerResult ? filePickerResult.fileName : null;\n    const acceptedFilesExtensions = this.props.accepts ? this.props.accepts.join(\",\") : null;\n\n    return (\n      <div className={styles.tabContainer}>\n        <div className={styles.tabHeaderContainer}>\n          <h2 className={styles.tabHeader}>{strings.UploadFileHeader}</h2>\n        </div>\n        <div className={styles.tab}>\n          <input\n            className={styles.localTabInput}\n            type=\"file\" id=\"fileInput\"\n            accept={acceptedFilesExtensions} multiple={false} onChange={(event: React.ChangeEvent<HTMLInputElement>) => this._handleFileUpload(event)}\n          />\n          {\n            fileName && filePreview &&\n            /** Display image preview */\n            <div className={styles.localTabSinglePreview}>\n                <img className={styles.localTabSinglePreviewImage} src={filePreview} alt={filePickerResult.fileName} />\n                <span>{fileName}</span>\n            </div>\n          }\n          <div>\n            <label className={styles.localTabFilename}>{\n              (!filePreview && fileName ? fileName : \"\")\n            }</label>\n          </div>\n          <label className={styles.localTabLabel} htmlFor=\"fileInput\">{\n            (fileName ? strings.ChangeFileLinkLabel : strings.ChooseFileLinkLabel)\n          }</label>\n        </div>\n        <div className={styles.actionButtonsContainer}>\n          <div className={styles.actionButtons}>\n            <PrimaryButton\n              disabled={!filePickerResult}\n              onClick={() => this._handleSave()} className={styles.actionButton}>{strings.AddFileButtonLabel}</PrimaryButton>\n            <DefaultButton onClick={() => this._handleClose()} className={styles.actionButton}>{strings.CancelButtonLabel}</DefaultButton>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  /**\n   * Gets called when a file is uploaded\n   */\n  private _handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (!event.target.files || event.target.files.length < 1) {\n      return;\n    }\n\n    // Get the files that were uploaded\n    let files = event.target.files;\n\n    // Grab the first file -- there should always only be one\n    const file: File = files[0];\n\n    const filePickerResult: IFilePickerResult = {\n      fileAbsoluteUrl: null,\n      fileName: file.name,\n      fileNameWithoutExtension: GeneralHelper.getFileNameWithoutExtension(file.name),\n      downloadFileContent: () => { return Promise.resolve(file); }\n    };\n\n    if (GeneralHelper.isImage(file.name)) {\n      // Convert to base64 image\n      const reader = new FileReader();\n\n      reader.readAsDataURL(file);\n      reader.onload = () => {\n        this.setState({\n          filePreview: reader.result as string\n        });\n      };\n    }\n    this.setState({\n      filePickerResult,\n      filePreview: undefined\n    });\n  }\n\n  /**\n   * Saves base64 encoded image back to property pane file picker\n   */\n  private _handleSave = () => {\n    this.props.onSave(this.state.filePickerResult);\n  }\n\n  /**\n   * Closes tab without saving\n   */\n  private _handleClose = () => {\n    this.props.onClose();\n  }\n}\n"],"sourceRoot":"../../../../src"}