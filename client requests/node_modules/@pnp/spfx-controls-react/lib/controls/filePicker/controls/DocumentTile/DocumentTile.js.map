{"version":3,"sources":["controls/filePicker/controls/DocumentTile/DocumentTile.tsx"],"names":[],"mappings":"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","file":"controls/filePicker/controls/DocumentTile/DocumentTile.js","sourcesContent":["import * as React from 'react';\nimport styles from './DocumentTile.module.scss';\nimport { css, IRenderFunction, IRectangle } from 'office-ui-fabric-react/lib/Utilities';\nimport { Image, IImageProps, ImageFit } from 'office-ui-fabric-react/lib/Image';\nimport * as strings from 'ControlStrings';\nimport { Check } from 'office-ui-fabric-react/lib/Check';\nimport { ScreenWidthMinLarge } from 'office-ui-fabric-react/lib/Styling';\nimport { IDocumentTileProps } from './IDocumentTileProps';\n\nconst MAX_ASPECT_RATIO = 3;\n\nexport class DocumentTile extends React.Component<IDocumentTileProps> {\n  public render(): React.ReactElement<IDocumentTileProps> {\n    const { isSelected, index, item, pageWidth, tileDimensions } = this.props;\n    const isLarge: boolean = pageWidth >= ScreenWidthMinLarge;\n\n    // Find the dimensions that are biggest\n    let thumbnailWidth: number = tileDimensions.width;\n    let thumbnailHeight: number = tileDimensions.height;\n\n\n    if (item.dimensions) {\n      const contentAspectRatio = item.dimensions.width / item.dimensions.height;\n      const boundsAspectRatio = tileDimensions.width / tileDimensions.height;\n\n      let scale: number;\n\n      if (contentAspectRatio > boundsAspectRatio) {\n        scale = tileDimensions.width / item.dimensions.width;\n      } else {\n        scale = tileDimensions.height / item.dimensions.height;\n      }\n\n      const finalScale = Math.min(MAX_ASPECT_RATIO, scale);\n\n      thumbnailWidth = item.dimensions.width * finalScale;\n      thumbnailHeight = item.dimensions.height * finalScale;\n    }\n\n    // Check extension and get preview\n    const thumbnail: string = this.props.fileBroserService.getFileThumbnailUrl(this.props.item, thumbnailWidth, thumbnailHeight);\n    const ariaLabel: string = strings.ImageAriaLabelTemplate.replace('{0}', item.fileIcon);\n    const itemLabel: string = strings.DocumentLabelTemplate\n      .replace('{0}', item.name)\n      .replace('{1}', item.modified)\n      .replace('{2}', item.modifiedBy);\n\n    return (\n      <div\n        aria-selected={isSelected}\n        data-is-draggable={false}\n        role=\"listitem\"\n        aria-labelledby={`Tile-label${index}`}\n        aria-describedby={`Tile-activity${index}`}\n        className={css(styles.tile, isLarge ? styles.isLarge : styles.isSmall, styles.invokable, styles.selectable, isSelected ? styles.selected : undefined)}\n        data-is-focusable={true}\n        data-is-sub-focuszone={true}\n        data-disable-click-on-enter={true}\n        data-selection-index={index}\n        //data-selection-invoke={true}\n        onClick={(_event)=>this.props.onItemInvoked(item)}\n      >\n        <div\n          className={styles.link}\n          role=\"link\"\n          //onClick={(_event) => this.props.onItemInvoked(item)}\n          //data-selection-invoke={true}\n        >\n          <span\n            id={`Tile-label${index}`}\n            className={styles.label}>{itemLabel}</span>\n          <span role=\"presentation\" className={styles.aboveNameplate}>\n            <span role=\"presentation\" className={styles.content}>\n              <span role=\"presentation\" className={styles.foreground}>\n                <span className={styles.odItemTile2Image}>\n                  <span className={styles.odImageFrame2} style={{ width: thumbnailWidth, height: thumbnailHeight }}>\n                    <span className={styles.odImageFrame2Image}>\n                      <span className={styles.odImageFrame}>\n                        <span className={styles.odImageStack}>\n                          <span className={styles.odImageStackTile}>\n                            <span className={styles.odImageTile}>\n                              <span className={styles.odImageTileBackground}>\n                                <Image\n                                  src={thumbnail}\n                                  width={thumbnailWidth}\n                                  height={thumbnailHeight}\n                                  imageFit={ImageFit.contain}\n                                />\n                              </span>\n                            </span>\n                          </span>\n                        </span>\n                      </span>\n                    </span>\n                  </span>\n                </span>\n              </span>\n              <span className={styles.odItemTile2SmallIcon} >\n                <div className={styles.fileTypeIcon}\n                  aria-label={ariaLabel}\n                  title={ariaLabel}>\n                  <img className={styles.fileTypeIconIcon} src={strings.ODPhotoIconUrl} style={{ width: 16, height: 16 }} />\n                </div>\n              </span>\n            </span>\n          </span>\n          <span className={styles.namePlate}>\n            <span className={styles.name}>\n              <span className={css(styles.signalField, styles.compact)}>\n                <span className={styles.signalFieldValue}>{item.name}</span>\n              </span>\n            </span>\n            <span className={styles.activity} id={`Tile-activity${index}`}>\n              <span className={css(styles.signalField, styles.compact)}>\n                <span className={styles.signalFieldValue}>{item.modified}</span>\n              </span>\n            </span>\n          </span>\n        </div>\n        <span role=\"checkbox\" className={styles.check} data-selection-toggle={true} aria-checked={isSelected}>\n          <Check checked={isSelected} />\n        </span>\n      </div>\n    );\n  }\n\n\n}\n"],"sourceRoot":"../../../../../src"}