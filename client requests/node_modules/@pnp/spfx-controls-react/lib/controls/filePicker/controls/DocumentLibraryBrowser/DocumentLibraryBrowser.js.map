{"version":3,"sources":["controls/filePicker/controls/DocumentLibraryBrowser/DocumentLibraryBrowser.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,6BAA+B;AAC/B,kEAAiE;AACjE,wDAAuD;AACvD,8DAA6D;AAC7D,0DAAmE;AAKnE,4DAAkE;AAElE,2FAA0D;AAC1D,wCAA0C;AAE1C;;GAEG;AACU,QAAA,aAAa,GAAG,CAAC,CAAC;AAE/B;;GAEG;AACU,QAAA,cAAc,GAAG,GAAG,CAAC;AAElC;;GAEG;AACH;IAA4C,0CAA2E;IAKrH,gCAAY,KAAmC;QAA/C,YACE,kBAAM,KAAK,CAAC,SAMb;QAgCD;;WAEG;QACK,0BAAoB,GAAG,UAAC,SAAiB,EAAE,WAAuB;YACxE,EAAE,CAAC,CAAC,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC;gBACpB,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,GAAG,sBAAc,CAAC,CAAC;gBAClE,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,GAAG,KAAI,CAAC,YAAY,CAAC,CAAC;gBACtE,KAAI,CAAC,UAAU,GAAG,KAAI,CAAC,YAAY,CAAC;YACtC,CAAC;YAED,MAAM,CAAC,KAAI,CAAC,YAAY,GAAG,qBAAa,CAAC;QAC3C,CAAC,CAAA;QAED;;WAEG;QACK,oBAAc,GAAG;YACvB,MAAM,CAAC,KAAI,CAAC,UAAU,GAAG,qBAAa,CAAC;QACzC,CAAC,CAAA;QAED;;WAEG;QACK,0BAAoB,GAAG,UAAC,IAAc,EAAE,KAAyB;YACvE,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;YAElD,MAAM,CAAC,CACL,6BACE,SAAS,EAAE,4CAAM,CAAC,wBAAwB,uBACvB,IAAI,EACvB,KAAK,EAAE;oBACL,KAAK,EAAE,GAAG,GAAG,KAAI,CAAC,YAAY,GAAG,GAAG;iBACrC;gBAED,6BAAK,SAAS,EAAE,4CAAM,CAAC,yBAAyB;oBAC9C,6BAAK,SAAS,EAAE,4CAAM,CAAC,0BAA0B;wBAC/C,oBAAC,aAAK,IAAC,GAAG,EAAE,MAAM,EAAE,SAAS,EAAE,4CAAM,CAAC,yBAAyB,EAAE,QAAQ,EAAE,gBAAQ,CAAC,KAAK,GAAI;wBAC7F,oBAAC,sBAAa,IAAC,SAAS,EAAE,4CAAM,CAAC,yBAAyB,EAAE,OAAO,EAAE,UAAC,MAAM,IAAK,OAAA,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAA7B,CAA6B,IAAG,IAAI,CAAC,KAAK,CAAiB,CACxI,CACF,CACF,CACP,CAAC;QACJ,CAAC,CAAA;QAID;;WAEG;QACK,wBAAkB,GAAG,UAAC,OAAiB;YAC7C,KAAI,CAAC,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QACpC,CAAC,CAAA;QAvFC,KAAI,CAAC,KAAK,GAAG;YACX,SAAS,EAAE,IAAI;YACf,KAAK,EAAE,EAAE;SACV,CAAC;;IACJ,CAAC;IAEY,kDAAiB,GAA9B;;;;;4BACgB,qBAAM,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,qBAAqB,EAAE,EAAA;;wBAAnE,KAAK,GAAG,SAA2D;wBACzE,IAAI,CAAC,QAAQ,CAAC;4BACZ,KAAK,EAAE,KAAK;4BACZ,SAAS,EAAE,KAAK;yBACjB,CAAC,CAAC;;;;;KACJ;IAEM,uCAAM,GAAb;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;YACzB,MAAM,CAAC,CAAC,oBAAC,iBAAO,IAAC,KAAK,EAAE,OAAO,CAAC,OAAO,GAAI,CAAC,CAAC;QAC/C,CAAC;QACD,IAAM,SAAS,GAAe,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;QAE/C,MAAM,CAAC,CACL,6BAAK,SAAS,EAAE,4CAAM,CAAC,+BAA+B;YACpD,oBAAC,qBAAS;gBACR,oBAAC,WAAI,IACH,SAAS,EAAE,4CAAM,CAAC,wBAAwB,EAC1C,KAAK,EAAE,SAAS,EAChB,mBAAmB,EAAE,IAAI,CAAC,oBAAoB,EAC9C,aAAa,EAAE,IAAI,CAAC,cAAc,EAClC,oBAAoB,EAAE,CAAC,EACvB,YAAY,EAAE,IAAI,CAAC,oBAAoB,GACvC,CACQ,CACR,CACP,CAAC;IACJ,CAAC;IAsDH,6BAAC;AAAD,CAhGA,AAgGC,CAhG2C,KAAK,CAAC,SAAS,GAgG1D;AAhGY,wDAAsB","file":"controls/filePicker/controls/DocumentLibraryBrowser/DocumentLibraryBrowser.js","sourcesContent":["import * as React from 'react';\nimport { FocusZone } from 'office-ui-fabric-react/lib/FocusZone';\nimport { List } from 'office-ui-fabric-react/lib/List';\nimport { Spinner } from 'office-ui-fabric-react/lib/Spinner';\nimport { Image, ImageFit } from 'office-ui-fabric-react/lib/Image';\nimport { IDocumentLibraryBrowserProps, IDocumentLibraryBrowserState } from '.';\nimport { ILibrary } from '../../../../services/FileBrowserService.types';\n\nimport { IRectangle } from 'office-ui-fabric-react/lib/Utilities';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\n\nimport styles from './DocumentLibraryBrowser.module.scss';\nimport * as strings from 'ControlStrings';\n\n/**\n * Rows per page\n */\nexport const ROWS_PER_PAGE = 3;\n\n/**\n * Maximum row height\n */\nexport const MAX_ROW_HEIGHT = 250;\n\n/**\n * This would have been better done as an Office Fabric TileList, but it isn't available yet for production use\n */\nexport class DocumentLibraryBrowser extends React.Component<IDocumentLibraryBrowserProps, IDocumentLibraryBrowserState> {\n  private _columnCount: number;\n  private _columnWidth: number;\n  private _rowHeight: number;\n\n  constructor(props: IDocumentLibraryBrowserProps) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      lists: []\n    };\n  }\n\n  public async componentDidMount() {\n    const lists = await this.props.fileBrowserService.getSiteMediaLibraries();\n    this.setState({\n      lists: lists,\n      isLoading: false\n    });\n  }\n\n  public render(): React.ReactElement<IDocumentLibraryBrowserProps> {\n    if (this.state.isLoading) {\n      return (<Spinner label={strings.Loading} />);\n    }\n    const libraries: ILibrary[] = this.state.lists;\n\n    return (\n      <div className={styles.documentLibraryBrowserContainer}>\n        <FocusZone>\n          <List\n            className={styles.filePickerFolderCardGrid}\n            items={libraries}\n            getItemCountForPage={this._getItemCountForPage}\n            getPageHeight={this._getPageHeight}\n            renderedWindowsAhead={4}\n            onRenderCell={this._onRenderLibraryTile}\n          />\n        </FocusZone>\n      </div>\n    );\n  }\n\n  /**\n   * Calculates how many items there should be in the page\n   */\n  private _getItemCountForPage = (itemIndex: number, surfaceRect: IRectangle): number => {\n    if (itemIndex === 0) {\n      this._columnCount = Math.ceil(surfaceRect.width / MAX_ROW_HEIGHT);\n      this._columnWidth = Math.floor(surfaceRect.width / this._columnCount);\n      this._rowHeight = this._columnWidth;\n    }\n\n    return this._columnCount * ROWS_PER_PAGE;\n  }\n\n  /**\n   * Gets the height of a list \"page\"\n   */\n  private _getPageHeight = (): number => {\n    return this._rowHeight * ROWS_PER_PAGE;\n  }\n\n  /**\n   * Renders a cell for search suggestions\n   */\n  private _onRenderLibraryTile = (item: ILibrary, index: number | undefined): JSX.Element => {\n    const imgSrc = item.iconPath ? item.iconPath : \"\";\n\n    return (\n      <div\n        className={styles.filePickerFolderCardTile}\n        data-is-focusable={true}\n        style={{\n          width: 100 / this._columnCount + '%'\n        }}\n      >\n        <div className={styles.filePickerFolderCardSizer}>\n          <div className={styles.filePickerFolderCardPadder}>\n            <Image src={imgSrc} className={styles.filePickerFolderCardImage} imageFit={ImageFit.cover} />\n            <DefaultButton className={styles.filePickerFolderCardLabel} onClick={(_event) => this._handleOpenLibrary(item)}>{item.title}</DefaultButton>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n\n\n  /**\n   * Calls parent when library is opened\n   */\n  private _handleOpenLibrary = (library: ILibrary) => {\n    this.props.onOpenLibrary(library);\n  }\n}\n"],"sourceRoot":"../../../../../src"}