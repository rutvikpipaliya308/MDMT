{"version":3,"sources":["controls/taxonomyPicker/termActions/DropdownTermAction.tsx"],"names":[],"mappings":"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","file":"controls/taxonomyPicker/termActions/DropdownTermAction.js","sourcesContent":["import * as React from 'react';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { ITerm } from '../../../services/ISPTermStorePickerService';\nimport { ITermAction, TermActionsDisplayStyle, IConcreteTermActionProps, ActionChange } from './ITermsActions';\nimport { IContextualMenuItem, IContextualMenuProps } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { getTermActionChange } from './getTermActionChange';\n\nexport class DropdownTermAction extends React.Component<IConcreteTermActionProps> {\n\n  /**\n   * componentWillMount lifecycle hook\n   */\n  public componentWillMount(): void {\n    this.checkForImmediateInvocations();\n  }\n\n  /**\n   * Prepates contextual menu items for dropdown.\n   */\n  private prepareContextualMenuProps = (term: ITerm, termActions: ITermAction[]): IContextualMenuProps => {\n    let items: IContextualMenuItem[] = [];\n    const displayStyle = this.props.displayStyle;\n    let useTargetWidth = true;\n\n    // Get term action changes\n    const { termActionChanges } = this.props;\n    const tac: ActionChange[] = termActionChanges[term.Id];\n\n    for (const termAction of termActions) {\n      const { actionDisabled, actionHidden } = getTermActionChange(tac, termAction);\n\n      if ((!termAction.hidden && !actionHidden) || !actionHidden) {\n        let termActionMenuItem: IContextualMenuItem = {\n          key: term.Id.toString(),\n          onClick: () => { this.onActionExecute(termAction); },\n          disabled: actionDisabled\n        };\n\n        if (displayStyle && (displayStyle === TermActionsDisplayStyle.text || displayStyle === TermActionsDisplayStyle.textAndIcon)) {\n          termActionMenuItem.text = termAction.title;\n          termActionMenuItem.name = termAction.title;\n          useTargetWidth = false;\n        }\n        if (displayStyle && (displayStyle === TermActionsDisplayStyle.icon || displayStyle === TermActionsDisplayStyle.textAndIcon)) {\n          termActionMenuItem.iconProps = { iconName: termAction.iconName };\n        }\n\n        items.push(termActionMenuItem);\n      }\n    }\n\n    const contextualMenuProps: IContextualMenuProps = {\n      items,\n      useTargetWidth\n    };\n    return contextualMenuProps;\n  }\n\n  /**\n   * Prepare term action button style.\n   */\n  private getTermActionActionButtonStyle = (): React.CSSProperties => {\n    let result: React.CSSProperties = {\n      backgroundColor: \"transparent\",\n      width: \"14px\",\n      display: \"inline-flex\",\n      padding: \"0px\"\n    };\n\n    return result;\n  }\n\n  /**\n   * Check if there are action to immediatly invoke\n   */\n  private checkForImmediateInvocations() {\n    const { termActions } = this.props;\n    for (const action of termActions) {\n      if (action.invokeActionOnRender) {\n        this.onActionExecute(action);\n      }\n    }\n  }\n\n  /**\n   * Handler to execute selected action.\n   */\n  private onActionExecute = async (termAction: ITermAction) => {\n    const updateAction = await termAction.actionCallback(this.props.spTermService, this.props.term);\n    this.props.termActionCallback(updateAction);\n  }\n\n  /**\n   * Default React render method\n   */\n  public render(): React.ReactElement<IConcreteTermActionProps> {\n    const { term, termActions } = this.props;\n\n    const termActionButtonStyle = this.getTermActionActionButtonStyle();\n    const contextualMenuProps = this.prepareContextualMenuProps(term, termActions);\n\n    return (\n      <div style={{ display: 'flex', alignItems: 'stretch', height: '32px' }}>\n        <DefaultButton style={termActionButtonStyle} menuProps={contextualMenuProps} />\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"../../../../src"}