{"version":3,"sources":["controls/listPicker/ListPicker.tsx"],"names":[],"mappings":"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","file":"controls/listPicker/ListPicker.js","sourcesContent":["import * as React from 'react';\nimport { IDropdownOption, IDropdownProps, Dropdown } from 'office-ui-fabric-react/lib/components/Dropdown';\nimport { Spinner, SpinnerSize } from 'office-ui-fabric-react/lib/components/Spinner';\nimport { IListPickerProps, IListPickerState } from './IListPicker';\nimport { ISPService } from '../../services/ISPService';\nimport { SPServiceFactory } from '../../services/SPServiceFactory';\nimport * as telemetry from '../../common/telemetry';\n\nimport styles from './ListPicker.module.scss';\nimport { cloneDeep } from '@microsoft/sp-lodash-subset';\n\n/**\n* Empty list value, to be checked for single list selection\n*/\nconst EMPTY_LIST_KEY = 'NO_LIST_SELECTED';\n\n/**\n* Renders the controls for the ListPicker component\n*/\nexport class ListPicker extends React.Component<IListPickerProps, IListPickerState> {\n  private _selectedList: string | string[] = null;\n\n  /**\n  * Constructor method\n  */\n  constructor(props: IListPickerProps) {\n    super(props);\n\n    telemetry.track('ReactListPicker');\n\n    this.state = {\n      options: [],\n      loading: false\n    };\n  }\n\n  /**\n  * Lifecycle hook when component is mounted\n  */\n  public componentDidMount() {\n    this.loadLists();\n  }\n\n  /**\n   * componentDidUpdate lifecycle hook\n   * @param prevProps\n   * @param prevState\n   */\n  public componentDidUpdate(prevProps: IListPickerProps, prevState: IListPickerState): void {\n    if (\n      prevProps.baseTemplate !== this.props.baseTemplate ||\n      prevProps.includeHidden !== this.props.includeHidden ||\n      prevProps.orderBy !== this.props.orderBy\n    ) {\n      this.loadLists();\n    }\n\n    if (prevProps.selectedList !== this.props.selectedList) {\n      this.setSelectedLists();\n    }\n  }\n\n  /**\n  * Loads the list from SharePoint current web site\n  */\n  private loadLists() {\n    const { context, baseTemplate, includeHidden, orderBy, multiSelect, filter } = this.props;\n\n    // Show the loading indicator and disable the dropdown\n    this.setState({ loading: true });\n\n    const service: ISPService = SPServiceFactory.createService(context, true, 5000);\n    service.getLibs({\n      baseTemplate: baseTemplate,\n      includeHidden: includeHidden,\n      orderBy: orderBy,\n      filter: filter\n    }).then((results) => {\n      let options: IDropdownOption[] = [];\n\n      // Start mapping the lists to the dropdown option\n      options = results.value.map(list => ({\n        key: list.Id,\n        text: list.Title\n      }));\n\n      if (multiSelect !== true) {\n        // Add option to unselct list\n        options.unshift({\n          key: EMPTY_LIST_KEY,\n          text: ''\n        });\n      }\n\n      this.setSelectedLists();\n\n      // Hide the loading indicator and set the dropdown options and enable the dropdown\n      this.setState({\n        loading: false,\n        options: options\n      });\n    });\n  }\n\n  /**\n   * Set the currently selected list\n   */\n  private setSelectedLists() {\n    this._selectedList = cloneDeep(this.props.selectedList);\n    this.setState({\n      selectedList: this._selectedList\n    });\n  }\n\n  /**\n  * Raises when a list has been selected\n  * @param option the new selection\n  * @param index the index of the selection\n  */\n  private onChanged = (option: IDropdownOption, index?: number): void => {\n    const { multiSelect, onSelectionChanged } = this.props;\n\n    if (multiSelect === true) {\n      // Check if option was selected\n      let selectedLists = this._selectedList ? cloneDeep(this._selectedList) as string[] : [];\n      if (option.selected) {\n        selectedLists.push(option.key as string);\n      } else {\n        // Filter out the unselected list\n        selectedLists = selectedLists.filter(list => list !== option.key);\n      }\n      this._selectedList = selectedLists;\n    } else {\n      this._selectedList = option.key as string;\n    }\n\n    if (onSelectionChanged) {\n      onSelectionChanged(cloneDeep(this._selectedList));\n    }\n  }\n\n  /**\n  * Renders the ListPicker controls with Office UI Fabric\n  */\n  public render(): JSX.Element {\n    const { loading, options, selectedList } = this.state;\n    const { className, disabled, multiSelect, label, placeHolder, placeholder } = this.props;\n\n    const dropdownOptions: IDropdownProps = {\n      className: className,\n      options: options,\n      disabled: ( loading || disabled ),\n      label: label,\n      placeHolder: placeholder || placeHolder,\n      onChanged: this.onChanged\n    };\n\n    if (multiSelect === true) {\n      dropdownOptions.multiSelect = true;\n      dropdownOptions.selectedKeys = selectedList as string[];\n    } else {\n      dropdownOptions.selectedKey = selectedList as string;\n    }\n\n    return (\n      <div className={ styles.listPicker }>\n        { loading && <Spinner className={ styles.spinner } size={SpinnerSize.xSmall} /> }\n        <Dropdown {...dropdownOptions} />\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"../../../src"}