import { ODataParser } from "./core";
import { FetchOptions } from "@pnp/common";
export interface ODataBatchRequestInfo {
    url: string;
    method: string;
    options: FetchOptions;
    parser: ODataParser<any>;
    resolve: ((d: any) => void) | null;
    reject: ((error: any) => void) | null;
}
export declare abstract class ODataBatch {
    private _batchId;
    protected _dependencies: Promise<void>[];
    protected _requests: ODataBatchRequestInfo[];
    constructor(_batchId?: string);
    readonly batchId: string;
    /**
     * The requests contained in this batch
     */
    protected readonly requests: ODataBatchRequestInfo[];
    /**
     *
     * @param url Request url
     * @param method Request method (GET, POST, etc)
     * @param options Any request options
     * @param parser The parser used to handle the eventual return from the query
     */
    add<T>(url: string, method: string, options: FetchOptions, parser: ODataParser<T>): Promise<T>;
    /**
     * Adds a dependency insuring that some set of actions will occur before a batch is processed.
     * MUST be cleared using the returned resolve delegate to allow batches to run
     */
    addDependency(): () => void;
    /**
     * Execute the current batch and resolve the associated promises
     *
     * @returns A promise which will be resolved once all of the batch's child promises have resolved
     */
    execute(): Promise<void>;
    protected abstract executeImpl(): Promise<void>;
}
