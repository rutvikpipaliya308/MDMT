/**
@license
 * @pnp/sp v1.0.1 - pnp - provides a fluent api for working with SharePoint REST
 * MIT (https://github.com/pnp/pnp/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: http://officedev.github.io/PnP-JS-Core
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@pnp/common"),require("@pnp/logging"),require("@pnp/odata")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/common","@pnp/logging","@pnp/odata"],t):t((e.pnp=e.pnp||{},e.pnp.sp={}),e.tslib_1,e.pnp.common,e.pnp.logging,e.pnp.odata)}(this,function(e,t,n,r,o){"use strict";function i(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}var a=function(e){function n(t){var n=e.call(this,t)||this;return n.name="BatchParseException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),s=function(e){function n(t,n){void 0===n&&(n="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var o=e.call(this,n)||this;return o.data=t,o.name="ODataIdException",r.Logger.error(o),o}return t.__extends(n,e),n}(Error),u=function(e){function n(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var n=e.call(this,t)||this;return n.name="MaxCommentLengthException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),l=function(e){function n(t){void 0===t&&(t="This operation");var n=e.call(this,t+" is not supported as part of a batch.")||this;return n.name="NotSupportedInBatchException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error),p=function(e){function n(t){void 0===t&&(t="Unable to determine API url.");var n=e.call(this,t)||this;return n.name="APIUrlException",r.Logger.error(n),n}return t.__extends(n,e),n}(Error);function c(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new s(e)}var d=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)},r}return t.__extends(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)})},r}(o.ODataParserBase),h=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)})},r}return t.__extends(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(f(e),null);return n.Util.extend(t,e)})})},r}(o.ODataParserBase);function f(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?n.Util.combinePaths(i(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(r.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),"")}function y(e){return new d(e)}var g=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.baseUrl?e.baseUrl:null!==n.RuntimeConfig.spfxContext?n.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new n.FetchClient}},enumerable:!0,configurable:!0}),e}()),m=function(){return function(){}}(),b=new n.Dictionary,v=function(){function e(e,t){void 0===t&&(t=b),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(null!==r&&new Date<r.expiration)return Promise.resolve(r.value);var i=n.Util.combinePaths(e,"/_api/contextinfo");return this._httpClient.fetchRaw(i,{cache:"no-cache",credentials:"same-origin",headers:n.Util.extend({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},g.headers,!0),method:"POST"}).then(function(e){return(new o.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new m;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.add(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),P=function(){function e(){this._impl=g.fetchClientFactory(),this._digestCache=new v(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var o=n.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;if(n.mergeHeaders(i,g.headers),n.mergeHeaders(i,t.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),i.has("User-Agent")||i.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/$$Version$$"),(o=n.Util.extend(o,{headers:i})).method&&"GET"!==o.method.toUpperCase()&&!i.has("X-RequestDigest")&&!i.has("Authorization")){var a=e.indexOf("_api/");if(a<0)throw new p;var s=e.substr(0,a);return this._digestCache.getDigest(s).then(function(t){return i.append("X-RequestDigest",t),r.fetchRaw(e,o)})}return this.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;n.mergeHeaders(o,t.headers),t=n.Util.extend(t,{headers:o});var i=function(o){r._impl.fetch(e,t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(n.Util.getCtxCallback(r,i,o),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.Util.extend(t,{method:"DELETE"});return this.fetch(e,r)},e}();function w(e){return new Promise(function(t){if(n.Util.isUrlAbsolute(e))return t(e);if(null!==g.baseUrl)return t(n.Util.combinePaths(g.baseUrl,e));if(void 0!==global._spPageContextInfo){if(global._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return t(n.Util.combinePaths(global._spPageContextInfo.webAbsoluteUrl,e));if(global._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return t(n.Util.combinePaths(global._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==global.location){var r=global.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(o){var i=r.indexOf(o);if(i>0)return t(n.Util.combinePaths(r.substr(0,i),e))})}return t(e)})}var S,C,T=function(e){function o(t,r){var o=e.call(this)||this;if("string"==typeof t){var i=t;if(n.Util.isUrlAbsolute(i)||i.lastIndexOf("/")<0)o._parentUrl=i,o._url=n.Util.combinePaths(i,r);else if(i.lastIndexOf("/")>i.lastIndexOf("(")){var a=i.lastIndexOf("/");o._parentUrl=i.slice(0,a),r=n.Util.combinePaths(i.slice(a),r),o._url=n.Util.combinePaths(o._parentUrl,r)}else{a=i.lastIndexOf("(");o._parentUrl=i.slice(0,a),o._url=n.Util.combinePaths(i,r)}}else{var s=t;o._parentUrl=s._url,o._options=s._options;var u=s._query.get("@target");null!==u&&o._query.add("@target",u),o._url=n.Util.combinePaths(o._parentUrl,r)}return o}return t.__extends(o,e),o.prototype.as=function(e){var t=new e(this._url,null);return n.Util.extend(t,this,!0)},o.prototype.toUrlAndQuery=function(){var e=new n.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,o){return r.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+o,0),e.add(n,"'"+o+"'"),n});return e.merge(this._query),e.count>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},o.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==r&&(o=o.inBatch(r)),o},o.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=new e(this,t),o=this.query.get("@target");return null!==o&&r.query.add("@target",o),n&&this.hasBatch&&(r=r.inBatch(this.batch)),r},o.prototype.toRequestContext=function(e,t,r,o){var i=this;void 0===t&&(t={});var a=this.hasBatch?this.addBatchDependency():function(){};return w(this.toUrlAndQuery()).then(function(s){return n.mergeOptions(t,i._options),{batch:i.batch,batchDependency:a,cachingOptions:i._cachingOptions,clientFactory:function(){return new P},isBatched:i.hasBatch,isCached:i._useCaching,options:t,parser:r,pipeline:o,requestAbsoluteUrl:s,requestId:n.Util.getGUID(),verb:e}})},o}(o.ODataQueryable),_=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.filter=function(e){return this._query.add("$filter",e),this},n.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},n.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},n.prototype.orderBy=function(e,t){void 0===t&&(t=!0);for(var n=this._query.getKeys(),r=[],o=t?" asc":" desc",i=0;i<n.length;i++)if("$orderby"===n[i]){r.push(this._query.get("$orderby"));break}return r.push(""+e+o),this._query.add("$orderby",r.join(",")),this},n.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},n.prototype.top=function(e){return this._query.add("$top",e.toString()),this},n}(T),O=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},n.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},n}(T),x=function(e){function n(t,n){return void 0===n&&(n="siteusers"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByEmail=function(e){return new I(this,"getByEmail('"+e+"')")},n.prototype.getById=function(e){return new I(this,"getById("+e+")")},n.prototype.getByLoginName=function(e){var t=new I(this);return t.concat("(@v)"),t.query.add("@v","'"+encodeURIComponent(e)+"'"),t},n.prototype.removeById=function(e){return this.clone(n,"removeById("+e+")").postCore()},n.prototype.removeByLoginName=function(e){var t=this.clone(n,"removeByLoginName(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},n.prototype.add=function(e){var t=this;return this.clone(n,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return t.getByLoginName(e)})},n}(_),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"groups",{get:function(){return new J(this,"groups")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=n.Util.extend({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),U=function(e){function n(t,n){return void 0===n&&(n="currentuser"),e.call(this,t,n)||this}return t.__extends(n,e),n}(O);(C=S||(S={}))[C.None=0]="None",C[C.User=1]="User",C[C.DistributionList=2]="DistributionList",C[C.SecurityGroup=4]="SecurityGroup",C[C.SharePointGroup=8]="SharePointGroup",C[C.All=15]="All";var L,R,B,D,N,E,F,j,A,k,M,q,Q,H,W,V,G,J=function(e){function r(t,n){return void 0===n&&(n="sitegroups"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.add=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Group"}},e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},r.prototype.getByName=function(e){return new X(this,"getByName('"+e+"')")},r.prototype.getById=function(e){var t=new X(this);return t.concat("("+e+")"),t},r.prototype.removeById=function(e){return this.clone(r,"removeById('"+e+"')").postCore()},r.prototype.removeByLoginName=function(e){return this.clone(r,"removeByLoginName('"+e+"')").postCore()},r}(_),X=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"users",{get:function(){return new x(this,"users")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,o=n.Util.extend({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(o),headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=t;return e.hasOwnProperty("Title")&&(o=t.getParent(r,t.parentUrl,"getByName('"+e.Title+"')")),{data:n,group:o}})},r}(O),K=function(e){function n(t,n){return void 0===n&&(n="roleassignments"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.add=function(e,t){return this.clone(n,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},n.prototype.remove=function(e,t){return this.clone(n,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},n.prototype.getById=function(e){var t=new z(this);return t.concat("("+e+")"),t},n}(_),z=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"groups",{get:function(){return new J(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bindings",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(O),$=function(e){function r(t,n){return void 0===n&&(n="roledefinitions"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){return new Z(this,"getById("+e+")")},r.prototype.getByName=function(e){return new Z(this,"getbyname('"+e+"')")},r.prototype.getByType=function(e){return new Z(this,"getbytype("+e+")")},r.prototype.add=function(e,t,r,o){var i=this,a=JSON.stringify({BasePermissions:n.Util.extend({__metadata:{type:"SP.BasePermissions"}},o),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:a}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},r}(_),Z=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=n.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var r=t;e.hasOwnProperty("Name")&&(r=t.getParent($,t.parentUrl,"").getByName(e.Name));return{data:n,definition:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),Y=function(e){function n(t,n){return void 0===n&&(n="roledefinitionbindings"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_);(L=e.ControlMode||(e.ControlMode={}))[L.Display=1]="Display",L[L.Edit=2]="Edit",L[L.New=3]="New",(R=e.FieldTypes||(e.FieldTypes={}))[R.Invalid=0]="Invalid",R[R.Integer=1]="Integer",R[R.Text=2]="Text",R[R.Note=3]="Note",R[R.DateTime=4]="DateTime",R[R.Counter=5]="Counter",R[R.Choice=6]="Choice",R[R.Lookup=7]="Lookup",R[R.Boolean=8]="Boolean",R[R.Number=9]="Number",R[R.Currency=10]="Currency",R[R.URL=11]="URL",R[R.Computed=12]="Computed",R[R.Threading=13]="Threading",R[R.Guid=14]="Guid",R[R.MultiChoice=15]="MultiChoice",R[R.GridChoice=16]="GridChoice",R[R.Calculated=17]="Calculated",R[R.File=18]="File",R[R.Attachments=19]="Attachments",R[R.User=20]="User",R[R.Recurrence=21]="Recurrence",R[R.CrossProjectLink=22]="CrossProjectLink",R[R.ModStat=23]="ModStat",R[R.Error=24]="Error",R[R.ContentTypeId=25]="ContentTypeId",R[R.PageSeparator=26]="PageSeparator",R[R.ThreadIndex=27]="ThreadIndex",R[R.WorkflowStatus=28]="WorkflowStatus",R[R.AllDayEvent=29]="AllDayEvent",R[R.WorkflowEventType=30]="WorkflowEventType",(B=e.DateTimeFieldFormatType||(e.DateTimeFieldFormatType={}))[B.DateOnly=0]="DateOnly",B[B.DateTime=1]="DateTime",(D=e.AddFieldOptions||(e.AddFieldOptions={}))[D.DefaultValue=0]="DefaultValue",D[D.AddToDefaultContentType=1]="AddToDefaultContentType",D[D.AddToNoContentType=2]="AddToNoContentType",D[D.AddToAllContentTypes=4]="AddToAllContentTypes",D[D.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",D[D.AddFieldToDefaultView=16]="AddFieldToDefaultView",D[D.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName",(N=e.CalendarType||(e.CalendarType={}))[N.Gregorian=1]="Gregorian",N[N.Japan=3]="Japan",N[N.Taiwan=4]="Taiwan",N[N.Korea=5]="Korea",N[N.Hijri=6]="Hijri",N[N.Thai=7]="Thai",N[N.Hebrew=8]="Hebrew",N[N.GregorianMEFrench=9]="GregorianMEFrench",N[N.GregorianArabic=10]="GregorianArabic",N[N.GregorianXLITEnglish=11]="GregorianXLITEnglish",N[N.GregorianXLITFrench=12]="GregorianXLITFrench",N[N.KoreaJapanLunar=14]="KoreaJapanLunar",N[N.ChineseLunar=15]="ChineseLunar",N[N.SakaEra=16]="SakaEra",N[N.UmAlQura=23]="UmAlQura",(E=e.UrlFieldFormatType||(e.UrlFieldFormatType={}))[E.Hyperlink=0]="Hyperlink",E[E.Image=1]="Image",(F=e.PermissionKind||(e.PermissionKind={}))[F.EmptyMask=0]="EmptyMask",F[F.ViewListItems=1]="ViewListItems",F[F.AddListItems=2]="AddListItems",F[F.EditListItems=3]="EditListItems",F[F.DeleteListItems=4]="DeleteListItems",F[F.ApproveItems=5]="ApproveItems",F[F.OpenItems=6]="OpenItems",F[F.ViewVersions=7]="ViewVersions",F[F.DeleteVersions=8]="DeleteVersions",F[F.CancelCheckout=9]="CancelCheckout",F[F.ManagePersonalViews=10]="ManagePersonalViews",F[F.ManageLists=12]="ManageLists",F[F.ViewFormPages=13]="ViewFormPages",F[F.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",F[F.Open=17]="Open",F[F.ViewPages=18]="ViewPages",F[F.AddAndCustomizePages=19]="AddAndCustomizePages",F[F.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",F[F.ApplyStyleSheets=21]="ApplyStyleSheets",F[F.ViewUsageData=22]="ViewUsageData",F[F.CreateSSCSite=23]="CreateSSCSite",F[F.ManageSubwebs=24]="ManageSubwebs",F[F.CreateGroups=25]="CreateGroups",F[F.ManagePermissions=26]="ManagePermissions",F[F.BrowseDirectories=27]="BrowseDirectories",F[F.BrowseUserInfo=28]="BrowseUserInfo",F[F.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",F[F.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",F[F.ManageWeb=31]="ManageWeb",F[F.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",F[F.UseClientIntegration=37]="UseClientIntegration",F[F.UseRemoteAPIs=38]="UseRemoteAPIs",F[F.ManageAlerts=39]="ManageAlerts",F[F.CreateAlerts=40]="CreateAlerts",F[F.EditMyUserInfo=41]="EditMyUserInfo",F[F.EnumeratePermissions=63]="EnumeratePermissions",F[F.FullMask=65]="FullMask",(j=e.PrincipalType||(e.PrincipalType={}))[j.None=0]="None",j[j.User=1]="User",j[j.DistributionList=2]="DistributionList",j[j.SecurityGroup=4]="SecurityGroup",j[j.SharePointGroup=8]="SharePointGroup",j[j.All=15]="All",(A=e.PrincipalSource||(e.PrincipalSource={}))[A.None=0]="None",A[A.UserInfoList=1]="UserInfoList",A[A.Windows=2]="Windows",A[A.MembershipProvider=4]="MembershipProvider",A[A.RoleProvider=8]="RoleProvider",A[A.All=15]="All",(k=e.RoleType||(e.RoleType={}))[k.None=0]="None",k[k.Guest=1]="Guest",k[k.Reader=2]="Reader",k[k.Contributor=3]="Contributor",k[k.WebDesigner=4]="WebDesigner",k[k.Administrator=5]="Administrator",(M=e.PageType||(e.PageType={}))[M.Invalid=-1]="Invalid",M[M.DefaultView=0]="DefaultView",M[M.NormalView=1]="NormalView",M[M.DialogView=2]="DialogView",M[M.View=3]="View",M[M.DisplayForm=4]="DisplayForm",M[M.DisplayFormDialog=5]="DisplayFormDialog",M[M.EditForm=6]="EditForm",M[M.EditFormDialog=7]="EditFormDialog",M[M.NewForm=8]="NewForm",M[M.NewFormDialog=9]="NewFormDialog",M[M.SolutionForm=10]="SolutionForm",M[M.PAGE_MAXITEMS=11]="PAGE_MAXITEMS",(q=e.SharingLinkKind||(e.SharingLinkKind={}))[q.Uninitialized=0]="Uninitialized",q[q.Direct=1]="Direct",q[q.OrganizationView=2]="OrganizationView",q[q.OrganizationEdit=3]="OrganizationEdit",q[q.AnonymousView=4]="AnonymousView",q[q.AnonymousEdit=5]="AnonymousEdit",q[q.Flexible=6]="Flexible",(Q=e.SharingRole||(e.SharingRole={}))[Q.None=0]="None",Q[Q.View=1]="View",Q[Q.Edit=2]="Edit",Q[Q.Owner=3]="Owner",(H=e.SharingOperationStatusCode||(e.SharingOperationStatusCode={}))[H.CompletedSuccessfully=0]="CompletedSuccessfully",H[H.AccessRequestsQueued=1]="AccessRequestsQueued",H[H.NoResolvedUsers=-1]="NoResolvedUsers",H[H.AccessDenied=-2]="AccessDenied",H[H.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",H[H.UnknowError=-4]="UnknowError",H[H.EmailBodyTooLong=-5]="EmailBodyTooLong",H[H.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",H[H.CapabilityDisabled=-7]="CapabilityDisabled",H[H.ObjectNotSupported=-8]="ObjectNotSupported",H[H.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",(W=e.SPSharedObjectType||(e.SPSharedObjectType={}))[W.Unknown=0]="Unknown",W[W.File=1]="File",W[W.Folder=2]="Folder",W[W.Item=3]="Item",W[W.List=4]="List",W[W.Web=5]="Web",W[W.Max=6]="Max",(V=e.SharingDomainRestrictionMode||(e.SharingDomainRestrictionMode={}))[V.None=0]="None",V[V.AllowList=1]="AllowList",V[V.BlockList=2]="BlockList",(G=e.RenderListDataOptions||(e.RenderListDataOptions={}))[G.None=0]="None",G[G.ContextInfo=1]="ContextInfo",G[G.ListData=2]="ListData",G[G.ListSchema=4]="ListSchema",G[G.MenuView=8]="MenuView";var ee,te,ne,re,oe=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),Object.defineProperty(r.prototype,"roleAssignments",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new O(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),r.prototype.getUserEffectivePermissions=function(e){var t=this.clone(T,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},r.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new O("_api/web","currentuser").select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},r.prototype.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.clone(r,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")").postCore()},r.prototype.resetRoleInheritance=function(){return this.clone(r,"resetroleinheritance").postCore()},r.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},r.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},r.prototype.hasPermissions=function(t,n){if(!n)return!0;if(n===e.PermissionKind.FullMask)return 32767==(32767&t.High)&&65535===t.Low;var r=1;return(n-=1)>=0&&n<32?(r<<=n,0!=(t.Low&r)):n>=32&&n<64&&(r<<=n-32,0!=(t.High&r))},r}(O),ie=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(o,r),o.prototype.getShareLink=function(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null;return this.clone(o,"shareLink").postCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},o.prototype.shareWith=function(t,r,i,a,s){var u=this;void 0===i&&(i=!1),void 0===a&&(a=!1),Array.isArray(t)||(t=[t]);var l=JSON.stringify(t.map(function(e){return{Key:e}})),p=r===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return new _("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var t={includeAnonymousLinkInEmail:i,peoplePickerInput:l,propagateAcl:a,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==s&&(t=n.Util.extend(t,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),u.clone(o,"shareObject").postCore({body:JSON.stringify(t)})})},o.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=n.Util.extend(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o={peoplePickerInput:JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=n.Util.extend(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(o)}))},o.prototype.unshareObjectWeb=function(e){return this.clone(o,"unshareObject").postCore({body:JSON.stringify({url:e})})},o.prototype.checkPermissions=function(e){return this.clone(o,"checkPermissions").postCore({body:JSON.stringify({recipients:e})})},o.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(o,"getSharingInformation").postCore({body:JSON.stringify({request:e})})},o.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(o,"getObjectSharingSettings").postCore({body:JSON.stringify({useSimplifiedRoles:e})})},o.prototype.unshareObject=function(){return this.clone(o,"unshareObject").postCore()},o.prototype.deleteLinkByKind=function(e){return this.clone(o,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},o.prototype.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),this.clone(o,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:t})})},o.prototype.getRoleValue=function(t,n){if(void 0===n||null===n){var r=t===e.SharingRole.Edit?e.RoleType.Contributor:e.RoleType.Reader;return new _("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+r).get().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(n){case e.RoleType.Contributor:return new O("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case e.RoleType.Reader:case e.RoleType.Guest:return new O("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},o.prototype.getShareObjectWeb=function(e){return Promise.resolve(new O(i(e),"/_api/SP.Web.ShareObject"))},o.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(t){return t.expand("UsersWithAccessRequests","GroupsSharedWith").as(o).postCore({body:JSON.stringify(e)})})},o}(T),ae=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(o,r),o.prototype.shareWith=function(t,r,o){var a=this;void 0===r&&(r=e.SharingRole.View);var s=this.addBatchDependency();return new O(i(this.toUrl()),"/_api/web/url").get().then(function(e){return s(),a.shareObject(n.Util.combinePaths(e,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),t,r,o)})},o.prototype.shareObject=function(e,t,n,r,o,i,a,s){return void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=!0),this.clone(ie,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:a,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:s})},o.prototype.shareObjectRaw=function(e){return this.clone(ie,null).shareObject(e,!0)},o.prototype.unshareObject=function(e){return this.clone(ie,null).unshareObjectWeb(e)},o}(oe),se=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.getShareLink=function(t,n){return void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===n&&(n=null),this.clone(ie,null).getShareLink(t,n)},r.prototype.shareWith=function(t,n,r,o){return void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1),this.clone(ie,null).shareWith(t,n,r,!1,o)},r.prototype.checkSharingPermissions=function(e){return this.clone(ie,null).checkPermissions(e)},r.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(ie,null).getSharingInformation(e)},r.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(ie,null).getObjectSharingSettings(e)},r.prototype.unshare=function(){return this.clone(ie,null).unshareObject()},r.prototype.deleteSharingLinkByKind=function(e){return this.clone(ie,null).deleteLinkByKind(e)},r.prototype.unshareLink=function(e,t){return this.clone(ie,null).unshareLink(e,t)},r}(oe),ue=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.getShareLink=function(t,n){void 0===t&&(t=e.SharingLinkKind.OrganizationView),void 0===n&&(n=null);var r=this.addBatchDependency();return this.getShareable().then(function(e){return r(),e.getShareLink(t,n)})},r.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},r.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getSharingInformation(e)})},r.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},r.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},r.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},r.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},r.prototype.getShareable=function(){var e=this;return this.clone(le,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var n=new ie(f(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},r}(O),le=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.shareWith=function(t,n,r,o){void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(e){return i(),e.shareWith(t,n,r,!1,o)})},r}(ue),pe=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t.__extends(r,n),r.prototype.shareWith=function(t,n,r,o,i){void 0===n&&(n=e.SharingRole.View),void 0===r&&(r=!1),void 0===o&&(o=!1);var a=this.addBatchDependency();return this.getShareable().then(function(e){return a(),e.shareWith(t,n,r,o,i)})},r}(ue),ce=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"webparts",{get:function(){return new de(this,"webparts")},enumerable:!0,configurable:!0}),n.prototype.export=function(e){return this.clone(n,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},n.prototype.import=function(e){return this.clone(n,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},n}(T),de=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getById=function(e){return new he(this,"getbyid('"+e+"')")},n.prototype.getByControlId=function(e){return new he(this,"getByControlId('"+e+"')")},n}(_),he=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"webpart",{get:function(){return new fe(this)},enumerable:!0,configurable:!0}),n.prototype.saveChanges=function(){return this.clone(n,"SaveWebPartChanges").postCore()},n.prototype.moveTo=function(e,t){return this.clone(n,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")").postCore()},n.prototype.close=function(){return this.clone(n,"CloseWebPart").postCore()},n.prototype.open=function(){return this.clone(n,"OpenWebPart").postCore()},n.prototype.delete=function(){return this.clone(n,"DeleteWebPart").postCore()},n}(O),fe=function(e){function n(t,n){return void 0===n&&(n="webpart"),e.call(this,t,n)||this}return t.__extends(n,e),n}(O),ye=function(e){function n(t,n){return void 0===n&&(n="folders"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new ge(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e){var t=this;return this.clone(n,"add('"+e+"')").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})},n}(_),ge=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"contentTypeOrder",{get:function(){return new _(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"files",{get:function(){return new He(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new ye(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parentFolder",{get:function(){return new r(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"properties",{get:function(){return new O(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"serverRelativeUrl",{get:function(){return new T(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueContentTypeOrder",{get:function(){return new _(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(r,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.Util.extend(new je(f(e)),e)})},r}(pe),me=function(e){function r(t,n){return void 0===n&&(n="contenttypes"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new be(this);return t.concat("('"+e+"')"),t},r.prototype.addAvailableContentType=function(e){var t=this,n=JSON.stringify({contentTypeId:e});return this.clone(r,"addAvailableContentType").postCore({body:n}).then(function(e){return{contentType:t.getById(e.id),data:e}})},r.prototype.add=function(e,t,r,o,i){var a=this;void 0===r&&(r=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var s=JSON.stringify(n.Util.extend({Description:r,Group:o,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:s}).then(function(e){return{contentType:a.getById(e.id),data:e}})},r}(_),be=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"fieldLinks",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fields",{get:function(){return new _(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new n(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"workflowAssociations",{get:function(){return new _(this,"workflowAssociations")},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(O),ve=function(e){function n(t,n){return void 0===n&&(n="fieldlinks"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Pe(this);return t.concat("(guid'"+e+"')"),t},n}(_),Pe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(O),we=function(e){function n(t,n){return void 0===n&&(n="AttachmentFiles"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new Se(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t){var r=this;return this.clone(n,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},n.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,"add(FileName='"+r.name+"')",!1).postCore({body:r.content})})},Promise.resolve())},n.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},n}(_),Se=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getText=function(){return this.getParsed(new o.TextParser)},n.prototype.getBlob=function(){return this.getParsed(new o.BlobParser)},n.prototype.getBuffer=function(){return this.getParsed(new o.BufferParser)},n.prototype.getJSON=function(){return this.getParsed(new o.JSONParser)},n.prototype.setContent=function(e){var t=this;return this.clone(n,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new n(t)})},n.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},n.prototype.getParsed=function(e){return this.clone(n,"$value",!1).get(e)},n}(O),Ce=function(e){function r(t,n){return void 0===n&&(n="views"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new Te(this);return t.concat("('"+e+"')"),t},r.prototype.getByTitle=function(e){return new Te(this,"getByTitle('"+e+"')")},r.prototype.add=function(e,t,o){var i=this;void 0===t&&(t=!1),void 0===o&&(o={});var a=JSON.stringify(n.Util.extend({PersonalView:t,Title:e,__metadata:{type:"SP.View"}},o));return this.clone(r,null).postCore({body:a}).then(function(e){return{data:e,view:i.getById(e.Id)}})},r}(_),Te=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"fields",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.View"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.renderAsHtml=function(){return this.clone(T,"renderashtml").get()},r}(O),_e=function(e){function n(t,n){return void 0===n&&(n="viewfields"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getSchemaXml=function(){return this.clone(T,"schemaxml").get()},n.prototype.add=function(e){return this.clone(n,"addviewfield('"+e+"')").postCore()},n.prototype.move=function(e,t){return this.clone(n,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:t})})},n.prototype.removeAll=function(){return this.clone(n,"removeallviewfields").postCore()},n.prototype.remove=function(e){return this.clone(n,"removeviewfield('"+e+"')").postCore()},n}(_),Oe=function(r){function o(e,t){return void 0===t&&(t="fields"),r.call(this,e,t)||this}return t.__extends(o,r),o.prototype.getByTitle=function(e){return new xe(this,"getByTitle('"+e+"')")},o.prototype.getByInternalNameOrTitle=function(e){return new xe(this,"getByInternalNameOrTitle('"+e+"')")},o.prototype.getById=function(e){var t=new xe(this);return t.concat("('"+e+"')"),t},o.prototype.createFieldAsXml=function(e){var t,r=this;t="string"==typeof e?{SchemaXml:e}:e;var i=JSON.stringify({parameters:n.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},t)});return this.clone(o,"createfieldasxml").postCore({body:i}).then(function(e){return{data:e,field:r.getById(e.Id)}})},o.prototype.add=function(e,t,r){var i=this;void 0===r&&(r={});var a=JSON.stringify(n.Util.extend({Title:e,__metadata:{type:t}},r));return this.clone(o,null).postCore({body:a}).then(function(e){return{data:e,field:i.getById(e.Id)}})},o.prototype.addText=function(e,t,r){void 0===t&&(t=255);var o={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",n.Util.extend(o,r))},o.prototype.addCalculated=function(t,r,o,i,a){void 0===i&&(i=e.FieldTypes.Text);var s={DateFormat:o,FieldTypeKind:17,Formula:r,OutputType:i};return this.add(t,"SP.FieldCalculated",n.Util.extend(s,a))},o.prototype.addDateTime=function(t,r,o,i,a){void 0===r&&(r=e.DateTimeFieldFormatType.DateOnly),void 0===o&&(o=e.CalendarType.Gregorian),void 0===i&&(i=0);var s={DateTimeCalendarType:o,DisplayFormat:r,FieldTypeKind:4,FriendlyDisplayFormat:i};return this.add(t,"SP.FieldDateTime",n.Util.extend(s,a))},o.prototype.addNumber=function(e,t,r,o){var i={FieldTypeKind:9};return void 0!==t&&(i=n.Util.extend({MinimumValue:t},i)),void 0!==r&&(i=n.Util.extend({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",n.Util.extend(i,o))},o.prototype.addCurrency=function(e,t,r,o,i){void 0===o&&(o=1033);var a={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==t&&(a=n.Util.extend({MinimumValue:t},a)),void 0!==r&&(a=n.Util.extend({MaximumValue:r},a)),this.add(e,"SP.FieldCurrency",n.Util.extend(a,i))},o.prototype.addMultilineText=function(e,t,r,o,i,a,s){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===a&&(a=!0);var u={AllowHyperlink:a,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:o,RichText:r};return this.add(e,"SP.FieldMultiLineText",n.Util.extend(u,s))},o.prototype.addUrl=function(t,r,o){void 0===r&&(r=e.UrlFieldFormatType.Hyperlink);var i={DisplayFormat:r,FieldTypeKind:11};return this.add(t,"SP.FieldUrl",n.Util.extend(i,o))},o}(_),xe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var o=JSON.stringify(n.Util.extend({__metadata:{type:t}},e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.setShowInDisplayForm=function(e){return this.clone(r,"setshowindisplayform("+e+")").postCore()},r.prototype.setShowInEditForm=function(e){return this.clone(r,"setshowineditform("+e+")").postCore()},r.prototype.setShowInNewForm=function(e){return this.clone(r,"setshowinnewform("+e+")").postCore()},r}(O),Ie=function(e){function n(t,n){return void 0===n&&(n="forms"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Ue(this);return t.concat("('"+e+"')"),t},n}(_),Ue=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n}(O),Le=function(e){function n(t,n){return void 0===n&&(n="subscriptions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Re(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t,n){var r=this,o=JSON.stringify({clientState:n||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},n}(_),Re=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.update=function(e){var t=this,n=JSON.stringify({expirationDateTime:e});return this.patchCore({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},n.prototype.delete=function(){return e.prototype.deleteCore.call(this)},n}(O),Be=function(e){function r(t,n){return void 0===n&&(n="usercustomactions"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new De(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},r.prototype.clear=function(){return this.clone(r,"clear").postCore()},r}(_),De=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(O),Ne=function(e){function r(t,n){return void 0===n&&(n="lists"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getByTitle=function(e){return new Ee(this,"getByTitle('"+e+"')")},r.prototype.getById=function(e){var t=new Ee(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t,r,o,i){var a=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={});var s=n.Util.extend({AllowContentTypes:o,BaseTemplate:r,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:JSON.stringify(s)}).then(function(e){return{data:e,list:a.getByTitle(s.Title)}})},r.prototype.ensure=function(e,t,r,o,i){var a=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw new l("The ensure list method");return new Promise(function(s,u){var l=n.Util.extend(i,{Title:e,Description:t,ContentTypesEnabled:o},!0),p=a.getByTitle(l.Title);p.get().then(function(e){p.update(l).then(function(e){s({created:!1,data:e,list:a.getByTitle(l.Title)})}).catch(function(e){return u(e)})}).catch(function(n){a.add(e,t,r,o,l).then(function(e){s({created:!0,data:e.data,list:a.getByTitle(l.Title)})}).catch(function(e){return u(e)})})})},r.prototype.ensureSiteAssetsLibrary=function(){return this.clone(r,"ensuresiteassetslibrary").postCore().then(function(e){return new Ee(c(e))})},r.prototype.ensureSitePagesLibrary=function(){return this.clone(r,"ensuresitepageslibrary").postCore().then(function(e){return new Ee(c(e))})},r}(_),Ee=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"views",{get:function(){return new Ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"forms",{get:function(){return new Ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"defaultView",{get:function(){return new Te(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new T(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventReceivers",{get:function(){return new _(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedFields",{get:function(){return new T(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"informationRightsManagementSettings",{get:function(){return new T(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscriptions",{get:function(){return new Le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new ge(this,"rootFolder")},enumerable:!0,configurable:!0}),r.prototype.getView=function(e){return new Te(this,"getView('"+e+"')")},r.prototype.update=function(e,t){var o=this;void 0===t&&(t="*");var i=JSON.stringify(n.Util.extend({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}}).then(function(t){var n=o;return e.hasOwnProperty("Title")&&(n=o.getParent(r,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:t,list:n}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.getChanges=function(e){return this.clone(r,"getchanges").postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)})})},r.prototype.getItemsByCAMLQuery=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.clone(r,"getitems");return i.expand.apply(i,t).postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)})})},r.prototype.getListItemChangesSinceToken=function(e){return this.clone(r,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},r.prototype.renderListData=function(e){var t=this.clone(r,"renderlistdata(@viewXml)");return t.query.add("@viewXml","'"+e+"'"),t.postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("RenderListData")?e.RenderListData:e})},r.prototype.renderListDataAsStream=function(e,t){void 0===t&&(t=null);var o={overrideParameters:n.Util.extend({__metadata:{type:"SP.RenderListDataOverrideParameters"}},t),parameters:n.Util.extend({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(r,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(o)})},r.prototype.renderListFormData=function(e,t,n){return this.clone(r,"renderlistformdata(itemid="+e+", formid='"+t+"', mode='"+n+"')").postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("ListData")?e.ListData:e})},r.prototype.reserveListItemId=function(){return this.clone(r,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},r.prototype.getListItemEntityTypeFullName=function(){return this.clone(r,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},r}(oe),Fe=function(e){function r(t,n){return void 0===n&&(n="items"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.getById=function(e){var t=new je(this);return t.concat("("+e+")"),t},r.prototype.getItemByStringId=function(e){return new je(this.parentUrl,"getItemByStringId('"+e+"')")},r.prototype.skip=function(e){return this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},r.prototype.getPaged=function(){return this.get(new qe)},r.prototype.add=function(e,t){var o=this;void 0===e&&(e={}),void 0===t&&(t=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var a=JSON.stringify(n.Util.extend({__metadata:{type:t}},e)),s=o.clone(r,null).postCore({body:a}).then(function(e){return{data:e,item:o.getById(e.Id)}});return i(),s})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(Ee).getListItemEntityTypeFullName()},r}(_),je=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),Object.defineProperty(r.prototype,"attachmentFiles",{get:function(){return new we(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentType",{get:function(){return new be(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new T(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissionsForUI",{get:function(){return new T(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsHTML",{get:function(){return new O(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsText",{get:function(){return new O(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesForEdit",{get:function(){return new O(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folder",{get:function(){return new ge(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"file",{get:function(){return new We(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e,t,r){var o=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(i,a){var s=o.addBatchDependency();return o.ensureListItemEntityTypeName(r).then(function(r){var a=JSON.stringify(n.Util.extend({__metadata:{type:r}},e));return s(),o.postCore({body:a,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new Qe).then(function(e){i({data:e,item:o})})}).catch(function(e){return a(e)})})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var t=this.clone(r,"getWOPIFrameUrl(@action)");return t._query.add("@action",e),t.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},r.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),this.clone(r,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:t})})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(Ee,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},r}(se),Ae=function(e){function n(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new ke(this);return t.concat("("+e+")"),t},n}(_),ke=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},n}(O),Me=function(){function e(e,t){this.nextUrl=e,this.results=t}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Fe(this.nextUrl,null).getPaged():new Promise(function(e){return e(null)})},e}(),qe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&e.json().then(function(e){var r=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];n(new Me(r,t.parseODataJSON(e)))})})},n}(o.ODataParserBase),Qe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})},n}(o.ODataParserBase),He=function(e){function n(t,n){return void 0===n&&(n="files"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getByName=function(e){var t=new We(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,"add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},n.prototype.addChunked=function(e,t,r,o,i){var a=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return a.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)}).then(function(t){return{data:t,file:a.getByName(e)}})},n.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})},n}(_),We=function(r){function i(){return null!==r&&r.apply(this,arguments)||this}return t.__extends(i,r),Object.defineProperty(i.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"versions",{get:function(){return new Ve(this)},enumerable:!0,configurable:!0}),i.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(i,"approve(comment='"+e+"')").postCore()},i.prototype.cancelUpload=function(e){return this.clone(i,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},i.prototype.checkin=function(t,n){if(void 0===t&&(t=""),void 0===n&&(n=e.CheckinType.Major),t.length>1023)throw new u;return this.clone(i,"checkin(comment='"+t+"',checkintype="+n+")").postCore()},i.prototype.checkout=function(){return this.clone(i,"checkout").postCore()},i.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),this.clone(i,"copyTo(strnewurl='"+e+"',boverwrite="+t+")").postCore()},i.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(i,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},i.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(i,"deny(comment='"+e+"')").postCore()},i.prototype.getLimitedWebPartManager=function(t){return void 0===t&&(t=e.WebPartsPersonalizationScope.Shared),new ce(this,"getLimitedWebPartManager(scope="+t+")")},i.prototype.moveTo=function(t,n){return void 0===n&&(n=e.MoveOperations.Overwrite),this.clone(i,"moveTo(newurl='"+t+"',flags="+n+")").postCore()},i.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(i,"publish(comment='"+e+"')").postCore()},i.prototype.recycle=function(){return this.clone(i,"recycle").postCore()},i.prototype.undoCheckout=function(){return this.clone(i,"undoCheckout").postCore()},i.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(i,"unpublish(comment='"+e+"')").postCore()},i.prototype.getText=function(){return this.clone(i,"$value",!1).get(new o.TextParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getBlob=function(){return this.clone(i,"$value",!1).get(new o.BlobParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getBuffer=function(){return this.clone(i,"$value",!1).get(new o.BufferParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.getJSON=function(){return this.clone(i,"$value",!1).get(new o.JSONParser,{headers:{binaryStringResponseBody:"true"}})},i.prototype.setContent=function(e){var t=this;return this.clone(i,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new i(t)})},i.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.Util.extend(new je(f(e)),e)})},i.prototype.setContentChunked=function(e,t,r){void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var o=this,i=e.size,a=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),s=n.Util.getGUID();t({blockNumber:1,chunkSize:r,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:a});for(var u=o.startUpload(s,e.slice(0,r)),l=function(n){u=u.then(function(u){return t({blockNumber:n,chunkSize:r,currentPointer:u,fileSize:i,stage:"continue",totalBlocks:a}),o.continueUpload(s,u,e.slice(u,u+r))})},p=2;p<a;p++)l(p);return u.then(function(n){return t({blockNumber:a,chunkSize:r,currentPointer:n,fileSize:i,stage:"finishing",totalBlocks:a}),o.finishUpload(s,n,e.slice(n))}).then(function(e){return o})},i.prototype.startUpload=function(e,t){return this.clone(i,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:t}).then(function(e){return parseFloat(e)})},i.prototype.continueUpload=function(e,t,n){return this.clone(i,"continueUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return parseFloat(e)})},i.prototype.finishUpload=function(e,t,n){return this.clone(i,"finishUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return{data:e,file:new i(e.ServerRelativeUrl)}})},i}(le),Ve=function(e){function n(t,n){return void 0===n&&(n="versions"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Ge(this);return t.concat("("+e+")"),t},n.prototype.deleteAll=function(){return new n(this,"deleteAll").postCore()},n.prototype.deleteById=function(e){return this.clone(n,"deleteById(vid="+e+")").postCore()},n.prototype.recycleByID=function(e){return this.clone(n,"recycleByID(vid="+e+")").postCore()},n.prototype.deleteByLabel=function(e){return this.clone(n,"deleteByLabel(versionlabel='"+e+"')").postCore()},n.prototype.recycleByLabel=function(e){return this.clone(n,"recycleByLabel(versionlabel='"+e+"')").postCore()},n.prototype.restoreByLabel=function(e){return this.clone(n,"restoreByLabel(versionlabel='"+e+"')").postCore()},n}(_),Ge=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},n}(O);(ee=e.CheckinType||(e.CheckinType={}))[ee.Minor=0]="Minor",ee[ee.Major=1]="Major",ee[ee.Overwrite=2]="Overwrite",(te=e.WebPartsPersonalizationScope||(e.WebPartsPersonalizationScope={}))[te.User=0]="User",te[te.Shared=1]="Shared",(ne=e.MoveOperations||(e.MoveOperations={}))[ne.Overwrite=1]="Overwrite",ne[ne.AllowBrokenThickets=8]="AllowBrokenThickets",(re=e.TemplateFileType||(e.TemplateFileType={}))[re.StandardPage=0]="StandardPage",re[re.WikiPage=1]="WikiPage",re[re.FormPage=2]="FormPage";var Je,Xe,Ke,ze=function(e){function n(t,n){void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps");var r="";return"string"==typeof t?r=t:void 0!==t&&(r=t.toUrl()),e.call(this,i(r),n)||this}return t.__extends(n,e),n.prototype.getAppById=function(e){return new $e(this,"getById('"+e+"')")},n.prototype.add=function(e,t,r){return void 0===r&&(r=!0),new n(i(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(e){return{data:e,file:new We(c(e))}})},n}(_),$e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.deploy=function(){return this.clone(n,"Deploy").postCore()},n.prototype.retract=function(){return this.clone(n,"Retract").postCore()},n.prototype.install=function(){return this.clone(n,"Install").postCore()},n.prototype.uninstall=function(){return this.clone(n,"Uninstall").postCore()},n.prototype.upgrade=function(){return this.clone(n,"Upgrade").postCore()},n.prototype.remove=function(){return this.clone(n,"Remove").postCore()},n}(O),Ze=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new Ye(this);return t.concat("("+e+")"),t},n.prototype.add=function(e,t,r){var o=this;void 0===r&&(r=!0);var i=JSON.stringify({IsVisible:r,Title:e,Url:t,__metadata:{type:"SP.NavigationNode"}});return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},n.prototype.moveAfter=function(e,t){var r=JSON.stringify({nodeId:e,previousNodeId:t});return this.clone(n,"MoveAfter").postCore({body:r})},n}(_),Ye=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"children",{get:function(){return new Ze(this,"Children")},enumerable:!0,configurable:!0}),n.prototype.delete=function(){return e.prototype.deleteCore.call(this)},n}(O),et=function(e){function n(t,n){return void 0===n&&(n="navigation"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"quicklaunch",{get:function(){return new Ze(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topNavigationBar",{get:function(){return new Ze(this,"topnavigationbar")},enumerable:!0,configurable:!0}),n}(T),tt=function(e){function n(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return t.__extends(n,e),n.prototype.getMenuState=function(e,t,r,o){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===r&&(r=null),void 0===o&&(o=null),new n("MenuState").postCore({body:JSON.stringify({customProperties:o,depth:t,mapProviderName:r,menuNodeKey:e})})},n.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),new n("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:t})})},n}(T),nt=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,n){return void 0===t&&(t=""),void 0===n&&(n={}),new e(t,n)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=n.Util.extend(this._query,e),this},e}(),rt=function(e){function r(t,n){return void 0===n&&(n="_api/search/postquery"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.execute=function(e){var t,r=this;(t=e).SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var o=JSON.stringify({request:n.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:o}).then(function(t){return new ot(t,r.toUrl(),e)})},r.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},r}(O),ot=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,o=n.Util.extend(this._query,{RowLimit:r,StartRow:r*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new rt(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!1,value:t.Value,writable:!1}),e},{}))}return t},e}();(Je=e.SortDirection||(e.SortDirection={}))[Je.Ascending=0]="Ascending",Je[Je.Descending=1]="Descending",Je[Je.FQLFormula=2]="FQLFormula",(Xe=e.ReorderingRuleMatchType||(e.ReorderingRuleMatchType={}))[Xe.ResultContainsKeyword=0]="ResultContainsKeyword",Xe[Xe.TitleContainsKeyword=1]="TitleContainsKeyword",Xe[Xe.TitleMatchesKeyword=2]="TitleMatchesKeyword",Xe[Xe.UrlStartsWith=3]="UrlStartsWith",Xe[Xe.UrlExactlyMatches=4]="UrlExactlyMatches",Xe[Xe.ContentTypeIs=5]="ContentTypeIs",Xe[Xe.FileExtensionMatches=6]="FileExtensionMatches",Xe[Xe.ResultHasTag=7]="ResultHasTag",Xe[Xe.ManualCondition=8]="ManualCondition",(Ke=e.QueryPropertyValueType||(e.QueryPropertyValueType={}))[Ke.None=0]="None",Ke[Ke.StringType=1]="StringType",Ke[Ke.Int32TYpe=2]="Int32TYpe",Ke[Ke.BooleanType=3]="BooleanType",Ke[Ke.StringArrayType=4]="StringArrayType",Ke[Ke.UnSupportedType=5]="UnSupportedType";var it=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),at=function(e){function n(t,n){return void 0===n&&(n="_api/search/suggest"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new st(e)})},n.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},n}(O),st=function(){return function(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}}(),ut=function(e){function o(t){var n=e.call(this)||this;return n.baseUrl=t,n}return t.__extends(o,e),o.ParseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],s="--batchresponse_",u=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),l=e.split("\n"),p="batch",c=0;c<l.length;++c){var d=l[c];switch(p){case"batch":if(d.substr(0,s.length)===s)p="batchHeaders";else if(""!==d.trim())throw new a("Invalid response, line "+c);break;case"batchHeaders":""===d.trim()&&(p="status");break;case"status":var h=u.exec(d);if(3!==h.length)throw new a("Invalid status, line "+c);r=parseInt(h[1],10),o=h[2],p="statusHeaders";break;case"statusHeaders":""===d.trim()&&(p="body");break;case"body":i.push(204===r?new Response:new Response(d,{status:r,statusText:o})),p="batch"}}"status"!==p&&n(new a("Unexpected end of input")),t(i)})},o.prototype.executeImpl=function(){var e=this;if(r.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return r.Logger.write("Resolving empty batch.",1),Promise.resolve();var t=new P;return w(this.baseUrl).then(function(i){for(var s=[],u="",l=0;l<e.requests.length;l++){var p=e.requests[l];"GET"===p.method?(u.length>0&&(s.push("--changeset_"+u+"--\n\n"),u=""),s.push("--batch_"+e.batchId+"\n")):(u.length<1&&(u=n.Util.getGUID(),s.push("--batch_"+e.batchId+"\n"),s.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"\n\n')),s.push("--changeset_"+u+"\n")),s.push("Content-Type: application/http\n"),s.push("Content-Transfer-Encoding: binary\n\n");var c=new Headers,d=n.Util.isUrlAbsolute(p.url)?p.url:n.Util.combinePaths(i,p.url);if(r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+p.method+" "+d+" to batch.",0),"GET"!==p.method){var h=p.method,f=p.options.headers;p.hasOwnProperty("options")&&p.options.hasOwnProperty("headers")&&void 0!==f["X-HTTP-Method"]&&(h=f["X-HTTP-Method"],delete f["X-HTTP-Method"]),s.push(h+" "+d+" HTTP/1.1\n"),c.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else s.push(p.method+" "+d+" HTTP/1.1\n");n.mergeHeaders(c,g.headers),p.options&&n.mergeHeaders(c,p.options.headers),c.has("Accept")||c.append("Accept","application/json"),c.has("Content-Type")||c.append("Content-Type","application/json;odata=verbose;charset=utf-8"),c.has("X-ClientService-ClientTag")||c.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),c.forEach(function(e,t){s.push(t+": "+e+"\n")}),s.push("\n"),p.options.body&&s.push(p.options.body+"\n\n")}u.length>0&&(s.push("--changeset_"+u+"--\n\n"),u=""),s.push("--batch_"+e.batchId+"--\n");var y={body:s.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),t.fetch(n.Util.combinePaths(i,"/_api/$batch"),y).then(function(e){return e.text()}).then(o.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw new a("Could not properly parse responses to match requests in batch.");return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,o){var i=e.requests[o];return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",0),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},o}(o.ODataBatch),lt=function(e){function n(t,n){return void 0===n&&(n="features"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){var t=new pt(this);return t.concat("('"+e+"')"),t},n.prototype.add=function(e,t){var r=this;return void 0===t&&(t=!1),this.clone(n,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:r.getById(e)}})},n.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(n,"remove").postCore({body:JSON.stringify({featureId:e,force:t})})},n}(_),pt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(n,e),n.prototype.deactivate=function(e){var t=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new n(this).select("DefinitionId").get().then(function(n){var o=t.getParent(lt,t.parentUrl,"",t.batch).remove(n.DefinitionId,e);return r(),o})},n}(O),ct=function(e){function n(t,n){return void 0===n&&(n="_api/SP.RelatedItemManager"),e.call(this,t,n)||this}return t.__extends(n,e),n.FromUrl=function(e){if(null===e)return new n("");var t=e.indexOf("_api/");return new n(t>-1?e.substr(0,t):e)},n.prototype.getRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetRelatedItems"),r.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},n.prototype.getPageOneRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetPageOneRelatedItems"),r.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},n.prototype.addSingleLink=function(e,t,r,o,i,a,s){void 0===s&&(s=!1);var u=this.clone(n,null);return u.concat(".AddSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:a,TryAddReverseLink:s})})},n.prototype.addSingleLinkToUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:o})})},n.prototype.addSingleLinkFromUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:o})})},n.prototype.deleteSingleLink=function(e,t,r,o,i,a,s){void 0===s&&(s=!1);var u=this.clone(n,null);return u.concat(".DeleteSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:a,TryDeleteReverseLink:s})})},n}(T),dt=function(e){function n(t,n){return void 0===n&&(n="regionalsettings"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"installedLanguages",{get:function(){return new ht(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"globalInstalledLanguages",{get:function(){return new ht(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeZone",{get:function(){return new ft(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeZones",{get:function(){return new yt(this)},enumerable:!0,configurable:!0}),n}(O),ht=function(e){function n(t,n){return void 0===n&&(n="installedlanguages"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_),ft=function(e){function r(t,n){return void 0===n&&(n="timezone"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(r,"utctolocaltime('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},r.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:n.Util.dateAdd(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(r,"localtimetoutc('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},r}(O),yt=function(e){function n(t,n){return void 0===n&&(n="timezones"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.getById=function(e){return this.clone(n,"GetById("+e+")").postCore({},y(ft))},n}(_),gt=function(e){function r(t,n){return void 0===n&&(n="webs"),e.call(this,t,n)||this}return t.__extends(r,e),r.prototype.add=function(e,t,o,i,a,s){void 0===o&&(o=""),void 0===i&&(i="STS"),void 0===a&&(a=1033),void 0===s&&(s=!0);var u={Description:o,Language:a,Title:e,Url:t,UseSamePermissionsAsParentSite:s,WebTemplate:i},l=JSON.stringify({parameters:n.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},u)});return this.clone(r,"add").postCore({body:l}).then(function(e){return{data:e,web:new bt(c(e).replace(/_api\/web\/?/i,""))}})},r}(_),mt=function(e){function n(t,n){return void 0===n&&(n="webinfos"),e.call(this,t,n)||this}return t.__extends(n,e),n}(_),bt=function(e){function r(t,n){return void 0===n&&(n="_api/web"),e.call(this,t,n)||this}return t.__extends(r,e),r.fromUrl=function(e,t){return new r(i(e),t)},Object.defineProperty(r.prototype,"webs",{get:function(){return new gt(this)},enumerable:!0,configurable:!0}),r.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(gt,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(r.prototype,"allProperties",{get:function(){return this.clone(_,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webinfos",{get:function(){return new mt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lists",{get:function(){return new Ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"features",{get:function(){return new lt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availablefields",{get:function(){return new Oe(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"navigation",{get:function(){return new et(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUsers",{get:function(){return new x(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteGroups",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUserInfoList",{get:function(){return new Ee(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"regionalSettings",{get:function(){return new dt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentUser",{get:function(){return new U(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new ye(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"roleDefinitions",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedItems",{get:function(){return ct.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),r.prototype.createBatch=function(){return new ut(this.parentUrl)},Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new ge(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedOwnerGroup",{get:function(){return new X(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedMemberGroup",{get:function(){return new X(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedVisitorGroup",{get:function(){return new X(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),r.prototype.getFolderByServerRelativeUrl=function(e){return new ge(this,"getFolderByServerRelativeUrl('"+e+"')")},r.prototype.getFileByServerRelativeUrl=function(e){return new We(this,"getFileByServerRelativeUrl('"+e+"')")},r.prototype.getList=function(e){return new Ee(this,"getList('"+e+"')")},r.prototype.update=function(e){var t=this,r=JSON.stringify(n.Util.extend({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r.prototype.applyTheme=function(e,t,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(r,"applytheme").postCore({body:i})},r.prototype.applyWebTemplate=function(e){var t=this.clone(r,"applywebtemplate");return t.concat("(@t)"),t.query.add("@t",e),t.postCore()},r.prototype.ensureUser=function(e){var t=JSON.stringify({logonName:e});return this.clone(r,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new I(c(e))}})},r.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new _(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},r.prototype.getCatalog=function(e){return this.clone(r,"getcatalog("+e+")").select("Id").get().then(function(e){return new Ee(c(e))})},r.prototype.getChanges=function(e){var t=JSON.stringify({query:n.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(r,"getchanges").postCore({body:t})},Object.defineProperty(r.prototype,"customListTemplate",{get:function(){return new _(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),r.prototype.getUserById=function(e){return new I(this,"getUserById("+e+")")},r.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(r,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},r.prototype.getStorageEntity=function(e){return this.clone(r,"getStorageEntity('"+e+"')").get()},r.prototype.getAppCatalog=function(e){return new ze(e||this)},r}(ae),vt=function(e){function n(t,n){return void 0===n&&(n="_api/site"),e.call(this,t,n)||this}return t.__extends(n,e),Object.defineProperty(n.prototype,"rootWeb",{get:function(){return new bt(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"features",{get:function(){return new lt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),n.prototype.getContextInfo=function(){return new n(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},n.prototype.getDocumentLibraries=function(e){var t=new T("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},n.prototype.getWebUrlFromPageUrl=function(e){var t=new T("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},n.prototype.createBatch=function(){return new ut(this.parentUrl)},n.prototype.openWebById=function(e){return this.clone(n,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:bt.fromUrl(c(e))}})},n}(O),Pt=function(e){function r(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var r=e.call(this,t,n)||this;return r.profileLoader=new wt(t),r}return t.__extends(r,e),Object.defineProperty(r.prototype,"editProfileLink",{get:function(){return this.clone(r,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(r,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),r.prototype.amIFollowedBy=function(e){var t=this.clone(r,"amifollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.amIFollowing=function(e){var t=this.clone(r,"amifollowing(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(r,"getfollowedtags("+e+")").get()},r.prototype.getFollowersFor=function(e){var t=this.clone(r,"getfollowersfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"myFollowers",{get:function(){return new _(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"myProperties",{get:function(){return new r(this,"getmyproperties")},enumerable:!0,configurable:!0}),r.prototype.getPeopleFollowedBy=function(e){var t=this.clone(r,"getpeoplefollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getPropertiesFor=function(e){var t=this.clone(r,"getpropertiesfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"trendingTags",{get:function(){var e=this.clone(r,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),r.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(r,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},r.prototype.hideSuggestion=function(e){var t=this.clone(r,"hidesuggestion(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},r.prototype.isFollowing=function(e,t){var n=this.clone(r,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.query.add("@y","'"+encodeURIComponent(t)+"'"),n.get()},r.prototype.setMyProfilePic=function(e){var t=this;return new Promise(function(o,i){n.readBlobAsArrayBuffer(e).then(function(e){new r(t,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return o()})}).catch(function(e){return i(e)})})},r.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(r.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),r.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},r.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},r}(O),wt=function(e){function n(t,n){return void 0===n&&(n="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,n)||this}return t.__extends(n,e),n.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(n,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(n.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(n,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"userProfile",{get:function(){return this.clone(n,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),n.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(n,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},n.prototype.shareAllSocialData=function(e){return this.clone(n,"getuserprofile/shareallsocialdata("+e+")").postCore()},n}(T),St=function(e){function r(t,n){return e.call(this,r.getBaseUrl(t),"_api/SP.Utilities.Utility."+n)||this}return t.__extends(r,e),r.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},r.prototype.excute=function(e){return this.postCore({body:JSON.stringify(e)})},r.prototype.sendEmail=function(e){var t={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(t.properties=n.Util.extend(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=n.Util.extend(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=n.Util.extend(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=n.Util.extend(t.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(r,"SendEmail",!0).excute(t)},r.prototype.getCurrentUserEmailAddresses=function(){return this.clone(r,"GetCurrentUserEmailAddresses",!0).excute({})},r.prototype.resolvePrincipal=function(e,t,n,o,i,a){void 0===a&&(a=!1);var s={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:a,scopes:t,sources:n};return this.clone(r,"ResolvePrincipalInCurrentContext",!0).excute(s)},r.prototype.searchPrincipals=function(e,t,n,o,i){var a={groupName:o,input:e,maxCount:i,scopes:t,sources:n};return this.clone(r,"SearchPrincipalsUsingContextWeb",!0).excute(a)},r.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e};return this.clone(r,"CreateEmailBodyForInvitation",!0).excute(t)},r.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t};return this.clone(r,"ExpandGroupsToPrincipals",!0).excute(n)},r.prototype.createWikiPage=function(e){return this.clone(r,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new We(c(e))}})},r}(T),Ct=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.setup=function(e){var t;t=e,n.RuntimeConfig.extend(t)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,new at(this._baseUrl).configure(this._options).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof nt?e.toSearchQuery():e,new rt(this._baseUrl).configure(this._options).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return new vt(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return new bt(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return new Pt(this._baseUrl).configure(this._options)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new tt},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return new St(this._baseUrl,"").configure(this._options)},enumerable:!0,configurable:!0}),e}(),Tt=new Ct;e.spExtractODataId=c,e.spODataEntity=y,e.spODataEntityArray=function(e){return new h(e)},e.SharePointQueryable=T,e.SharePointQueryableInstance=O,e.SharePointQueryableCollection=_,e.SharePointQueryableSecurable=oe,e.FileFolderShared=ue,e.SharePointQueryableShareable=ie,e.SharePointQueryableShareableFile=le,e.SharePointQueryableShareableFolder=pe,e.SharePointQueryableShareableItem=se,e.SharePointQueryableShareableWeb=ae,e.AppCatalog=ze,e.App=$e,e.Field=xe,e.Fields=Oe,e.File=We,e.Files=He,e.Folder=ge,e.Folders=ye,e.SPHttpClient=P,e.Item=je,e.Items=Fe,e.ItemVersion=ke,e.ItemVersions=Ae,e.PagedItemCollection=Me,e.NavigationNodes=Ze,e.NavigationNode=Ye,e.NavigationService=tt,e.List=Ee,e.Lists=Ne,e.sp=Tt,e.SPRest=Ct,e.RoleDefinitionBindings=Y,e.Search=rt,e.SearchQueryBuilder=nt,e.SearchResults=ot,e.SearchBuiltInSourceId=it,e.SearchSuggest=at,e.SearchSuggestResult=st,e.Site=vt,e.UtilityMethod=St,e.WebPartDefinitions=de,e.WebPartDefinition=he,e.WebPart=fe,e.Web=bt,Object.defineProperty(e,"__esModule",{value:!0})});