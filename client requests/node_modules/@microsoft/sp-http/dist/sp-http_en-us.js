define("c07208f0-ea3b-4c1a-9965-ac1b825211a6_1.9.1", ["@microsoft/sp-core-library","@microsoft/sp-diagnostics"], function(__WEBPACK_EXTERNAL_MODULE__microsoft_sp_core_library__, __WEBPACK_EXTERNAL_MODULE__microsoft_sp_diagnostics__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./sp-http.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "../lib/resx-strings/en-us.js":
/*!************************************!*\
  !*** ../lib/resx-strings/en-us.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function() {
  var strings = {
    "_+tvmKa3YEOqWGKKXzwjtaw": {
      "additionalCredentialsWarning": "To view the information on this page, you need to verify your identity.",
      "servicePrincipalNotAvaliableError": "To view the information on this page, ask a global or SharePoint admin in your organization to go to the API management page in the new SharePoint admin center.",
      "graphClientInitializationError": "Sorry, we couldn't make a connection to Microsoft Graph."
    }
  };

  strings.default = strings;
  return strings;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),

/***/ "./sp-http.js":
/*!********************!*\
  !*** ./sp-http.js ***!
  \********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library"),__webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics"),__webpack_require__(/*! resx-strings */ "../lib/resx-strings/en-us.js")], __WEBPACK_AMD_DEFINE_RESULT__ = (function(__WEBPACK_EXTERNAL_MODULE__microsoft_sp_core_library__, __WEBPACK_EXTERNAL_MODULE__microsoft_sp_diagnostics__, __WEBPACK_EXTERNAL_MODULE_resx_strings__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 	};
/******/
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"sp-http": 0
/******/ 	};
/******/
/******/
/******/
/******/ 	// script path function
/******/ 	function jsonpScriptSrc(chunkId) {
/******/ 		return __webpack_require__.p + "" + chunkId + "." + ({}[chunkId]||chunkId) + "_" + {"0":"bf7f4a2f04ddc6956c28","1":"04d95a6a8729d443d034"}[chunkId] + ".js"
/******/ 	}
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// This file contains only the entry chunk.
/******/ 	// The chunk loading function for additional chunks
/******/ 	__webpack_require__.e = function requireEnsure(chunkId) {
/******/ 		var promises = [];
/******/
/******/
/******/ 		// JSONP chunk loading for javascript
/******/
/******/ 		var installedChunkData = installedChunks[chunkId];
/******/ 		if(installedChunkData !== 0) { // 0 means "already installed".
/******/
/******/ 			// a Promise means "currently loading".
/******/ 			if(installedChunkData) {
/******/ 				promises.push(installedChunkData[2]);
/******/ 			} else {
/******/ 				// setup Promise in chunk cache
/******/ 				var promise = new Promise(function(resolve, reject) {
/******/ 					installedChunkData = installedChunks[chunkId] = [resolve, reject];
/******/ 				});
/******/ 				promises.push(installedChunkData[2] = promise);
/******/
/******/ 				// start chunk loading
/******/ 				var script = document.createElement('script');
/******/ 				var onScriptComplete;
/******/
/******/ 				script.charset = 'utf-8';
/******/ 				script.timeout = 120;
/******/ 				if (__webpack_require__.nc) {
/******/ 					script.setAttribute("nonce", __webpack_require__.nc);
/******/ 				}
/******/ 				script.src = jsonpScriptSrc(chunkId);
/******/
/******/ 				onScriptComplete = function (event) {
/******/ 					// avoid mem leaks in IE.
/******/ 					script.onerror = script.onload = null;
/******/ 					clearTimeout(timeout);
/******/ 					var chunk = installedChunks[chunkId];
/******/ 					if(chunk !== 0) {
/******/ 						if(chunk) {
/******/ 							var errorType = event && (event.type === 'load' ? 'missing' : event.type);
/******/ 							var realSrc = event && event.target && event.target.src;
/******/ 							var error = new Error('Loading chunk ' + chunkId + ' failed.\n(' + errorType + ': ' + realSrc + ')');
/******/ 							error.type = errorType;
/******/ 							error.request = realSrc;
/******/ 							chunk[1](error);
/******/ 						}
/******/ 						installedChunks[chunkId] = undefined;
/******/ 					}
/******/ 				};
/******/ 				var timeout = setTimeout(function(){
/******/ 					onScriptComplete({ type: 'timeout', target: script });
/******/ 				}, 120000);
/******/ 				script.onerror = script.onload = onScriptComplete;
/******/ 				document.head.appendChild(script);
/******/ 			}
/******/ 		}
/******/ 		return Promise.all(promises);
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// on error function for async loading
/******/ 	__webpack_require__.oe = function(err) { console.error(err); throw err; };
/******/
/******/ 	var jsonpArray = window["webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_9_1"] = window["webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_9_1"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// Set the webpack public path
/******/ 	(function () {
/******/ 	  var scripts = document.getElementsByTagName('script');
/******/ 	  var regex = (typeof spScriptNamePattern !== 'undefined') ? spScriptNamePattern : new RegExp('\\/sp-http(_[a-z0-9-]+)*\\.js', 'i');
/******/ 	  var publicPath;
/******/ 	
/******/ 	  if (scripts && scripts.length) {
/******/ 	    for (var i = 0; i < scripts.length; i++) {
/******/ 	      if (!scripts[i]) continue;
/******/ 	      var path = scripts[i].getAttribute('src');
/******/ 	      if (path && path.match(regex)) {
/******/ 	        publicPath = path.substring(0, path.lastIndexOf('/') + 1);
/******/ 	        break;
/******/ 	      }
/******/ 	    }
/******/ 	  }
/******/ 	
/******/ 	  if (!publicPath) {
/******/ 	    for (var global in window.__setWebpackPublicPathLoaderSrcRegistry__) {
/******/ 	      if (global && global.match(regex)) {
/******/ 	        publicPath = global.substring(0, global.lastIndexOf('/') + 1);
/******/ 	        break;
/******/ 	      }
/******/ 	    }
/******/ 	  }
/******/ 	  __webpack_require__.p = publicPath;
/******/ 	})();
/******/ 	
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./lib/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js":
/*!**********************************************************************************************************************************!*\
  !*** C:/agent/1/_work/20/s/common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: __extends, __assign, __rest, __decorate, __param, __metadata, __awaiter, __generator, __exportStar, __values, __read, __spread, __await, __asyncGenerator, __asyncDelegator, __asyncValues, __makeTemplateObject, __importStar, __importDefault */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "../../libraries/sp-client-shared/lib/index.js":
/*!*********************************************************************!*\
  !*** C:/agent/1/_work/20/s/libraries/sp-client-shared/lib/index.js ***!
  \*********************************************************************/
/*! exports provided: OAuthUtility, OAuthUtilityError, OAuthUtilityErrorType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _tokenUtility_OAuthUtility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tokenUtility/OAuthUtility */ "../../libraries/sp-client-shared/lib/tokenUtility/OAuthUtility.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OAuthUtility", function() { return _tokenUtility_OAuthUtility__WEBPACK_IMPORTED_MODULE_0__["default"]; });

/* harmony import */ var _tokenUtility_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tokenUtility/OAuthUtilityError */ "../../libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OAuthUtilityError", function() { return _tokenUtility_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["default"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OAuthUtilityErrorType", function() { return _tokenUtility_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["OAuthUtilityErrorType"]; });





/***/ }),

/***/ "../../libraries/sp-client-shared/lib/tokenUtility/Constants.js":
/*!**************************************************************************************!*\
  !*** C:/agent/1/_work/20/s/libraries/sp-client-shared/lib/tokenUtility/Constants.js ***!
  \**************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var Constants =  (function () {
    function Constants() {
    }
    Constants.tokenCacheSessionStorageId = 'tokenCache';
    Constants.aboutToExpireIntervalSeconds = 600;
    Constants.apiUrl = '/_api/SP.OAuth.Token/Acquire';
    Constants.retries = 3;
    Constants.retriableErrorCodes = [
        10006,
        10008
    ];
    Constants.unexpectedErrorCodeFormat = 'Expected error code format is <numericCode>, <exception class name>';
    Constants.unexpectedTokenMessageFormat = 'Your token request succeedeed but the token could not be parsed from the response.' +
        'This is most probably caused by a change in the server response format';
    Constants.npmPackageVersion = '0.1.5';
    return Constants;
}());
/* harmony default export */ __webpack_exports__["default"] = (Constants);


/***/ }),

/***/ "../../libraries/sp-client-shared/lib/tokenUtility/OAuthUtility.js":
/*!*****************************************************************************************!*\
  !*** C:/agent/1/_work/20/s/libraries/sp-client-shared/lib/tokenUtility/OAuthUtility.js ***!
  \*****************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "../../libraries/sp-client-shared/lib/tokenUtility/Constants.js");
/* harmony import */ var _OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OAuthUtilityError */ "../../libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js");


var OAuthUtility =  (function () {
    function OAuthUtility(context) {
        var _this = this;
        this._context = context;
        this._dispose = this._dispose.bind(this);
        window.addEventListener('unload', this._dispose);
        var mediaTokenCallback = '_spPageOnMediaTokenReceived';
        window[mediaTokenCallback] = function () {
            _this._receiveMediaServiceFlushedToken();
        };
        var mediaTokenCallbackV2 = '_spMSBTLoaded';
        window[mediaTokenCallbackV2] = function () {
            _this._receiveMediaServiceFlushedToken();
        };
    }
    OAuthUtility._getCorrelationId = function (response) {
        return response.headers.get('sprequestguid');
    };
    OAuthUtility._extractRealError = function (errorResponse) {
        var isNested = errorResponse.hasOwnProperty('error');
        return isNested ? errorResponse.error : errorResponse;
    };
    OAuthUtility.prototype.getOAuthToken = function (resource, webUrl) {
        var _this = this;
        this._receiveMediaServiceFlushedToken();
        var cachedData = this._getCachedTokenData(resource);
        if (cachedData && !this._isExpiring(cachedData)) {
            return Promise.resolve({
                token: cachedData.accessToken,
                isGuest: false,
                expirationTimeMs: cachedData.expiresOn,
                _correlationId: cachedData.correlationId
            });
        }
        return this._retriableFetchWithDigest(resource, _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].retries, webUrl)
            .then(function (responseData) {
            _this._storeTokenData(resource, responseData);
            return {
                token: responseData.accessToken,
                isGuest: false,
                expirationTimeMs: responseData.expiresOn,
                _correlationId: responseData.correlationId
            };
        });
    };
    OAuthUtility.prototype.clearCachedToken = function (resource) {
        var key = this._getCacheKey(resource);
        window.sessionStorage.removeItem(key);
        var index = this._resourceKeys.indexOf(key);
        if (!isNaN(index) && index > -1) {
            this._resourceKeys.splice(index);
        }
    };
    Object.defineProperty(OAuthUtility.prototype, "_resourceKeys", {
        get: function () {
            if (!this._keysToDispose) {
                this._keysToDispose = new Array();
            }
            return this._keysToDispose;
        },
        enumerable: true,
        configurable: true
    });
    OAuthUtility.prototype._retriableFetchWithDigest = function (resource, retriesLeft, webUrl) {
        var _this = this;
        var monitor = this._context.qosMonitor();
        var correlationIdExtraData;
        return this._context.fetchWithDigest(this._buildTokenRequest(resource, webUrl))
            .then(function (response) {
            correlationIdExtraData = { CorrelationId: OAuthUtility._getCorrelationId(response) };
            if (response.status !== 200) {
                _this._context.logger.logError('fetchWithDigest failed. Server responded with ' + response.statusText);
                var error = new _OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["default"](_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["OAuthUtilityErrorType"].unknownError, {
                    httpResponseStatus: response.status,
                    message: response.statusText,
                    correlationId: OAuthUtility._getCorrelationId(response)
                });
                if (response.status !== 400) {
                    monitor.writeUnexpectedFailure('UnknownError', error, correlationIdExtraData);
                    return Promise.reject(error);
                }
                return response.json().then(function (mixedErrorResponse) {
                    var errorResponse = OAuthUtility._extractRealError(mixedErrorResponse);
                    var errorCode = _this._getErrorCodeFromResponseCode(errorResponse);
                    if (!_this._isRetriableError(errorCode) || (retriesLeft === 0)) {
                        var oAuthError = _this._buildErrorFromResponse(errorResponse);
                        monitor.writeUnexpectedFailure('SharepointServerError', oAuthError, correlationIdExtraData);
                        return Promise.reject(oAuthError);
                    }
                    _this._context.logger.logError('fetchWithDigest failed. Retrying. Retries left: ' + retriesLeft);
                    return _this._retriableFetchWithDigest(resource, retriesLeft - 1, webUrl);
                });
            }
            return _this._instrumentedParseResponseData(response, monitor, correlationIdExtraData);
        });
    };
    OAuthUtility.prototype._getCachedTokenData = function (resource) {
        return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(resource)));
    };
    OAuthUtility.prototype._storeTokenData = function (resource, data) {
        window.sessionStorage.setItem(this._getCacheKey(resource), JSON.stringify(data));
    };
    OAuthUtility.prototype._getCacheKey = function (resource) {
        var key = ['sp-client-shared', _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].npmPackageVersion, 'OAuthUtility', resource].join(';');
        var index = this._resourceKeys.indexOf(key);
        if (index === -1) {
            this._resourceKeys.push(key);
        }
        return key;
    };
    OAuthUtility.prototype._isExpiring = function (tokenRequestData) {
        return (tokenRequestData.expiresOn - Date.now() / 1000) < _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].aboutToExpireIntervalSeconds;
    };
    OAuthUtility.prototype._isRetriableError = function (errorCode) {
        return _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].retriableErrorCodes.indexOf(errorCode) !== -1;
    };
    OAuthUtility.prototype._buildTokenRequest = function (resource, webUrl) {
        var requestHeaders = new Headers();
        requestHeaders.append('Content-Type', 'application/json; charset=utf-8');
        requestHeaders.append('Odata-Version', '4.0');
        requestHeaders.append('Accept', 'application/json;odata.metadata=minimal');
        var request = {
            method: 'POST',
            headers: requestHeaders,
            body: JSON.stringify(this._buildRequestBody(resource))
        };
        var webUrlNoEndingSlash = webUrl;
        if (webUrlNoEndingSlash && webUrlNoEndingSlash.lastIndexOf('/') === webUrlNoEndingSlash.length - 1) {
            webUrlNoEndingSlash = webUrlNoEndingSlash.substr(0, webUrlNoEndingSlash.length - 1);
        }
        return new Request(webUrlNoEndingSlash + _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].apiUrl, request);
    };
    OAuthUtility.prototype._buildRequestBody = function (resource) {
        return {
            resource: resource
        };
    };
    OAuthUtility.prototype._buildErrorFromResponse = function (serverErrorResponse) {
        var errorCode = this._getErrorCodeFromResponseCode(serverErrorResponse);
        if (errorCode === undefined) {
            return new _OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["default"](_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["OAuthUtilityErrorType"].malformedResponseBody, {
                httpResponseStatus: 400,
                message: _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].unexpectedErrorCodeFormat,
                correlationId: serverErrorResponse.correlationId
            });
        }
        var message;
        var cultureName;
        if (serverErrorResponse.message) {
            if (typeof serverErrorResponse.message === 'string') {
                message = serverErrorResponse.message;
            }
            else {
                message = serverErrorResponse.message.value;
                cultureName = serverErrorResponse.message.lang;
            }
        }
        var redirectUrlKey = 'error.redirectUrl';
        return new _OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["default"](_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["OAuthUtilityErrorType"].serverError, {
            httpResponseStatus: 400,
            message: message,
            cultureName: cultureName,
            serverErrorCode: errorCode,
            correlationId: serverErrorResponse.correlationId,
            redirectUrl: serverErrorResponse[redirectUrlKey] || serverErrorResponse["@" + redirectUrlKey]
        });
    };
    OAuthUtility.prototype._getErrorCodeFromResponseCode = function (serverErrorResponse) {
        var responseErrorCode = serverErrorResponse.code;
        var errorCode = Number(responseErrorCode);
        if (isNaN(errorCode) && typeof serverErrorResponse.message === 'string') {
            var firstCommaIndex = responseErrorCode.indexOf(',');
            if (firstCommaIndex !== -1) {
                errorCode = Number(responseErrorCode.substr(0, firstCommaIndex));
            }
        }
        return errorCode;
    };
    OAuthUtility.prototype._instrumentedParseResponseData = function (response, monitor, correlationIdExtraData) {
        try {
            return response.json().then(function (responseBody) {
                monitor.writeSuccess(correlationIdExtraData);
                return {
                    accessToken: responseBody.access_token,
                    correlationId: OAuthUtility._getCorrelationId(response),
                    expiresOn: Number(responseBody.expires_on),
                    notBefore: Number(responseBody.not_before),
                    resource: responseBody.resource,
                    tokenType: responseBody.token_type
                };
            });
        }
        catch (error) {
            monitor.writeUnexpectedFailure('ResponseParseError', error, correlationIdExtraData);
            return Promise.reject(new _OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["default"](_OAuthUtilityError__WEBPACK_IMPORTED_MODULE_1__["OAuthUtilityErrorType"].malformedResponseBody, {
                httpResponseStatus: 200,
                message: _Constants__WEBPACK_IMPORTED_MODULE_0__["default"].unexpectedTokenMessageFormat,
                correlationId: OAuthUtility._getCorrelationId(response)
            }));
        }
    };
    OAuthUtility.prototype._dispose = function (ev) {
        window.removeEventListener('unload', this._dispose);
        for (var _i = 0, _a = this._resourceKeys; _i < _a.length; _i++) {
            var key = _a[_i];
            window.sessionStorage.removeItem(key);
        }
    };
    OAuthUtility.prototype._receiveMediaServiceFlushedToken = function () {
        var tokenKey = '_spMSBT';
        if (window[tokenKey]) {
            var responseData = {
                tokenType: window[tokenKey].TokenType,
                expiresOn: window[tokenKey].ExpiresOn,
                notBefore: undefined,
                resource: window[tokenKey].Resource,
                accessToken: window[tokenKey].AccessToken
            };
            this._storeTokenData(responseData.resource, responseData);
            window[tokenKey] = undefined;
        }
    };
    return OAuthUtility;
}());
/* harmony default export */ __webpack_exports__["default"] = (OAuthUtility);


/***/ }),

/***/ "../../libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js":
/*!**********************************************************************************************!*\
  !*** C:/agent/1/_work/20/s/libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js ***!
  \**********************************************************************************************/
/*! exports provided: OAuthUtilityErrorType, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OAuthUtilityErrorType", function() { return OAuthUtilityErrorType; });
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var OAuthUtilityErrorType;
(function (OAuthUtilityErrorType) {
    OAuthUtilityErrorType[OAuthUtilityErrorType["unknownError"] = 0] = "unknownError";
    OAuthUtilityErrorType[OAuthUtilityErrorType["malformedResponseBody"] = 1] = "malformedResponseBody";
    OAuthUtilityErrorType[OAuthUtilityErrorType["serverError"] = 2] = "serverError";
})(OAuthUtilityErrorType || (OAuthUtilityErrorType = {}));
var OAuthUtilityError =  (function (_super) {
    __extends(OAuthUtilityError, _super);
    function OAuthUtilityError(type, context) {
        var _this = _super.call(this, context.message) || this;
        _this.__proto__ = OAuthUtilityError.prototype; 
        _this._type = type;
        _this._httpResponseStatus = context.httpResponseStatus;
        _this._cultureName = context.cultureName;
        _this._message = context.message;
        _this._serverErrorCode = context.serverErrorCode;
        _this._correlationId = context.correlationId;
        _this._redirectUrl = context.redirectUrl;
        return _this;
    }
    Object.defineProperty(OAuthUtilityError.prototype, "type", {
        get: function () {
            return this._type;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "serverErrorCode", {
        get: function () {
            if (this.type !== OAuthUtilityErrorType.serverError) {
                throw new Error('ServerErrorCode can only be obtained for errors of type serverError');
            }
            return this._serverErrorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "httpResponseStatus", {
        get: function () {
            return this._httpResponseStatus;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "message", {
        get: function () {
            return this._message;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "cultureName", {
        get: function () {
            return this._cultureName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "correlationId", {
        get: function () {
            return this._correlationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityError.prototype, "redirectUrl", {
        get: function () {
            return this._redirectUrl;
        },
        enumerable: true,
        configurable: true
    });
    return OAuthUtilityError;
}(Error));
/* harmony default export */ __webpack_exports__["default"] = (OAuthUtilityError);


/***/ }),

/***/ "./lib/SPHttpStrings.resx.js":
/*!***********************************!*\
  !*** ./lib/SPHttpStrings.resx.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var key = '_+tvmKa3YEOqWGKKXzwjtaw';
var allStrings = ( false) ?
    undefined :
    __webpack_require__(/*! resx-strings */ "resx-strings");
var strings = allStrings[key];
/* harmony default export */ __webpack_exports__["default"] = (strings);


/***/ }),

/***/ "./lib/aadHttpClient/AadHttpClient.js":
/*!********************************************!*\
  !*** ./lib/aadHttpClient/AadHttpClient.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../httpClient/FetchProvider */ "./lib/httpClient/FetchProvider.js");
/* harmony import */ var _httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClientResponse */ "./lib/httpClient/HttpClientResponse.js");
/* harmony import */ var _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../oauthTokenProvider/AadTokenProviders */ "./lib/oauthTokenProvider/AadTokenProviders.js");
/* harmony import */ var _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../httpClient/HttpClientHelper */ "./lib/httpClient/HttpClientHelper.js");
/* harmony import */ var _AadHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AadHttpClientConfiguration */ "./lib/aadHttpClient/AadHttpClientConfiguration.js");






var AadHttpClient =  (function () {
    function AadHttpClient(serviceScope, resourceEndpoint, options) {
        var _this = this;
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Validate"].isNotNullOrUndefined(serviceScope, 'serviceScope');
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Validate"].isNotNullOrUndefined(resourceEndpoint, 'resourceUrl');
        this._resourceUrl = resourceEndpoint;
        this._serviceScope = serviceScope;
        this._aadTokenProvider =
            options && options.tokenProvider ||
                _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_3__["default"].configurable;
        this._aadTokenConfiguration = options && options.configuration;
        this._useCachedToken = options && options.useCachedToken !== undefined ? options.useCachedToken : true;
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(_httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_1__["fetchProviderServiceKey"]);
        });
    }
    AadHttpClient.prototype.fetch = function (url, configuration, options) {
        var _this = this;
        return this._fetch(url, configuration, options, this._useCachedToken)
            .then(function (originalResponse) {
            if (!_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["_SPKillSwitch"].isActivated(AadHttpClient.authRetryKillSwitchGuid, '05/13/19', 'Get a fresh token for authorization failures') &&
                originalResponse.status === 403) {
                return _this._fetch(url, configuration, options, false);
            }
            else {
                return originalResponse;
            }
        })
            .then(function (value) { return new _httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__["default"](value); });
    };
    AadHttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__["default"].overrideHttpMethod(options, 'GET'));
    };
    AadHttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__["default"].overrideHttpMethod(options, 'POST'));
    };
    AadHttpClient.prototype._fetch = function (url, configuration, options, useCachedToken) {
        var _this = this;
        var tokenFetchPromise;
        if (this._aadTokenConfiguration && this._aadTokenProvider._getTokenInternal) {
            tokenFetchPromise = this._aadTokenProvider._getTokenInternal(this._resourceUrl, this._aadTokenConfiguration, useCachedToken);
        }
        else {
            tokenFetchPromise = this._aadTokenProvider.getToken(this._resourceUrl, useCachedToken);
        }
        return tokenFetchPromise
            .then(function (token) {
            options.headers = options.headers ? new Headers(options.headers) : new Headers();
            options.headers.append('Authorization', 'Bearer ' + token);
            return _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__["default"].fetchCore(configuration, new Request(url, options), _this._serviceScope, _this._fetchProvider, AadHttpClient._className);
        });
    };
    AadHttpClient.configurations = _AadHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_5__["predefinedConfigurations"];
    AadHttpClient.authRetryKillSwitchGuid = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].parse('0cf10fc5-9dba-4929-9644-68aa50693e25');
    AadHttpClient._className = 'AadHttpClient';
    return AadHttpClient;
}());
/* harmony default export */ __webpack_exports__["default"] = (AadHttpClient);


/***/ }),

/***/ "./lib/aadHttpClient/AadHttpClientConfiguration.js":
/*!*********************************************************!*\
  !*** ./lib/aadHttpClient/AadHttpClientConfiguration.js ***!
  \*********************************************************/
/*! exports provided: default, predefinedConfigurations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "predefinedConfigurations", function() { return predefinedConfigurations; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../httpClient/HttpClient */ "./lib/httpClient/HttpClient.js");
/* harmony import */ var _httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClientConfiguration */ "./lib/httpClient/HttpClientConfiguration.js");



var AadHttpClientConfiguration =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AadHttpClientConfiguration, _super);
    function AadHttpClientConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    AadHttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new AadHttpClientConfiguration(this.flags, sourceFlags);
    };
    return AadHttpClientConfiguration;
}(_httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (AadHttpClientConfiguration);
var predefinedConfigurations = {
    v1: new AadHttpClientConfiguration(_httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_1__["default"].configurations.v1)
};


/***/ }),

/***/ "./lib/aadHttpClient/AadHttpClientFactory.js":
/*!***************************************************!*\
  !*** ./lib/aadHttpClient/AadHttpClientFactory.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../oauthTokenProvider/AadTokenProviders */ "./lib/oauthTokenProvider/AadTokenProviders.js");
/* harmony import */ var _AadHttpClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AadHttpClient */ "./lib/aadHttpClient/AadHttpClient.js");



var AadHttpClientFactory =  (function () {
    function AadHttpClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    AadHttpClientFactory.prototype.getClient = function (resourceEndpoint) {
        return Promise.resolve(new _AadHttpClient__WEBPACK_IMPORTED_MODULE_2__["default"](this._serviceScope, resourceEndpoint));
    };
    AadHttpClientFactory.prototype._getStandardClient = function (resourceEndpoint) {
        return Promise.resolve(new _AadHttpClient__WEBPACK_IMPORTED_MODULE_2__["default"](this._serviceScope, resourceEndpoint, { configuration: _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_1__["default"].preAuthorizedConfiguration }));
    };
    AadHttpClientFactory.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["ServiceKey"].create('sp-http:AadHttpClientFactory', AadHttpClientFactory);
    return AadHttpClientFactory;
}());
/* harmony default export */ __webpack_exports__["default"] = (AadHttpClientFactory);


/***/ }),

/***/ "./lib/common/KillSwitches.js":
/*!************************************!*\
  !*** ./lib/common/KillSwitches.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);

var KillSwitches =  (function () {
    function KillSwitches() {
    }
    KillSwitches.isNullBodyStatusKillSwitchActivated = function () {
        return _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["_SPKillSwitch"].isActivated(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].parse('5ac0c3c1-7495-49d9-b765-c9bdf28485e1'), '03/07/2019', 'Use null body to construct Response to resolve exception for null body status');
    };
    KillSwitches.isFixEdgeNullBodyStatusKillSwitchActivated = function () {
        return _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["_SPKillSwitch"].isActivated(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].parse('a54c9582-c0ca-4d1e-9897-1b1c3425a1d2'), '05/13/2019', 'Fix Edge browser null body status exception using null instead of undefined');
    };
    KillSwitches.isExposeCorrelationIdAndResponseBodyKillSwitchActivated = function () {
        return _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["_SPKillSwitch"].isActivated(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].parse('7a6d687d-6ce2-47af-9dec-1cda5bc7163f'), '06/19/2019', 'Expose batch request id to each batch response and expose batch response body');
    };
    return KillSwitches;
}());
/* harmony default export */ __webpack_exports__["default"] = (KillSwitches);


/***/ }),

/***/ "./lib/graphHttpClient/GraphHttpClient.js":
/*!************************************************!*\
  !*** ./lib/graphHttpClient/GraphHttpClient.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _oauthTokenProvider_OAuthTokenProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../oauthTokenProvider/OAuthTokenProvider */ "./lib/oauthTokenProvider/OAuthTokenProvider.js");
/* harmony import */ var _httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../httpClient/FetchProvider */ "./lib/httpClient/FetchProvider.js");
/* harmony import */ var _GraphHttpClientResponse__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GraphHttpClientResponse */ "./lib/graphHttpClient/GraphHttpClientResponse.js");
/* harmony import */ var _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../httpClient/HttpClientHelper */ "./lib/httpClient/HttpClientHelper.js");
/* harmony import */ var _spHttpClient_SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../spHttpClient/SPHttpClientHelper */ "./lib/spHttpClient/SPHttpClientHelper.js");
/* harmony import */ var _GraphHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./GraphHttpClientConfiguration */ "./lib/graphHttpClient/GraphHttpClientConfiguration.js");
/* harmony import */ var _GraphHttpClientContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./GraphHttpClientContext */ "./lib/graphHttpClient/GraphHttpClientContext.js");









var GraphHttpClient =  (function () {
    function GraphHttpClient(serviceScope) {
        var _this = this;
        this._serviceScope = serviceScope;
        this._serviceScope.whenFinished(function () {
            _this._tokenProvider = serviceScope.consume(_oauthTokenProvider_OAuthTokenProvider__WEBPACK_IMPORTED_MODULE_2__["default"].serviceKey);
            _this._parentSource = serviceScope.consume(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_logSourceServiceKey"]);
            _this._graphContext = serviceScope.consume(_GraphHttpClientContext__WEBPACK_IMPORTED_MODULE_8__["default"].serviceKey);
            _this._fetchProvider = serviceScope.consume(_httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_3__["fetchProviderServiceKey"]);
        });
    }
    GraphHttpClient.prototype.fetch = function (url, configuration, options) {
        var _this = this;
        this._validateGraphRelativeUrl(url);
        return this._getOAuthToken().then(function () {
            if (!options) {
                options = {};
            }
            var modifiedOptions = Object.assign({}, options);
            var defaultHeaders = new Headers();
            defaultHeaders.append('Accept', 'application/json');
            defaultHeaders.append('Authorization', 'Bearer ' + _this._token);
            defaultHeaders.append('Content-Type', 'application/json; charset=utf-8');
            var userHeaders = _spHttpClient_SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_6__["default"].cloneHeaders(options);
            modifiedOptions.headers = _this._mergeUserHeaders(defaultHeaders, userHeaders);
            return _this._fetchWithInstrumentation(configuration, new Request(_this._graphContext.getGraphEndpointUrl() + '/' + url, modifiedOptions)).then(function (response) {
                return new _GraphHttpClientResponse__WEBPACK_IMPORTED_MODULE_4__["default"](response);
            });
        });
    };
    GraphHttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_5__["default"].overrideHttpMethod(options, 'GET'));
    };
    GraphHttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_5__["default"].overrideHttpMethod(options, 'POST'));
    };
    GraphHttpClient.prototype._fetchWithInstrumentation = function (configuration, request) {
        var _this = this;
        var qosMonitor = new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_QosMonitor"]('GraphHttpClient.Fetch');
        return _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_5__["default"].fetchCore(configuration, request, this._serviceScope, this._fetchProvider, GraphHttpClient._className).then(function (response) {
            _this._writeQosMonitorUpdate(response, qosMonitor, 'Fetch');
            return response;
        }).catch(function (error) {
            qosMonitor.writeUnexpectedFailure('Fetch', error, { source: _this._logSourceId });
            return Promise.reject(error);
        });
    };
    GraphHttpClient.prototype._getOAuthToken = function () {
        var _this = this;
        var qosMonitor = new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_QosMonitor"]('GraphHttpClient.FetchGraphToken');
        return this._tokenProvider.getOAuthToken(this._graphContext.getGraphEndpointUrl(), this._graphContext.getWebServerRelativeUrl()).then(function (response) {
            _this._writeQosMonitorUpdate(response, qosMonitor, 'FetchGraphToken');
            _this._token = response.token;
        })
            .catch(function (error) {
            qosMonitor.writeUnexpectedFailure('FetchGraphToken', error, { source: _this._logSourceId });
            return Promise.reject(error);
        });
    };
    Object.defineProperty(GraphHttpClient.prototype, "_logSourceId", {
        get: function () {
            if (this._parentSource.isEmpty()) {
                return GraphHttpClient._logSource.id;
            }
            return this._parentSource.id;
        },
        enumerable: true,
        configurable: true
    });
    GraphHttpClient.prototype._mergeUserHeaders = function (defaultHeaders, userHeaders) {
        userHeaders.forEach(function (value, name) {
            defaultHeaders.set(name, value); 
        });
        return defaultHeaders;
    };
    GraphHttpClient.prototype._writeQosMonitorUpdate = function (response, qosMonitor, operation) {
        if (response.status >= 200 && response.status <= 299) {
            qosMonitor.writeSuccess({ source: this._logSourceId });
        }
        else if (response.status >= 300 && response.status <= 499) {
            qosMonitor.writeExpectedFailure(operation, undefined, { source: this._logSourceId, responseStatus: response.status });
        }
        else {
            qosMonitor.writeUnexpectedFailure(operation, undefined, { source: this._logSourceId, responseStatus: response.status });
        }
    };
    GraphHttpClient.prototype._validateGraphRelativeUrl = function (url) {
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Validate"].isNotNullOrUndefined(url, 'url');
        if (url.charAt(0) === '/') {
            throw new Error('GraphHttpClient requests cannot begin with a / character');
        }
        if (url.indexOf('http://', 0) === 0) {
            throw new Error('GraphHttpClient requests cannot specify a different graph server with the url.');
        }
        if (url.indexOf('https://', 0) === 0) {
            throw new Error('GraphHttpClient requests cannot specify a different graph server with the url.');
        }
    };
    GraphHttpClient.configurations = _GraphHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_7__["predefinedConfigurations"];
    GraphHttpClient.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["ServiceKey"].create('sp-http:GraphHttpClient', GraphHttpClient);
    GraphHttpClient._className = 'GraphHttpClient';
    GraphHttpClient._logSource = _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_LogSource"].create('graphHttpClient');
    return GraphHttpClient;
}());
/* harmony default export */ __webpack_exports__["default"] = (GraphHttpClient);


/***/ }),

/***/ "./lib/graphHttpClient/GraphHttpClientConfiguration.js":
/*!*************************************************************!*\
  !*** ./lib/graphHttpClient/GraphHttpClientConfiguration.js ***!
  \*************************************************************/
/*! exports provided: default, predefinedConfigurations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "predefinedConfigurations", function() { return predefinedConfigurations; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../httpClient/HttpClient */ "./lib/httpClient/HttpClient.js");
/* harmony import */ var _httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClientConfiguration */ "./lib/httpClient/HttpClientConfiguration.js");



var GraphHttpClientConfiguration =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GraphHttpClientConfiguration, _super);
    function GraphHttpClientConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    return GraphHttpClientConfiguration;
}(_httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (GraphHttpClientConfiguration);
var predefinedConfigurations = {
    v1: new GraphHttpClientConfiguration(_httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_1__["default"].configurations.v1)
};


/***/ }),

/***/ "./lib/graphHttpClient/GraphHttpClientContext.js":
/*!*******************************************************!*\
  !*** ./lib/graphHttpClient/GraphHttpClientContext.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);

var GraphHttpClientContext =  (function () {
    function GraphHttpClientContext(serviceScope) {
    }
    GraphHttpClientContext.prototype.initialize = function (webServerRelativeUrl, graphEndpointUrl) {
        if (this._isInitialized) {
            throw new Error('GraphHttpClientContext has already been initialized.');
        }
        this._isInitialized = true;
        this._webServerRelativeUrl = webServerRelativeUrl;
        this._graphEndpointUrl = graphEndpointUrl;
    };
    GraphHttpClientContext.prototype.getGraphEndpointUrl = function () {
        if (!this._isInitialized) {
            throw new Error('This operation cannot be performed until the GraphHttpClientContext is initialized.');
        }
        return this._graphEndpointUrl;
    };
    GraphHttpClientContext.prototype.getWebServerRelativeUrl = function () {
        if (!this._isInitialized) {
            throw new Error('This operation cannot be performed until the GraphHttpClientContext is initialized.');
        }
        return this._webServerRelativeUrl;
    };
    GraphHttpClientContext.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["ServiceKey"].create('sp-http:GraphHttpClientContext', GraphHttpClientContext);
    return GraphHttpClientContext;
}());
/* harmony default export */ __webpack_exports__["default"] = (GraphHttpClientContext);


/***/ }),

/***/ "./lib/graphHttpClient/GraphHttpClientResponse.js":
/*!********************************************************!*\
  !*** ./lib/graphHttpClient/GraphHttpClientResponse.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClientResponse */ "./lib/httpClient/HttpClientResponse.js");



var GraphHttpClientResponse =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GraphHttpClientResponse, _super);
    function GraphHttpClientResponse(response) {
        return _super.call(this, response) || this;
    }
    GraphHttpClientResponse.prototype.clone = function () {
        return new GraphHttpClientResponse(this.nativeResponse.clone());
    };
    Object.defineProperty(GraphHttpClientResponse.prototype, "correlationId", {
        get: function () {
            if (!this._correlationId) {
                this._correlationId = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Guid"].tryParse(this.headers.get('request-id'));
            }
            return this._correlationId;
        },
        enumerable: true,
        configurable: true
    });
    return GraphHttpClientResponse;
}(_httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (GraphHttpClientResponse);


/***/ }),

/***/ "./lib/httpClient/FetchProvider.js":
/*!*****************************************!*\
  !*** ./lib/httpClient/FetchProvider.js ***!
  \*****************************************/
/*! exports provided: default, fetchProviderServiceKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fetchProviderServiceKey", function() { return fetchProviderServiceKey; });
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);

var FetchProvider =  (function () {
    function FetchProvider(serviceScope) {
    }
    FetchProvider.prototype.fetch = function (request) {
        return window.fetch(request);
    };
    return FetchProvider;
}());
/* harmony default export */ __webpack_exports__["default"] = (FetchProvider);
var fetchProviderServiceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["ServiceKey"].create('sp-client-base:FetchProvider', FetchProvider);


/***/ }),

/***/ "./lib/httpClient/HttpClient.js":
/*!**************************************!*\
  !*** ./lib/httpClient/HttpClient.js ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _FetchProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FetchProvider */ "./lib/httpClient/FetchProvider.js");
/* harmony import */ var _HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HttpClientConfiguration */ "./lib/httpClient/HttpClientConfiguration.js");
/* harmony import */ var _HttpClientResponse__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./HttpClientResponse */ "./lib/httpClient/HttpClientResponse.js");
/* harmony import */ var _HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HttpClientHelper */ "./lib/httpClient/HttpClientHelper.js");





var HttpClient =  (function () {
    function HttpClient(serviceScope) {
        var _this = this;
        this._serviceScope = serviceScope;
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(_FetchProvider__WEBPACK_IMPORTED_MODULE_1__["fetchProviderServiceKey"]);
        });
    }
    HttpClient.prototype.fetch = function (url, configuration, options) {
        return _HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__["default"].fetchCore(configuration, new Request(url, options), this._serviceScope, this._fetchProvider, HttpClient._className).then(function (response) {
            return new _HttpClientResponse__WEBPACK_IMPORTED_MODULE_3__["default"](response);
        });
    };
    HttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, _HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__["default"].overrideHttpMethod(options, 'GET'));
    };
    HttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, _HttpClientHelper__WEBPACK_IMPORTED_MODULE_4__["default"].overrideHttpMethod(options, 'POST'));
    };
    HttpClient.configurations = _HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_2__["predefinedConfigurations"];
    HttpClient.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["ServiceKey"].create('sp-http:HttpClient', HttpClient);
    HttpClient._className = 'HttpClient';
    return HttpClient;
}());
/* harmony default export */ __webpack_exports__["default"] = (HttpClient);


/***/ }),

/***/ "./lib/httpClient/HttpClientConfiguration.js":
/*!***************************************************!*\
  !*** ./lib/httpClient/HttpClientConfiguration.js ***!
  \***************************************************/
/*! exports provided: default, predefinedConfigurations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "predefinedConfigurations", function() { return predefinedConfigurations; });
var HttpClientConfiguration =  (function () {
    function HttpClientConfiguration(flags, overrideFlags) {
        this.flags = {};
        this.initializeFlags();
        this._mergeFlags(flags);
        if (overrideFlags) {
            this._mergeFlags(overrideFlags);
        }
    }
    HttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new HttpClientConfiguration(this.flags, sourceFlags);
    };
    HttpClientConfiguration.prototype.initializeFlags = function () {
    };
    HttpClientConfiguration.prototype._mergeFlags = function (source) {
        for (var _i = 0, _a = Object.keys(this.flags); _i < _a.length; _i++) {
            var key = _a[_i];
            if (source.hasOwnProperty(key)) {
                if (source[key] !== undefined) {
                    this.flags[key] = source[key];
                }
            }
        }
    };
    return HttpClientConfiguration;
}());
/* harmony default export */ __webpack_exports__["default"] = (HttpClientConfiguration);
var predefinedConfigurations = {
    v1: new HttpClientConfiguration({})
};


/***/ }),

/***/ "./lib/httpClient/HttpClientHelper.js":
/*!********************************************!*\
  !*** ./lib/httpClient/HttpClientHelper.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__);

var HttpClientHelper =  (function () {
    function HttpClientHelper() {
    }
    HttpClientHelper.overrideHttpMethod = function (options, httpRequestMethod) {
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.method = httpRequestMethod;
        return modifiedOptions;
    };
    HttpClientHelper.fetchCore = function (configuration, request, serviceScope, fetchProvider, logSource) {
        return new Promise(function (resolve, reject) {
            _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logVerbose(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_LogSource"].create(logSource), request.method + " " + request.url);
            return fetchProvider.fetch(request).then(resolve, reject);
        });
    };
    return HttpClientHelper;
}());
/* harmony default export */ __webpack_exports__["default"] = (HttpClientHelper);


/***/ }),

/***/ "./lib/httpClient/HttpClientResponse.js":
/*!**********************************************!*\
  !*** ./lib/httpClient/HttpClientResponse.js ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var HttpClientResponse =  (function () {
    function HttpClientResponse(response) {
        this.nativeResponse = response;
    }
    Object.defineProperty(HttpClientResponse.prototype, "body", {
        get: function () { return this.nativeResponse.body; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "bodyUsed", {
        get: function () { return this.nativeResponse.bodyUsed; },
        enumerable: true,
        configurable: true
    });
    HttpClientResponse.prototype.arrayBuffer = function () { return this.nativeResponse.arrayBuffer(); };
    HttpClientResponse.prototype.blob = function () { return this.nativeResponse.blob(); };
    HttpClientResponse.prototype.formData = function () { return this.nativeResponse.formData; }; 
    HttpClientResponse.prototype.json = function () { return this.nativeResponse.json(); };
    HttpClientResponse.prototype.text = function () { return this.nativeResponse.text(); };
    Object.defineProperty(HttpClientResponse.prototype, "type", {
        get: function () { return this.nativeResponse.type; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "redirected", {
        get: function () { return this.nativeResponse.redirected; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "url", {
        get: function () { return this.nativeResponse.url; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "status", {
        get: function () { return this.nativeResponse.status; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "ok", {
        get: function () { return this.nativeResponse.ok; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "statusText", {
        get: function () { return this.nativeResponse.statusText; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "trailer", {
        get: function () { return this.nativeResponse.trailer; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpClientResponse.prototype, "headers", {
        get: function () { return this.nativeResponse.headers; },
        enumerable: true,
        configurable: true
    });
    HttpClientResponse.prototype.clone = function () {
        return new HttpClientResponse(this.nativeResponse.clone());
    };
    return HttpClientResponse;
}());
/* harmony default export */ __webpack_exports__["default"] = (HttpClientResponse);


/***/ }),

/***/ "./lib/index.js":
/*!**********************!*\
  !*** ./lib/index.js ***!
  \**********************/
/*! exports provided: HttpClient, HttpClientConfiguration, HttpClientResponse, DigestCache, SPHttpClient, SPHttpClientCommonConfiguration, SPHttpClientConfiguration, SPHttpClientResponse, SPHttpClientBatchConfiguration, SPHttpClientBatch, ODataVersion, OAuthTokenProvider, _AadTokenProviders, _AadConstants, GraphHttpClient, GraphHttpClientResponse, GraphHttpClientConfiguration, _GraphHttpClientContext, AadTokenProvider, TokenAcquisitionEventArgs, AadHttpClient, AadHttpClientConfiguration, AadHttpClientFactory, AadTokenProviderFactory, MSGraphClient, MSGraphClientFactory, _AdalAuthContextManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./httpClient/HttpClient */ "./lib/httpClient/HttpClient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpClient", function() { return _httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_0__["default"]; });

/* harmony import */ var _httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./httpClient/HttpClientConfiguration */ "./lib/httpClient/HttpClientConfiguration.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpClientConfiguration", function() { return _httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_1__["default"]; });

/* harmony import */ var _httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./httpClient/HttpClientResponse */ "./lib/httpClient/HttpClientResponse.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpClientResponse", function() { return _httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _spHttpClient_DigestCache__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./spHttpClient/DigestCache */ "./lib/spHttpClient/DigestCache.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DigestCache", function() { return _spHttpClient_DigestCache__WEBPACK_IMPORTED_MODULE_3__["default"]; });

/* harmony import */ var _spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./spHttpClient/SPHttpClient */ "./lib/spHttpClient/SPHttpClient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHttpClient", function() { return _spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_4__["default"]; });

/* harmony import */ var _spHttpClient_SPHttpClientCommonConfiguration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./spHttpClient/SPHttpClientCommonConfiguration */ "./lib/spHttpClient/SPHttpClientCommonConfiguration.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHttpClientCommonConfiguration", function() { return _spHttpClient_SPHttpClientCommonConfiguration__WEBPACK_IMPORTED_MODULE_5__["default"]; });

/* harmony import */ var _spHttpClient_SPHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./spHttpClient/SPHttpClientConfiguration */ "./lib/spHttpClient/SPHttpClientConfiguration.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHttpClientConfiguration", function() { return _spHttpClient_SPHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_6__["default"]; });

/* harmony import */ var _spHttpClient_SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./spHttpClient/SPHttpClientResponse */ "./lib/spHttpClient/SPHttpClientResponse.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHttpClientResponse", function() { return _spHttpClient_SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_7__["default"]; });

/* harmony import */ var _spHttpClient_SPHttpClientBatchConfiguration__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./spHttpClient/SPHttpClientBatchConfiguration */ "./lib/spHttpClient/SPHttpClientBatchConfiguration.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHttpClientBatchConfiguration", function() { return _spHttpClient_SPHttpClientBatchConfiguration__WEBPACK_IMPORTED_MODULE_8__["default"]; });

/* harmony import */ var _spHttpClient_SPHttpClientBatch__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./spHttpClient/SPHttpClientBatch */ "./lib/spHttpClient/SPHttpClientBatch.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SPHttpClientBatch", function() { return _spHttpClient_SPHttpClientBatch__WEBPACK_IMPORTED_MODULE_9__["default"]; });

/* harmony import */ var _spHttpClient_ODataVersion__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./spHttpClient/ODataVersion */ "./lib/spHttpClient/ODataVersion.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ODataVersion", function() { return _spHttpClient_ODataVersion__WEBPACK_IMPORTED_MODULE_10__["default"]; });

/* harmony import */ var _oauthTokenProvider_OAuthTokenProvider__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./oauthTokenProvider/OAuthTokenProvider */ "./lib/oauthTokenProvider/OAuthTokenProvider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OAuthTokenProvider", function() { return _oauthTokenProvider_OAuthTokenProvider__WEBPACK_IMPORTED_MODULE_11__["default"]; });

/* harmony import */ var _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./oauthTokenProvider/AadTokenProviders */ "./lib/oauthTokenProvider/AadTokenProviders.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "_AadTokenProviders", function() { return _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_12__["default"]; });

/* harmony import */ var _oauthTokenProvider_AadConstants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./oauthTokenProvider/AadConstants */ "./lib/oauthTokenProvider/AadConstants.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "_AadConstants", function() { return _oauthTokenProvider_AadConstants__WEBPACK_IMPORTED_MODULE_13__["default"]; });

/* harmony import */ var _graphHttpClient_GraphHttpClient__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./graphHttpClient/GraphHttpClient */ "./lib/graphHttpClient/GraphHttpClient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphHttpClient", function() { return _graphHttpClient_GraphHttpClient__WEBPACK_IMPORTED_MODULE_14__["default"]; });

/* harmony import */ var _graphHttpClient_GraphHttpClientResponse__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./graphHttpClient/GraphHttpClientResponse */ "./lib/graphHttpClient/GraphHttpClientResponse.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphHttpClientResponse", function() { return _graphHttpClient_GraphHttpClientResponse__WEBPACK_IMPORTED_MODULE_15__["default"]; });

/* harmony import */ var _graphHttpClient_GraphHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./graphHttpClient/GraphHttpClientConfiguration */ "./lib/graphHttpClient/GraphHttpClientConfiguration.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphHttpClientConfiguration", function() { return _graphHttpClient_GraphHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_16__["default"]; });

/* harmony import */ var _graphHttpClient_GraphHttpClientContext__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./graphHttpClient/GraphHttpClientContext */ "./lib/graphHttpClient/GraphHttpClientContext.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "_GraphHttpClientContext", function() { return _graphHttpClient_GraphHttpClientContext__WEBPACK_IMPORTED_MODULE_17__["default"]; });

/* harmony import */ var _oauthTokenProvider_AadTokenProvider__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./oauthTokenProvider/AadTokenProvider */ "./lib/oauthTokenProvider/AadTokenProvider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AadTokenProvider", function() { return _oauthTokenProvider_AadTokenProvider__WEBPACK_IMPORTED_MODULE_18__["default"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TokenAcquisitionEventArgs", function() { return _oauthTokenProvider_AadTokenProvider__WEBPACK_IMPORTED_MODULE_18__["TokenAcquisitionEventArgs"]; });

/* harmony import */ var _aadHttpClient_AadHttpClient__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./aadHttpClient/AadHttpClient */ "./lib/aadHttpClient/AadHttpClient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AadHttpClient", function() { return _aadHttpClient_AadHttpClient__WEBPACK_IMPORTED_MODULE_19__["default"]; });

/* harmony import */ var _aadHttpClient_AadHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./aadHttpClient/AadHttpClientConfiguration */ "./lib/aadHttpClient/AadHttpClientConfiguration.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AadHttpClientConfiguration", function() { return _aadHttpClient_AadHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_20__["default"]; });

/* harmony import */ var _aadHttpClient_AadHttpClientFactory__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./aadHttpClient/AadHttpClientFactory */ "./lib/aadHttpClient/AadHttpClientFactory.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AadHttpClientFactory", function() { return _aadHttpClient_AadHttpClientFactory__WEBPACK_IMPORTED_MODULE_21__["default"]; });

/* harmony import */ var _oauthTokenProvider_AadTokenProviderFactory__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./oauthTokenProvider/AadTokenProviderFactory */ "./lib/oauthTokenProvider/AadTokenProviderFactory.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AadTokenProviderFactory", function() { return _oauthTokenProvider_AadTokenProviderFactory__WEBPACK_IMPORTED_MODULE_22__["default"]; });

/* harmony import */ var _msGraphClient_MSGraphClient__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./msGraphClient/MSGraphClient */ "./lib/msGraphClient/MSGraphClient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MSGraphClient", function() { return _msGraphClient_MSGraphClient__WEBPACK_IMPORTED_MODULE_23__["default"]; });

/* harmony import */ var _msGraphClient_MSGraphClientFactory__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./msGraphClient/MSGraphClientFactory */ "./lib/msGraphClient/MSGraphClientFactory.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MSGraphClientFactory", function() { return _msGraphClient_MSGraphClientFactory__WEBPACK_IMPORTED_MODULE_24__["default"]; });

/* harmony import */ var _oauthTokenProvider_AdalAuthContextManager__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./oauthTokenProvider/AdalAuthContextManager */ "./lib/oauthTokenProvider/AdalAuthContextManager.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "_AdalAuthContextManager", function() { return _oauthTokenProvider_AdalAuthContextManager__WEBPACK_IMPORTED_MODULE_25__["default"]; });





























/***/ }),

/***/ "./lib/msGraphClient/MSGraphClient.js":
/*!********************************************!*\
  !*** ./lib/msGraphClient/MSGraphClient.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../oauthTokenProvider/AadTokenProviders */ "./lib/oauthTokenProvider/AadTokenProviders.js");
/* harmony import */ var _graphHttpClient_GraphHttpClientContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../graphHttpClient/GraphHttpClientContext */ "./lib/graphHttpClient/GraphHttpClientContext.js");
/* harmony import */ var _SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../SPHttpStrings.resx */ "./lib/SPHttpStrings.resx.js");





var MSGraphClient =  (function () {
    function MSGraphClient(serviceScope) {
        var _this = this;
        serviceScope.whenFinished(function () {
            MSGraphClient._graphBaseUrl = serviceScope.consume(_graphHttpClient_GraphHttpClientContext__WEBPACK_IMPORTED_MODULE_3__["default"].serviceKey).getGraphEndpointUrl();
            if (!MSGraphClient._instance) {
                MSGraphClient._instance = _this._createGraphClientInstance(_oauthTokenProvider_AadTokenProviders__WEBPACK_IMPORTED_MODULE_2__["default"].configurable);
            }
        });
    }
    MSGraphClient.prototype.api = function (path, config) {
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Validate"].isNonemptyString(path, 'path');
        MSGraphClient._instance.config = Object.assign({}, MSGraphClient._originalConfig);
        if (config) {
            for (var key in config) {
                if (config[key]) {
                    MSGraphClient._instance.config[key] = config[key];
                }
            }
        }
        return MSGraphClient._instance.api(path);
    };
    MSGraphClient.prototype._createGraphClientInstance = function (tokenProvider) {
        var _this = this;
        var graphClientModule;
        if (!(MSGraphClient._window.MicrosoftGraph && MSGraphClient._window.MicrosoftGraph.Client)) {
            throw new Error(_SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_4__["default"].graphClientInitializationError);
        }
        else {
            graphClientModule = MSGraphClient._window.MicrosoftGraph.Client;
            MSGraphClient._window.MicrosoftGraph = undefined;
        }
        var graphClient = graphClientModule.init({
            authProvider: function (done) {
                _this._getOAuthToken(tokenProvider).then(function (token) {
                    done(undefined , token);
                }).catch(function (e) {
                    done(e, '');
                });
            },
            baseUrl: MSGraphClient._graphBaseUrl
        });
        MSGraphClient._originalConfig = graphClient.config;
        return graphClient;
    };
    MSGraphClient.prototype._getOAuthToken = function (tokenProvider) {
        var qosMonitor = new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__["_QosMonitor"]('MSGraphClient.FetchGraphToken');
        return tokenProvider.getToken(MSGraphClient._graphBaseUrl).then(function (response) {
            qosMonitor.writeSuccess();
            return response;
        }).catch(function (error) {
            qosMonitor.writeUnexpectedFailure('FetchGraphToken', error);
            throw error;
        });
    };
    MSGraphClient._window = window;
    return MSGraphClient;
}());
/* harmony default export */ __webpack_exports__["default"] = (MSGraphClient);


/***/ }),

/***/ "./lib/msGraphClient/MSGraphClientFactory.js":
/*!***************************************************!*\
  !*** ./lib/msGraphClient/MSGraphClientFactory.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _MSGraphClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MSGraphClient */ "./lib/msGraphClient/MSGraphClient.js");


var MSGraphClientFactory =  (function () {
    function MSGraphClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    MSGraphClientFactory.prototype.getClient = function () {
        var _this = this;
        if (!_MSGraphClient__WEBPACK_IMPORTED_MODULE_1__["default"]._instance) {
            return __webpack_require__.e(/*! import() */ 0).then(__webpack_require__.t.bind(null, /*! @microsoft/microsoft-graph-client/lib/graph-js-sdk-web */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/@microsoft/microsoft-graph-client/1.1.0/node_modules/@microsoft/microsoft-graph-client/lib/graph-js-sdk-web.js", 7))
                .then(function () {
                return new _MSGraphClient__WEBPACK_IMPORTED_MODULE_1__["default"](_this._serviceScope);
            });
        }
        else {
            return Promise.resolve(new _MSGraphClient__WEBPACK_IMPORTED_MODULE_1__["default"](this._serviceScope));
        }
    };
    MSGraphClientFactory.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["ServiceKey"].create('sp-http:MSGraphClientFactory', MSGraphClientFactory);
    return MSGraphClientFactory;
}());
/* harmony default export */ __webpack_exports__["default"] = (MSGraphClientFactory);


/***/ }),

/***/ "./lib/oauthTokenProvider/AadConstants.js":
/*!************************************************!*\
  !*** ./lib/oauthTokenProvider/AadConstants.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var AadConstants =  (function () {
    function AadConstants() {
    }
    AadConstants.SPFX_SINGLE_SIGN_ON_REPLY_URL = 'spfxsinglesignon.aspx';
    AadConstants.REDIRECT_QUERY_PARAM = 'redirect';
    AadConstants.PRE_AUTHORIZED_APP_PRINCIPAL_ID = '08e18876-6177-487e-b8b5-cf950c1e598c';
    AadConstants.UNRESOLVABLE_ERROR_CODES = new Set([
        'AADSTS65001',
        'AADSTS53000',
        'AADSTS53003' 
    ]);
    AadConstants.RESOLVABLE_ERROR_CODES = new Set([
        'AADSTS50058',
        'AADSTS50076',
        'AADSTS50079',
        'AADSTS50132',
        'AADSTS50133' 
    ]);
    return AadConstants;
}());
/* harmony default export */ __webpack_exports__["default"] = (AadConstants);


/***/ }),

/***/ "./lib/oauthTokenProvider/AadErrorHandler.js":
/*!***************************************************!*\
  !*** ./lib/oauthTokenProvider/AadErrorHandler.js ***!
  \***************************************************/
/*! exports provided: AadErrorHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AadErrorHandler", function() { return AadErrorHandler; });
/* harmony import */ var _AadTokenProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AadTokenProvider */ "./lib/oauthTokenProvider/AadTokenProvider.js");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../SPHttpStrings.resx */ "./lib/SPHttpStrings.resx.js");



var AadErrorHandler =  (function () {
    function AadErrorHandler() {
    }
    AadErrorHandler._handleInteractionRequiredFailures = function (authContext, errorMessage, resource) {
        var urlNavigate = authContext._getNavigateUrl(authContext.RESPONSE_TYPE.TOKEN, resource) +
            '&prompt=select_account';
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["_SPEventManager"].instance.raiseEvent(_AadTokenProvider__WEBPACK_IMPORTED_MODULE_0__["default"]._tokenAcquisitionEventId, new _AadTokenProvider__WEBPACK_IMPORTED_MODULE_0__["TokenAcquisitionEventArgs"](_SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_2__["default"].additionalCredentialsWarning, urlNavigate));
    };
    AadErrorHandler._doesErrorCodeExist = function (errorMessage, setOfErrorCodes) {
        var errorCodes = errorMessage.match(/(AADSTS)[0-9]+/g) || [];
        for (var _i = 0, errorCodes_1 = errorCodes; _i < errorCodes_1.length; _i++) {
            var errorCode = errorCodes_1[_i];
            if (setOfErrorCodes.has(errorCode)) {
                return true;
            }
        }
        return false;
    };
    return AadErrorHandler;
}());



/***/ }),

/***/ "./lib/oauthTokenProvider/AadTokenProvider.js":
/*!****************************************************!*\
  !*** ./lib/oauthTokenProvider/AadTokenProvider.js ***!
  \****************************************************/
/*! exports provided: TokenAcquisitionEventArgs, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TokenAcquisitionEventArgs", function() { return TokenAcquisitionEventArgs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _AdalAuthContextManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AdalAuthContextManager */ "./lib/oauthTokenProvider/AdalAuthContextManager.js");
/* harmony import */ var _SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../SPHttpStrings.resx */ "./lib/SPHttpStrings.resx.js");




var TokenAcquisitionEventArgs =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TokenAcquisitionEventArgs, _super);
    function TokenAcquisitionEventArgs(message, redirectUrl) {
        var _this = _super.call(this) || this;
        _this.message = message;
        _this.redirectUrl = redirectUrl;
        return _this;
    }
    return TokenAcquisitionEventArgs;
}(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["SPEventArgs"]));

var AadTokenProvider =  (function () {
    function AadTokenProvider(configuration, oboConfiguration) {
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Validate"].isNonemptyString(configuration.aadInstanceUrl, 'aadInstanceUrl');
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Validate"].isNonemptyString(configuration.aadTenantId, 'aadTenantId');
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Validate"].isNonemptyString(configuration.redirectUri, 'redirectUri');
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Validate"].isNonemptyString(configuration.servicePrincipalId, 'servicePrincipalId');
        this._defaultConfiguration = configuration;
        this._fetchQueue = Promise.resolve();
        this._oboConfiguration = oboConfiguration;
        this._tokenAcquisitionEvent = new _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["SPEvent"](AadTokenProvider._tokenAcquisitionEventId);
    }
    AadTokenProvider.prototype.getToken = function (resourceEndpoint, useCachedToken) {
        if (useCachedToken === void 0) { useCachedToken = true; }
        if (this._defaultConfiguration.servicePrincipalId === _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Guid"].empty.toString()) {
            return Promise.reject(new Error(_SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_3__["default"].servicePrincipalNotAvaliableError));
        }
        return this._getTokenInternal(resourceEndpoint, this._defaultConfiguration, useCachedToken);
    };
    AadTokenProvider.prototype._getTokenInternal = function (resourceEndpoint, configuration, useCachedToken) {
        var _this = this;
        if (useCachedToken === void 0) { useCachedToken = true; }
        var tokenProviderConfig = configuration || this._defaultConfiguration;
        if (!this._authContextManager) {
            this._authContextManager = new _AdalAuthContextManager__WEBPACK_IMPORTED_MODULE_2__["default"]();
        }
        if (!_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["_SPKillSwitch"].isActivated(AadTokenProvider.removeSerialRequestsKillSwitchGuid, '05/13/19', 'Without ID Tokens, we no longer need to request tokens in parallel')) {
            return this._authContextManager.getAuthContext(tokenProviderConfig, this._oboConfiguration)
                .then(function (authContext) { return authContext.getToken(resourceEndpoint, useCachedToken); });
        }
        else {
            var getAuthContextPromise = function () { return _this._authContextManager.getAuthContext(tokenProviderConfig, _this._oboConfiguration); };
            this._fetchQueue =
                this._fetchQueue
                    .then(getAuthContextPromise, getAuthContextPromise)
                    .then(function (authContext) { return authContext.getToken(resourceEndpoint, useCachedToken); });
            return this._fetchQueue;
        }
    };
    Object.defineProperty(AadTokenProvider.prototype, "tokenAcquisitionEvent", {
        get: function () {
            return this._tokenAcquisitionEvent;
        },
        enumerable: true,
        configurable: true
    });
    AadTokenProvider._tokenAcquisitionEventId = 'tokenAcquisitionFailure';
    AadTokenProvider.removeSerialRequestsKillSwitchGuid = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Guid"].parse('d6f1838d-2b33-4c10-8c51-f61b13d20a61');
    return AadTokenProvider;
}());
/* harmony default export */ __webpack_exports__["default"] = (AadTokenProvider);


/***/ }),

/***/ "./lib/oauthTokenProvider/AadTokenProviderFactory.js":
/*!***********************************************************!*\
  !*** ./lib/oauthTokenProvider/AadTokenProviderFactory.js ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _AadTokenProviders__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AadTokenProviders */ "./lib/oauthTokenProvider/AadTokenProviders.js");


var AadTokenProviderFactory =  (function () {
    function AadTokenProviderFactory() {
    }
    AadTokenProviderFactory.prototype.getTokenProvider = function () {
        return Promise.resolve(_AadTokenProviders__WEBPACK_IMPORTED_MODULE_1__["default"].configurable);
    };
    AadTokenProviderFactory.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["ServiceKey"].create('sp-http:AadTokenProviderFactory', AadTokenProviderFactory);
    return AadTokenProviderFactory;
}());
/* harmony default export */ __webpack_exports__["default"] = (AadTokenProviderFactory);


/***/ }),

/***/ "./lib/oauthTokenProvider/AadTokenProviders.js":
/*!*****************************************************!*\
  !*** ./lib/oauthTokenProvider/AadTokenProviders.js ***!
  \*****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _MockAadTokenProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MockAadTokenProvider */ "./lib/oauthTokenProvider/MockAadTokenProvider.js");

var AadTokenProviders =  (function () {
    function AadTokenProviders() {
    }
    AadTokenProviders._initialize = function (configurable, preAuthorizedConfig) {
        AadTokenProviders._configurableTokenProvider = configurable;
        AadTokenProviders._preAuthorizedConfiguration = preAuthorizedConfig;
    };
    Object.defineProperty(AadTokenProviders, "configurable", {
        get: function () {
            return AadTokenProviders._configurableTokenProvider;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AadTokenProviders, "preAuthorizedConfiguration", {
        get: function () {
            return this._preAuthorizedConfiguration;
        },
        enumerable: true,
        configurable: true
    });
    AadTokenProviders._configurableTokenProvider = new _MockAadTokenProvider__WEBPACK_IMPORTED_MODULE_0__["default"]();
    return AadTokenProviders;
}());
/* harmony default export */ __webpack_exports__["default"] = (AadTokenProviders);


/***/ }),

/***/ "./lib/oauthTokenProvider/AdalAuthContext.js":
/*!***************************************************!*\
  !*** ./lib/oauthTokenProvider/AdalAuthContext.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _AadConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AadConstants */ "./lib/oauthTokenProvider/AadConstants.js");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _AadErrorHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AadErrorHandler */ "./lib/oauthTokenProvider/AadErrorHandler.js");




var AdalAuthContext =  (function () {
    function AdalAuthContext(authContext, aadUserId) {
        this.servicePrincipalId = authContext.config.clientId;
        this._aadUserId = aadUserId || '';
        this._patchAdalAuthContext(authContext);
        this._authContext = authContext;
    }
    AdalAuthContext.prototype.getToken = function (resourceEndpoint, useCachedToken) {
        return this._getAccessToken(resourceEndpoint, useCachedToken);
    };
    AdalAuthContext.prototype._getAccessToken = function (resourceEndpoint, useCachedToken) {
        var cachedAccessToken = this._tryGetCachedAccessToken(resourceEndpoint);
        if (useCachedToken && cachedAccessToken) {
            return Promise.resolve(cachedAccessToken);
        }
        else {
            return this._fetchAccessToken(resourceEndpoint);
        }
    };
    AdalAuthContext.prototype._tryGetCachedAccessToken = function (resourceEndpoint) {
        var cachedToken;
        try {
            cachedToken = this._authContext.getCachedToken(resourceEndpoint);
            if (!_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["_SPKillSwitch"].isActivated(AdalAuthContext.validateTokenIdentityKillSwitchGuid, '05/13/19', 'Validate Access Token belongs to current user')) {
                var jwtToken = this._authContext._extractIdToken(cachedToken);
                if (jwtToken.oid !== this._aadUserId || jwtToken.appid !== this.servicePrincipalId) {
                    cachedToken = undefined;
                }
            }
        }
        catch (e) {
        }
        return cachedToken;
    };
    AdalAuthContext.prototype._fetchAccessToken = function (resourceEndpoint) {
        var _this = this;
        var acquireAccessTokenQosMonitor = new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_2__["_QosMonitor"]('AadTokenProvider.AcquireAccessToken');
        var correlationId = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].newGuid().toString();
        var correlationObject;
        if (!_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["_SPKillSwitch"].isActivated(AdalAuthContext.addCorrelationIdKillSwitchGuid, '05/13/19', 'Add correlation id to AAD request')) {
            correlationObject = { CorrelationId: correlationId };
            this._authContext.config.correlationId = correlationId;
        }
        return this._fetchAccessTokenSilent(resourceEndpoint)
            .then(function (token) {
            acquireAccessTokenQosMonitor.writeSuccess(correlationObject);
            return token;
        })
            .catch(function (e) {
            if (_AadErrorHandler__WEBPACK_IMPORTED_MODULE_3__["AadErrorHandler"]._doesErrorCodeExist(e.message, _AadConstants__WEBPACK_IMPORTED_MODULE_1__["default"].RESOLVABLE_ERROR_CODES)) {
                _AadErrorHandler__WEBPACK_IMPORTED_MODULE_3__["AadErrorHandler"]._handleInteractionRequiredFailures(_this._authContext, e.message, resourceEndpoint);
                acquireAccessTokenQosMonitor.writeExpectedFailure(e.message, e, correlationObject);
            }
            else if (_AadErrorHandler__WEBPACK_IMPORTED_MODULE_3__["AadErrorHandler"]._doesErrorCodeExist(e.message, _AadConstants__WEBPACK_IMPORTED_MODULE_1__["default"].UNRESOLVABLE_ERROR_CODES)) {
                acquireAccessTokenQosMonitor.writeExpectedFailure(e.message, e, correlationObject);
            }
            else {
                acquireAccessTokenQosMonitor.writeUnexpectedFailure(e.message, e, correlationObject);
            }
            throw e;
        });
    };
    AdalAuthContext.prototype._fetchAccessTokenSilent = function (resourceEndpoint) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this._authContext.acquireToken(resourceEndpoint, function (message, token) {
                if (!token) {
                    reject(new Error(message));
                }
                else {
                    resolve(token);
                }
            });
        });
    };
    AdalAuthContext.prototype._patchAdalAuthContext = function (authContext) {
        var _this = this;
        Object.getPrototypeOf(authContext)._singletonInstance = undefined;
        authContext._addAdalFrame = function (iframeId) {
            return _this._addAdalFrame(authContext, iframeId);
        };
        authContext._loadFrame = function (urlNavigate, frameName) {
            return _this._loadFrame(authContext, urlNavigate, frameName);
        };
        authContext._user = {};
    };
    AdalAuthContext.prototype._addAdalFrame = function (authContext, iframeId) {
        if (typeof iframeId === 'undefined') {
            return;
        }
        authContext.info('Add adal frame to document:' + iframeId);
        var adalFrame = document.getElementById(iframeId);
        var sandboxAttributes = 'allow-same-origin allow-scripts allow-forms allow-pointer-lock';
        if (!adalFrame) {
            if (document.createElement && document.documentElement &&
                (window.opera || window.navigator.userAgent.indexOf('MSIE 5.0') === -1)) {
                var ifr = document.createElement('iframe');
                ifr.setAttribute('id', iframeId);
                ifr.setAttribute('aria-hidden', 'true');
                ifr.setAttribute('sandbox', sandboxAttributes);
                ifr.style.visibility = 'hidden';
                ifr.style.position = 'absolute';
                ifr.style.width = ifr.style.height = ifr.style.border = '0';
                adalFrame = document.getElementsByTagName('body')[0].appendChild(ifr);
            }
            else if (document.body && document.body.insertAdjacentHTML) {
                document.body.insertAdjacentHTML('beforeEnd', '<iframe sandbox="' + sandboxAttributes + '" name="' +
                    iframeId + '" id="' + iframeId + '" style="display:none"></iframe>');
            }
            if (window.frames && window.frames[iframeId]) {
                adalFrame = window.frames[iframeId];
            }
        }
        return adalFrame;
    };
    AdalAuthContext.prototype._loadFrame = function (authContext, urlNavigate, frameName) {
        authContext.info('LoadFrame: ' + frameName);
        var frameHandle = authContext._addAdalFrame(frameName);
        frameHandle.src = urlNavigate;
    };
    AdalAuthContext.validateTokenIdentityKillSwitchGuid = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].parse('3c341cba-7d49-42d3-821d-8960d3fbdce5');
    AdalAuthContext.addCorrelationIdKillSwitchGuid = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].parse('61fb0ba9-bd42-4cc3-9f65-615460488164');
    return AdalAuthContext;
}());
/* harmony default export */ __webpack_exports__["default"] = (AdalAuthContext);


/***/ }),

/***/ "./lib/oauthTokenProvider/AdalAuthContextManager.js":
/*!**********************************************************!*\
  !*** ./lib/oauthTokenProvider/AdalAuthContextManager.js ***!
  \**********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _AdalAuthContext__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AdalAuthContext */ "./lib/oauthTokenProvider/AdalAuthContext.js");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _OBOTokenProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OBOTokenProvider */ "./lib/oauthTokenProvider/OBOTokenProvider.js");



var AdalAuthContextManager =  (function () {
    function AdalAuthContextManager() {
        this._loadAdalJsModulePromise = undefined;
        this._authContextDictionary = new Map();
    }
    AdalAuthContextManager.convertTokenParametersToConfig = function (tokenProviderParameters) {
        var extraQueryParameter;
        if (tokenProviderParameters.userPrincipalName &&
            !_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["_SPKillSwitch"].isActivated(AdalAuthContextManager.usePromptQueryParamKillSwitchGuid, '03/19/19', 'Use login hint to resolve ambiguous users failure')) {
            extraQueryParameter = "login_hint=" + encodeURIComponent(tokenProviderParameters.userPrincipalName);
        }
        return {
            clientId: tokenProviderParameters.servicePrincipalId,
            redirectUri: tokenProviderParameters.redirectUri,
            instance: _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["UrlUtilities"].removeEndSlash(tokenProviderParameters.aadInstanceUrl) + '/',
            loadFrameTimeout: 10000,
            tenant: tokenProviderParameters.aadTenantId,
            navigateToLoginRequestUrl: false,
            extraQueryParameter: extraQueryParameter
        };
    };
    AdalAuthContextManager.prototype.getAuthContext = function (tokenProviderConfiguration, sharePointOBOProviderConfiguration) {
        var _this = this;
        if (!this._loadAdalJsModulePromise) {
            this._loadAdalJsModulePromise = this._loadAdalJs();
        }
        return this._loadAdalJsModulePromise.then(function (adalModule) {
            if (sharePointOBOProviderConfiguration) {
                return new _OBOTokenProvider__WEBPACK_IMPORTED_MODULE_2__["OBOTokenProvider"](adalModule.inject(AdalAuthContextManager.convertTokenParametersToConfig(tokenProviderConfiguration)), sharePointOBOProviderConfiguration);
            }
            if (!_this._authContextDictionary.has(tokenProviderConfiguration.servicePrincipalId)) {
                var authContext = new _AdalAuthContext__WEBPACK_IMPORTED_MODULE_0__["default"](adalModule.inject(AdalAuthContextManager.convertTokenParametersToConfig(tokenProviderConfiguration)), tokenProviderConfiguration.aadUserId);
                _this._authContextDictionary.set(tokenProviderConfiguration.servicePrincipalId, authContext);
            }
            return _this._authContextDictionary.get(tokenProviderConfiguration.servicePrincipalId);
        });
    };
    AdalAuthContextManager.prototype._loadAdalJs = function () {
        return __webpack_require__.e(/*! import() */ 1).then(__webpack_require__.t.bind(null, /*! adal-angular */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/adal-angular/1.0.16/node_modules/adal-angular/lib/adal.js", 7));
    };
    AdalAuthContextManager.usePromptQueryParamKillSwitchGuid = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Guid"].parse('44a40d56-a9b7-4059-9569-78abe3f7f360');
    return AdalAuthContextManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (AdalAuthContextManager);


/***/ }),

/***/ "./lib/oauthTokenProvider/MockAadTokenProvider.js":
/*!********************************************************!*\
  !*** ./lib/oauthTokenProvider/MockAadTokenProvider.js ***!
  \********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../SPHttpStrings.resx */ "./lib/SPHttpStrings.resx.js");


var MockAadTokenProvider =  (function () {
    function MockAadTokenProvider() {
        this._tokenAcquisitionEvent = new _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["SPEvent"](MockAadTokenProvider._tokenAcquisitionEventId);
    }
    MockAadTokenProvider.prototype.getToken = function (resourceEndpoint, useCachedToken) {
        return Promise.reject(new Error(_SPHttpStrings_resx__WEBPACK_IMPORTED_MODULE_1__["default"].servicePrincipalNotAvaliableError));
    };
    Object.defineProperty(MockAadTokenProvider.prototype, "tokenAcquisitionEvent", {
        get: function () {
            return this._tokenAcquisitionEvent;
        },
        enumerable: true,
        configurable: true
    });
    MockAadTokenProvider._tokenAcquisitionEventId = 'tokenAcquisitionFailure';
    return MockAadTokenProvider;
}());
/* harmony default export */ __webpack_exports__["default"] = (MockAadTokenProvider);


/***/ }),

/***/ "./lib/oauthTokenProvider/OAuthTokenProvider.js":
/*!******************************************************!*\
  !*** ./lib/oauthTokenProvider/OAuthTokenProvider.js ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _ms_sp_client_shared__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ms/sp-client-shared */ "../../libraries/sp-client-shared/lib/index.js");
/* harmony import */ var _OAuthUtilityContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OAuthUtilityContext */ "./lib/oauthTokenProvider/OAuthUtilityContext.js");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__);



var OAuthTokenProvider =  (function () {
    function OAuthTokenProvider(serviceScope) {
        this._tokenUtility = new _ms_sp_client_shared__WEBPACK_IMPORTED_MODULE_0__["OAuthUtility"](new _OAuthUtilityContext__WEBPACK_IMPORTED_MODULE_1__["default"](serviceScope));
    }
    OAuthTokenProvider.prototype.getOAuthToken = function (resource, webUrl) {
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__["Validate"].isNotNullOrUndefined(resource, 'resource');
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__["Validate"].isNonemptyString(resource, 'resource');
        return this._tokenUtility.getOAuthToken(resource, webUrl);
    };
    OAuthTokenProvider.prototype.clearCachedToken = function (resource) {
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__["Validate"].isNotNullOrUndefined(resource, 'resource');
        _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__["Validate"].isNonemptyString(resource, 'resource');
        this._tokenUtility.clearCachedToken(resource);
    };
    OAuthTokenProvider.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_2__["ServiceKey"].create('sp-client-shared:OAuthTokenProvider', OAuthTokenProvider);
    return OAuthTokenProvider;
}());
/* harmony default export */ __webpack_exports__["default"] = (OAuthTokenProvider);


/***/ }),

/***/ "./lib/oauthTokenProvider/OAuthUtilityContext.js":
/*!*******************************************************!*\
  !*** ./lib/oauthTokenProvider/OAuthUtilityContext.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../spHttpClient/SPHttpClient */ "./lib/spHttpClient/SPHttpClient.js");


var TokenUtilityLogger =  (function () {
    function TokenUtilityLogger() {
    }
    TokenUtilityLogger.prototype.logInfo = function (message) {
        _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logVerbose(TokenUtilityLogger.logSource, message);
    };
    TokenUtilityLogger.prototype.logError = function (message) {
        _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logError(TokenUtilityLogger.logSource, new Error(message));
    };
    TokenUtilityLogger.prototype.logWarning = function (message) {
        _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logVerbose(TokenUtilityLogger.logSource, 'Warning: ' + message);
    };
    TokenUtilityLogger.logSource = _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_LogSource"].create('TokenUtility');
    return TokenUtilityLogger;
}());
var OAuthUtilityContext =  (function () {
    function OAuthUtilityContext(serviceScope) {
        var _this = this;
        serviceScope.whenFinished(function () {
            _this._spHttpClient = serviceScope.consume(_spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_1__["default"].serviceKey);
            _this._logger = new TokenUtilityLogger();
        });
    }
    Object.defineProperty(OAuthUtilityContext.prototype, "logger", {
        get: function () {
            return this._logger;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OAuthUtilityContext.prototype, "webUrl", {
        get: function () {
            return '';
        },
        enumerable: true,
        configurable: true
    });
    OAuthUtilityContext.prototype.fetchWithDigest = function (request) {
        var _this = this;
        return request.blob().then(function (requestBody) {
            return _this._spHttpClient.fetch(request.url, _spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_1__["default"].configurations.v1, {
                method: request.method,
                headers: request.headers,
                body: requestBody
            });
        });
    };
    OAuthUtilityContext.prototype.qosMonitor = function () {
        return new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_QosMonitor"](OAuthUtilityContext.qosName);
    };
    OAuthUtilityContext.qosName = 'OAuthTokenProvider';
    return OAuthUtilityContext;
}());
/* harmony default export */ __webpack_exports__["default"] = (OAuthUtilityContext);


/***/ }),

/***/ "./lib/oauthTokenProvider/OBOTokenProvider.js":
/*!****************************************************!*\
  !*** ./lib/oauthTokenProvider/OBOTokenProvider.js ***!
  \****************************************************/
/*! exports provided: OBOTokenProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OBOTokenProvider", function() { return OBOTokenProvider; });
/* harmony import */ var _AadConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AadConstants */ "./lib/oauthTokenProvider/AadConstants.js");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../spHttpClient/SPHttpClient */ "./lib/spHttpClient/SPHttpClient.js");
/* harmony import */ var _AadErrorHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AadErrorHandler */ "./lib/oauthTokenProvider/AadErrorHandler.js");




var OBOTokenProvider =  (function () {
    function OBOTokenProvider(authContext, tokenParameters) {
        this.servicePrincipalId = authContext.config.clientId;
        this._patchAdalAuthContext(authContext);
        this._authContext = authContext;
        this._serverRelativeUrl = tokenParameters.serverRelativeUrl;
        this._spHttpClient = tokenParameters.spHttpClient;
    }
    OBOTokenProvider.prototype.getToken = function (resourceEndpoint, useCachedToken) {
        if (useCachedToken === void 0) { useCachedToken = true; }
        return this._getAccessToken(resourceEndpoint, useCachedToken);
    };
    OBOTokenProvider.prototype._getAccessToken = function (resourceEndpoint, useCachedToken) {
        var cachedAccessToken = this._tryGetCachedAccessToken(resourceEndpoint);
        if (useCachedToken && cachedAccessToken) {
            return Promise.resolve(cachedAccessToken);
        }
        else {
            return this._fetchAccessToken(resourceEndpoint);
        }
    };
    OBOTokenProvider.prototype._tryGetCachedAccessToken = function (resourceEndpoint) {
        var cachedToken;
        try {
            cachedToken = this._authContext.getCachedToken(resourceEndpoint);
        }
        catch (e) {
            _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__["_TraceLogger"].logError(OBOTokenProvider._logSource, e);
        }
        return cachedToken;
    };
    OBOTokenProvider.prototype._fetchAccessToken = function (resourceEndpoint) {
        var acquireAccessTokenQosMonitor = new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__["_QosMonitor"]('OBOTokenProvider.AcquireAccessToken');
        return this._fetchAccessTokenSilent(resourceEndpoint)
            .then(function (token) {
            acquireAccessTokenQosMonitor.writeSuccess();
            return token;
        })
            .catch(function (e) {
            if (_AadErrorHandler__WEBPACK_IMPORTED_MODULE_3__["AadErrorHandler"]._doesErrorCodeExist(e.message, _AadConstants__WEBPACK_IMPORTED_MODULE_0__["default"].UNRESOLVABLE_ERROR_CODES)) {
                acquireAccessTokenQosMonitor.writeExpectedFailure(e.message);
            }
            else {
                acquireAccessTokenQosMonitor.writeUnexpectedFailure(e.message);
            }
            throw e;
        });
    };
    OBOTokenProvider.prototype._fetchAccessTokenSilent = function (resourceEndpoint) {
        var urlToCall = this._serverRelativeUrl + "/_api/Microsoft.SharePoint.Internal" +
            (".ClientSideComponent.Token.AcquireOBOToken?resource='" + resourceEndpoint + "'") +
            ("&clientId='" + this._authContext.config.clientId + "'");
        return this._spHttpClient.get(urlToCall, _spHttpClient_SPHttpClient__WEBPACK_IMPORTED_MODULE_2__["default"].configurations.v1, {
            headers: {
                'X-HTTP-Method': 'GET',
                'OData-Version': '3.0'
            }
        })
            .then(function (response) {
            return response.ok ? response.json() : Promise.reject(response.json());
        })
            .then(function (json) {
            return JSON.parse(json.value).AccessToken;
        });
    };
    OBOTokenProvider.prototype._patchAdalAuthContext = function (authContext) {
        Object.getPrototypeOf(authContext)._singletonInstance = undefined;
    };
    OBOTokenProvider._logSource = _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_1__["_LogSource"].create('OBOTokenProvider');
    return OBOTokenProvider;
}());



/***/ }),

/***/ "./lib/spHttpClient/BatchedRequest.js":
/*!********************************************!*\
  !*** ./lib/spHttpClient/BatchedRequest.js ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var BatchedRequest =  (function () {
    function BatchedRequest(request) {
        var _this = this;
        this.response = undefined;
        this.request = request;
        this.promise = new Promise(
        function (resolve, reject) {
            _this._resolveCallback = resolve;
            _this._rejectCallback = reject;
        });
    }
    BatchedRequest.prototype.resolvePromise = function (response) {
        if (!this._resolveCallback) {
            throw new Error('The promise was already settled');
        }
        this.response = response;
        this._resolveCallback(response);
        this._resolveCallback = undefined;
        this._rejectCallback = undefined;
    };
    BatchedRequest.prototype.rejectPromiseIfNotResolved = function (error) {
        if (this.response) {
            return;
        }
        if (!this._rejectCallback) {
            throw new Error('The promise was already settled');
        }
        this._rejectCallback(error);
        this._resolveCallback = undefined;
        this._rejectCallback = undefined;
    };
    return BatchedRequest;
}());
/* harmony default export */ __webpack_exports__["default"] = (BatchedRequest);


/***/ }),

/***/ "./lib/spHttpClient/DigestCache.js":
/*!*****************************************!*\
  !*** ./lib/spHttpClient/DigestCache.js ***!
  \*****************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/FetchProvider */ "./lib/httpClient/FetchProvider.js");



var DigestCache =  (function () {
    function DigestCache(serviceScope) {
        var _this = this;
        this._digestsByUrl = new Map();
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(_httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_2__["fetchProviderServiceKey"]);
            _this._timeProvider = serviceScope.consume(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["TimeProvider"].serviceKey);
        });
    }
    DigestCache.prototype.fetchDigest = function (webUrl) {
        var _this = this;
        var normalizedWebUrl = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["UrlUtilities"].removeEndSlash(webUrl);
        var cachedDigest = this._digestsByUrl.get(normalizedWebUrl);
        if (cachedDigest) {
            var timestamp = this._timeProvider.getDate().getTime();
            if (timestamp < cachedDigest.expirationTimestamp) {
                _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logVerbose(DigestCache._logSource, 'DigestCache: Reusing cached digest.  Expiration: ' + cachedDigest.expirationTimestamp);
                return Promise.resolve(cachedDigest.value);
            }
        }
        var digestUrl = normalizedWebUrl + '/_api/contextinfo';
        var rawRequest = new Request(digestUrl, {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-type': 'application/json;odata=verbose;charset=utf-8'
            },
            credentials: 'same-origin',
            cache: 'no-cache'
        });
        var preFetchDigestTime = this._timeProvider.getDate().getTime();
        return this._fetchProvider.fetch(rawRequest).then(function (response) {
            return response.json();
        }).then(function (responseObject) {
            var digestValue = responseObject.FormDigestValue;
            var seconds = responseObject.FormDigestTimeoutSeconds;
            var expirationTimeMs = preFetchDigestTime +
                (1000 * seconds) -
                DigestCache.REST_EXPIRATION_SLOP_MS;
            _this.addDigestToCache(normalizedWebUrl, digestValue, expirationTimeMs);
            _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logVerbose(DigestCache._logSource, 'DigestCache: Fetched new digest');
            return digestValue;
        });
    };
    DigestCache.prototype.addDigestToCache = function (webUrl, digestValue, expirationTimestamp) {
        var currentTimestamp = this._timeProvider.getDate().getTime();
        if (currentTimestamp < expirationTimestamp) {
            var normalizedWebUrl = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["UrlUtilities"].removeEndSlash(webUrl);
            var newCachedDigest = {
                value: digestValue,
                expirationTimestamp: expirationTimestamp
            };
            this._digestsByUrl.set(normalizedWebUrl, newCachedDigest);
        }
    };
    DigestCache.prototype.clearDigest = function (webUrl) {
        var normalizedWebUrl = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["UrlUtilities"].removeEndSlash(webUrl);
        var found = this._digestsByUrl.delete(normalizedWebUrl);
        _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_TraceLogger"].logVerbose(DigestCache._logSource, "DigestCache: Requested to clear cache entry: " + (found ? 'found' : 'not found'));
        return found;
    };
    DigestCache.prototype.clearAllDigests = function () {
        this._digestsByUrl.clear();
    };
    DigestCache.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["ServiceKey"].create('sp-client-base:DigestCache', DigestCache);
    DigestCache.REST_EXPIRATION_SLOP_MS = 15000; 
    DigestCache._logSource = _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_LogSource"].create('DigestCache');
    return DigestCache;
}());
/* harmony default export */ __webpack_exports__["default"] = (DigestCache);


/***/ }),

/***/ "./lib/spHttpClient/ODataVersion.js":
/*!******************************************!*\
  !*** ./lib/spHttpClient/ODataVersion.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
var ODataVersion =  (function () {
    function ODataVersion(versionString) {
        this._versionString = versionString;
    }
    ODataVersion.tryParseFromHeaders = function (headers) {
        var oDataVersion;
        headers.forEach(function (value, name) {
            if (name.toUpperCase() === 'ODATA-VERSION') {
                oDataVersion = value.trim();
            }
        });
        if (oDataVersion === '3.0') {
            return ODataVersion.v3;
        }
        else if (oDataVersion === '4.0') {
            return ODataVersion.v4;
        }
        else if (oDataVersion) {
            throw new Error('Unsupported OData-Version header: ' + oDataVersion);
        }
        return undefined;
    };
    ODataVersion.prototype.toString = function () {
        return this._versionString;
    };
    ODataVersion.v3 = new ODataVersion('3.0');
    ODataVersion.v4 = new ODataVersion('4.0');
    return ODataVersion;
}());
/* harmony default export */ __webpack_exports__["default"] = (ODataVersion);


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClient.js":
/*!******************************************!*\
  !*** ./lib/spHttpClient/SPHttpClient.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-diagnostics */ "@microsoft/sp-diagnostics");
/* harmony import */ var _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _DigestCache__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DigestCache */ "./lib/spHttpClient/DigestCache.js");
/* harmony import */ var _httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../httpClient/FetchProvider */ "./lib/httpClient/FetchProvider.js");
/* harmony import */ var _SPHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SPHttpClientConfiguration */ "./lib/spHttpClient/SPHttpClientConfiguration.js");
/* harmony import */ var _SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SPHttpClientResponse */ "./lib/spHttpClient/SPHttpClientResponse.js");
/* harmony import */ var _SPHttpClientBatch__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SPHttpClientBatch */ "./lib/spHttpClient/SPHttpClientBatch.js");
/* harmony import */ var _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SPHttpClientHelper */ "./lib/spHttpClient/SPHttpClientHelper.js");
/* harmony import */ var _ODataVersion__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ODataVersion */ "./lib/spHttpClient/ODataVersion.js");









var SPHttpClient =  (function () {
    function SPHttpClient(serviceScope) {
        var _this = this;
        this._serviceScope = serviceScope;
        this._serviceScope.whenFinished(function () {
            _this._digestCache = serviceScope.consume(_DigestCache__WEBPACK_IMPORTED_MODULE_2__["default"].serviceKey);
            _this._parentSource = serviceScope.consume(_microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_logSourceServiceKey"]);
            _this._fetchProvider = serviceScope.consume(_httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_3__["fetchProviderServiceKey"]);
        });
    }
    SPHttpClient.getWebUrlFromRequestUrl = function (requestUrl) {
        var segmentIndex = -1;
        var upperCaseUrl = requestUrl.toUpperCase();
        for (var _i = 0, _a = SPHttpClient._reservedUrlSegments; _i < _a.length; _i++) {
            var reservedUrlSegment = _a[_i];
            segmentIndex = upperCaseUrl.indexOf(reservedUrlSegment);
            if (segmentIndex >= 0) {
                return requestUrl.substr(0, segmentIndex);
            }
        }
        throw new Error('Unable to determine web URL');
    };
    SPHttpClient.prototype.fetch = function (url, configuration, options) {
        var _this = this;
        if (!options) {
            options = {};
        }
        var modifiedOptions = Object.assign({}, options);
        if (configuration.defaultSameOriginCredentials) {
            if (!options.credentials) {
                modifiedOptions.credentials = 'same-origin';
            }
        }
        var headers = _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].cloneHeaders(options);
        modifiedOptions.headers = headers;
        if (configuration.defaultODataVersion) {
            if (!headers.has('OData-Version')) {
                headers.append('OData-Version', configuration.defaultODataVersion.toString());
            }
        }
        var oDataVersion = _ODataVersion__WEBPACK_IMPORTED_MODULE_8__["default"].tryParseFromHeaders(headers);
        _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].applyDefaultHeaders(headers, configuration, options, oDataVersion);
        if (configuration.requestDigest) {
            if (options.method) {
                var method = options.method.toUpperCase();
                if (method !== 'GET' && method !== 'HEAD' && method !== 'OPTIONS') {
                    if (!headers.has('X-RequestDigest')) {
                        var webUrl = options.webUrl || SPHttpClient.getWebUrlFromRequestUrl(url);
                        var promise = this._digestCache.fetchDigest(webUrl)
                            .then(function (digest) {
                            headers.append('X-RequestDigest', digest);
                            return _this._fetchWithInstrumentation(configuration, new Request(url, modifiedOptions));
                        });
                        return _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].handleAuthenticationErrors(promise, webUrl, this._digestCache)
                            .then(function (response) {
                            return new _SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_5__["default"](response);
                        });
                    }
                }
            }
        }
        return this._fetchWithInstrumentation(configuration, new Request(url, modifiedOptions))
            .then(function (response) {
            return new _SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_5__["default"](response);
        });
    };
    SPHttpClient.prototype.get = function (url, configuration, options) {
        return this.fetch(url, configuration, _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].overrideHttpMethod(options, 'GET'));
    };
    SPHttpClient.prototype.post = function (url, configuration, options) {
        return this.fetch(url, configuration, _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].overrideHttpMethod(options, 'POST'));
    };
    SPHttpClient.prototype.beginBatch = function (batchCreationOptions) {
        return new _SPHttpClientBatch__WEBPACK_IMPORTED_MODULE_6__["default"](this._serviceScope, batchCreationOptions);
    };
    SPHttpClient.prototype._fetchWithInstrumentation = function (configuration, request) {
        var _this = this;
        var qosMonitor = new _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_QosMonitor"](SPHttpClient._className);
        return _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].fetchCore(configuration, request, this._serviceScope, this._fetchProvider, SPHttpClient._className).then(function (response) {
            if (response.status >= 200 && response.status <= 299) {
                qosMonitor.writeSuccess({ source: _this._logSourceId });
            }
            else if (response.status >= 300 && response.status <= 399) {
                qosMonitor.writeExpectedFailure('Redirection', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            else if (response.status >= 400 && response.status <= 499) {
                qosMonitor.writeExpectedFailure('ClientError', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            else if (response.status >= 500 && response.status <= 599) {
                qosMonitor.writeExpectedFailure('ServerError', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            else {
                qosMonitor.writeUnexpectedFailure('Unknown', undefined, { source: _this._logSourceId, responseStatus: response.status });
            }
            return response;
        }).catch(function (error) {
            qosMonitor.writeUnexpectedFailure('FetchError', error, { source: _this._logSourceId });
            throw error;
        });
    };
    Object.defineProperty(SPHttpClient.prototype, "_logSourceId", {
        get: function () {
            if (this._parentSource.isEmpty()) {
                return SPHttpClient._logSource.id;
            }
            return this._parentSource.id;
        },
        enumerable: true,
        configurable: true
    });
    SPHttpClient.configurations = _SPHttpClientConfiguration__WEBPACK_IMPORTED_MODULE_4__["predefinedConfigurations"];
    SPHttpClient.serviceKey = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["ServiceKey"].create('sp-http:SPHttpClient', SPHttpClient);
    SPHttpClient._className = 'SPHttpClient';
    SPHttpClient._logSource = _microsoft_sp_diagnostics__WEBPACK_IMPORTED_MODULE_0__["_LogSource"].create('spHttpClient');
    SPHttpClient._reservedUrlSegments = [
        '/_API/',
        '/_LAYOUTS/',
        '/_VTI_BIN/'
    ];
    return SPHttpClient;
}());
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClient);


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClientBatch.js":
/*!***********************************************!*\
  !*** ./lib/spHttpClient/SPHttpClientBatch.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _common_KillSwitches__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/KillSwitches */ "./lib/common/KillSwitches.js");
/* harmony import */ var _BatchedRequest__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BatchedRequest */ "./lib/spHttpClient/BatchedRequest.js");
/* harmony import */ var _SPHttpClient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SPHttpClient */ "./lib/spHttpClient/SPHttpClient.js");
/* harmony import */ var _SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SPHttpClientResponse */ "./lib/spHttpClient/SPHttpClientResponse.js");
/* harmony import */ var _httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../httpClient/FetchProvider */ "./lib/httpClient/FetchProvider.js");
/* harmony import */ var _DigestCache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./DigestCache */ "./lib/spHttpClient/DigestCache.js");
/* harmony import */ var _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SPHttpClientHelper */ "./lib/spHttpClient/SPHttpClientHelper.js");
/* harmony import */ var _ODataVersion__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ODataVersion */ "./lib/spHttpClient/ODataVersion.js");
/* harmony import */ var _SPHttpClientBatchConfiguration__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./SPHttpClientBatchConfiguration */ "./lib/spHttpClient/SPHttpClientBatchConfiguration.js");










var SPHttpClientBatch =  (function () {
    function SPHttpClientBatch(serviceScope, batchCreationOptions) {
        var _this = this;
        this._batchedRequests = [];
        serviceScope.whenFinished(function () {
            _this._fetchProvider = serviceScope.consume(_httpClient_FetchProvider__WEBPACK_IMPORTED_MODULE_5__["fetchProviderServiceKey"]);
            _this._randomNumberGenerator = serviceScope.consume(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["RandomNumberGenerator"].serviceKey);
            _this._digestCache = serviceScope.consume(_DigestCache__WEBPACK_IMPORTED_MODULE_6__["default"].serviceKey);
        });
    }
    SPHttpClientBatch.prototype.fetch = function (url, configuration, options) {
        if (!options) {
            options = {};
        }
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.headers = _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].cloneHeaders(options);
        _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].applyDefaultHeaders(modifiedOptions.headers, configuration, options, _ODataVersion__WEBPACK_IMPORTED_MODULE_8__["default"].v4);
        var request = new Request(url, modifiedOptions);
        var requestUrl = request.url;
        if (!this._webUrl) {
            this._webUrl = _SPHttpClient__WEBPACK_IMPORTED_MODULE_3__["default"].getWebUrlFromRequestUrl(requestUrl);
        }
        var batchedRequest = new _BatchedRequest__WEBPACK_IMPORTED_MODULE_2__["default"](request);
        this._batchedRequests.push(batchedRequest);
        return batchedRequest.promise;
    };
    SPHttpClientBatch.prototype.get = function (url, configuration, options) {
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.method = 'GET';
        return this.fetch(url, configuration, modifiedOptions);
    };
    SPHttpClientBatch.prototype.post = function (url, configuration, options) {
        var modifiedOptions = Object.assign({}, options);
        modifiedOptions.method = 'POST';
        return this.fetch(url, configuration, modifiedOptions);
    };
    SPHttpClientBatch.prototype.execute = function () {
        var _this = this;
        this._correlationId = undefined;
        this._batchResponseBody = undefined;
        var batchBody = '\n';
        var batchGuid = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_0__["Guid"].newGuid(this._randomNumberGenerator);
        var chain = Promise.resolve();
        this._batchedRequests.forEach(function (batchedRequest) {
            chain = chain.then(function () {
                return batchedRequest.request.text();
            }).then(function (requestText) {
                var request = batchedRequest.request;
                batchBody += "--batch_" + batchGuid.toString() + "\n";
                batchBody += "Content-type: application/http\n"
                    + "Content-Transfer-Encoding: binary\n\n";
                batchBody += request.method + " " + request.url + " HTTP/1.1\n";
                request.headers.forEach(function (value, name) {
                    batchBody += name + ": " + value + "\n";
                });
                batchBody += '\n';
                batchBody += requestText;
                batchBody += '\n\n';
            });
        });
        return chain
            .then(function () {
            batchBody += "--batch_" + batchGuid + "--\n\n";
            return _this._digestCache.fetchDigest(_this._webUrl);
        })
            .then(function (digest) {
            var headers = new Headers();
            headers.append('Accept', 'application/json');
            headers.append('OData-Version', '4.0');
            headers.append('Content-Type', "multipart/mixed; boundary=batch_" + batchGuid);
            headers.append('Content-Length', batchBody.length.toString());
            headers.append('X-RequestDigest', digest);
            var request = new Request(_this._webUrl + '/_api/$batch', {
                method: 'POST',
                headers: headers,
                body: batchBody,
                credentials: 'same-origin',
                cache: 'no-cache'
            });
            var promise = _this._fetchProvider.fetch(request);
            return _SPHttpClientHelper__WEBPACK_IMPORTED_MODULE_7__["default"].handleAuthenticationErrors(promise, _this._webUrl, _this._digestCache);
        })
            .then(function (response) {
            _this._correlationId = response.headers.get('sprequestguid') || undefined;
            if (!response.ok) {
                throw new Error('SPHttpClientBatch: The batch request failed: ' + response.statusText);
            }
            return response.text();
        })
            .then(function (text) {
            _this._batchResponseBody = text;
            var responses = _this._parseResponsesFromBody(text);
            if (responses.length !== _this._batchedRequests.length) {
                throw new Error("SPHttpClientBatch: Expecting " + _this._batchedRequests.length + " responses");
            }
            for (var i = 0; i < _this._batchedRequests.length; ++i) {
                var request = _this._batchedRequests[i];
                request.resolvePromise(new _SPHttpClientResponse__WEBPACK_IMPORTED_MODULE_4__["default"](responses[i]));
            }
            return _this;
        })
            .catch(function (executeError) {
            for (var _i = 0, _a = _this._batchedRequests; _i < _a.length; _i++) {
                var request = _a[_i];
                request.rejectPromiseIfNotResolved(executeError);
            }
            return Promise.reject(executeError);
        });
    };
    SPHttpClientBatch.prototype.correlationId = function () {
        return this._correlationId;
    };
    SPHttpClientBatch.prototype.batchResponseBody = function () {
        return this._batchResponseBody;
    };
    SPHttpClientBatch.prototype._parseResponsesFromBody = function (text) {
        var responses = [];
        var header = '--batchresponse_';
        var statusRegExp = new RegExp('^HTTP/[0-9.]+ +([0-9]+) +(.*)', 'i');
        var lines = text.split('\n');
        var parserState = 'batch';
        var batchStatus;
        var batchStatusText;
        for (var i = 0; i < lines.length; ++i) {
            var line = lines[i];
            switch (parserState) {
                case 'batch':
                    if (line.substr(0, header.length) === header) {
                        parserState = 'batchHeaders';
                    }
                    else {
                        if (line.trim() !== '') {
                            throw new Error('SPHttpClientBatch: Invalid response, line ' + i);
                        }
                    }
                    break;
                case 'batchHeaders':
                    if (line.trim() === '') {
                        parserState = 'status';
                    }
                    break;
                case 'status':
                    var parts = statusRegExp.exec(line);
                    if (!parts || parts && parts.length !== 3) {
                        throw new Error('SPHttpClientBatch: Invalid status, line ' + i);
                    }
                    batchStatus = parseInt(parts[1], 10);
                    batchStatusText = parts[2];
                    parserState = 'statusHeaders';
                    break;
                case 'statusHeaders':
                    if (line.trim() === '') {
                        parserState = 'body';
                    }
                    break;
                case 'body':
                    var responseBody = void 0;
                    if (_common_KillSwitches__WEBPACK_IMPORTED_MODULE_1__["default"].isNullBodyStatusKillSwitchActivated() ||
                        (batchStatus !== 204 && 
                            batchStatus !== 205 && 
                            batchStatus !== 304 
                        )) {
                        responseBody = line;
                    }
                    else if (!_common_KillSwitches__WEBPACK_IMPORTED_MODULE_1__["default"].isFixEdgeNullBodyStatusKillSwitchActivated()) {
                        responseBody = null; 
                    }
                    else {
                        responseBody = undefined;
                    }
                    var response = void 0;
                    if (!_common_KillSwitches__WEBPACK_IMPORTED_MODULE_1__["default"].isExposeCorrelationIdAndResponseBodyKillSwitchActivated()) {
                        var headers = new Headers();
                        headers.append('request-id', this._correlationId || '');
                        response = new Response(responseBody, { status: batchStatus, statusText: batchStatusText, headers: headers });
                    }
                    else {
                        response = new Response(responseBody, { status: batchStatus, statusText: batchStatusText });
                    }
                    responses.push(response);
                    parserState = 'batch';
                    break;
            }
        }
        if (parserState !== 'status') {
            throw new Error('SPHttpClientBatch: Unexpected end of input');
        }
        return responses;
    };
    SPHttpClientBatch.configurations = _SPHttpClientBatchConfiguration__WEBPACK_IMPORTED_MODULE_9__["predefinedConfigurations"];
    return SPHttpClientBatch;
}());
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClientBatch);


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClientBatchConfiguration.js":
/*!************************************************************!*\
  !*** ./lib/spHttpClient/SPHttpClientBatchConfiguration.js ***!
  \************************************************************/
/*! exports provided: default, predefinedConfigurations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "predefinedConfigurations", function() { return predefinedConfigurations; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _SPHttpClientCommonConfiguration__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SPHttpClientCommonConfiguration */ "./lib/spHttpClient/SPHttpClientCommonConfiguration.js");
/* harmony import */ var _httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClient */ "./lib/httpClient/HttpClient.js");



var SPHttpClientBatchConfiguration =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SPHttpClientBatchConfiguration, _super);
    function SPHttpClientBatchConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    SPHttpClientBatchConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new SPHttpClientBatchConfiguration(this.flags, sourceFlags);
    };
    SPHttpClientBatchConfiguration.prototype.initializeFlags = function () {
        _super.prototype.initializeFlags.call(this);
    };
    return SPHttpClientBatchConfiguration;
}(_SPHttpClientCommonConfiguration__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClientBatchConfiguration);
var predefinedConfigurations = {
    v1: new SPHttpClientBatchConfiguration(_httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_2__["default"].configurations.v1, {
        jsonRequest: true,
        jsonResponse: true
    })
};


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClientCommonConfiguration.js":
/*!*************************************************************!*\
  !*** ./lib/spHttpClient/SPHttpClientCommonConfiguration.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../httpClient/HttpClientConfiguration */ "./lib/httpClient/HttpClientConfiguration.js");


var SPHttpClientCommonConfiguration =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SPHttpClientCommonConfiguration, _super);
    function SPHttpClientCommonConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    SPHttpClientCommonConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new SPHttpClientCommonConfiguration(this.flags, sourceFlags);
    };
    Object.defineProperty(SPHttpClientCommonConfiguration.prototype, "jsonRequest", {
        get: function () {
            return this.flags.jsonRequest;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientCommonConfiguration.prototype, "jsonResponse", {
        get: function () {
            return this.flags.jsonResponse;
        },
        enumerable: true,
        configurable: true
    });
    SPHttpClientCommonConfiguration.prototype.initializeFlags = function () {
        _super.prototype.initializeFlags.call(this);
        this.flags.jsonRequest = false;
        this.flags.jsonResponse = false;
    };
    return SPHttpClientCommonConfiguration;
}(_httpClient_HttpClientConfiguration__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClientCommonConfiguration);


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClientConfiguration.js":
/*!*******************************************************!*\
  !*** ./lib/spHttpClient/SPHttpClientConfiguration.js ***!
  \*******************************************************/
/*! exports provided: default, predefinedConfigurations */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "predefinedConfigurations", function() { return predefinedConfigurations; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _SPHttpClientCommonConfiguration__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SPHttpClientCommonConfiguration */ "./lib/spHttpClient/SPHttpClientCommonConfiguration.js");
/* harmony import */ var _ODataVersion__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ODataVersion */ "./lib/spHttpClient/ODataVersion.js");
/* harmony import */ var _httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../httpClient/HttpClient */ "./lib/httpClient/HttpClient.js");




var SPHttpClientConfiguration =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SPHttpClientConfiguration, _super);
    function SPHttpClientConfiguration(flags, overrideFlags) {
        return _super.call(this, flags, overrideFlags) || this;
    }
    SPHttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {
        return new SPHttpClientConfiguration(this.flags, sourceFlags);
    };
    Object.defineProperty(SPHttpClientConfiguration.prototype, "defaultSameOriginCredentials", {
        get: function () {
            return this.flags.defaultSameOriginCredentials;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientConfiguration.prototype, "defaultODataVersion", {
        get: function () {
            return this.flags.defaultODataVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientConfiguration.prototype, "requestDigest", {
        get: function () {
            return this.flags.requestDigest;
        },
        enumerable: true,
        configurable: true
    });
    SPHttpClientConfiguration.prototype.initializeFlags = function () {
        _super.prototype.initializeFlags.call(this);
        this.flags.defaultSameOriginCredentials = false;
        this.flags.defaultODataVersion = _ODataVersion__WEBPACK_IMPORTED_MODULE_2__["default"].v3;
        this.flags.requestDigest = false;
    };
    return SPHttpClientConfiguration;
}(_SPHttpClientCommonConfiguration__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClientConfiguration);
var predefinedConfigurations = {
    v1: new SPHttpClientConfiguration(_httpClient_HttpClient__WEBPACK_IMPORTED_MODULE_3__["default"].configurations.v1, {
        jsonRequest: true,
        jsonResponse: true,
        defaultSameOriginCredentials: true,
        defaultODataVersion: _ODataVersion__WEBPACK_IMPORTED_MODULE_2__["default"].v4,
        requestDigest: true
    })
};


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClientHelper.js":
/*!************************************************!*\
  !*** ./lib/spHttpClient/SPHttpClientHelper.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ODataVersion__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ODataVersion */ "./lib/spHttpClient/ODataVersion.js");
/* harmony import */ var _httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClientHelper */ "./lib/httpClient/HttpClientHelper.js");



var SPHttpClientHelper =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SPHttpClientHelper, _super);
    function SPHttpClientHelper() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SPHttpClientHelper.cloneHeaders = function (options) {
        var clonedHeaders = new Headers();
        var temp = new Request('', { headers: options.headers || {} });
        temp.headers.forEach(function (value, name) {
            clonedHeaders.append(name, value); 
        });
        return clonedHeaders;
    };
    SPHttpClientHelper.applyDefaultHeaders = function (headers, configuration, options, oDataVersion) {
        if (configuration.jsonRequest) {
            if (options.method && options.method.toUpperCase() !== 'GET') {
                if (!headers.has('Content-Type')) {
                    if (oDataVersion === _ODataVersion__WEBPACK_IMPORTED_MODULE_1__["default"].v3) {
                        headers.append('Content-Type', 'application/json;odata=verbose;charset=utf-8');
                    }
                    else if (oDataVersion === _ODataVersion__WEBPACK_IMPORTED_MODULE_1__["default"].v4) {
                        headers.append('Content-Type', 'application/json;charset=utf-8');
                    }
                    else {
                        throw new Error('ISPHttpClientConfiguration.jsonRequest is enabled, which requires'
                            + ' the "OData-Version" header to be 3.0 or 4.0');
                    }
                }
            }
        }
        if (configuration.jsonResponse) {
            if (!headers.has('Accept')) {
                if (oDataVersion === _ODataVersion__WEBPACK_IMPORTED_MODULE_1__["default"].v3) {
                    headers.append('Accept', 'application/json');
                }
                else if (oDataVersion === _ODataVersion__WEBPACK_IMPORTED_MODULE_1__["default"].v4) {
                    headers.append('Accept', 'application/json;odata.metadata=minimal');
                }
                else {
                    throw new Error('ISPHttpClientConfiguration.jsonResponse is enabled, which requires'
                        + ' the "OData-Version" header to be 3.0 or 4.0');
                }
            }
        }
    };
    SPHttpClientHelper.handleAuthenticationErrors = function (promise, webUrl, digestCache) {
        return promise.then(function (response) {
            if (response.status === 403) {
                digestCache.clearDigest(webUrl);
            }
            return response;
        });
    };
    return SPHttpClientHelper;
}(_httpClient_HttpClientHelper__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClientHelper);


/***/ }),

/***/ "./lib/spHttpClient/SPHttpClientResponse.js":
/*!**************************************************!*\
  !*** ./lib/spHttpClient/SPHttpClientResponse.js ***!
  \**************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.9.3/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-core-library */ "@microsoft/sp-core-library");
/* harmony import */ var _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../httpClient/HttpClientResponse */ "./lib/httpClient/HttpClientResponse.js");



var SPHttpClientResponse =  (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SPHttpClientResponse, _super);
    function SPHttpClientResponse(response) {
        return _super.call(this, response) || this;
    }
    SPHttpClientResponse.prototype.clone = function () {
        return new SPHttpClientResponse(this.nativeResponse.clone());
    };
    Object.defineProperty(SPHttpClientResponse.prototype, "correlationId", {
        get: function () {
            if (!this._correlationId) {
                this._correlationId = _microsoft_sp_core_library__WEBPACK_IMPORTED_MODULE_1__["Guid"].tryParse(this.headers.get("SPRequestGuid" ));
            }
            return this._correlationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPHttpClientResponse.prototype, "statusMessage", {
        get: function () {
            var correlationId = this.headers.get('sprequestguid') || '';
            var spVersion = this.headers.get('microsoftsharepointteamservices') || '';
            return "[HTTP]:" + this.status + " - " + this.statusText + " [CorrelationId]:" + correlationId + " [Version]:" + spVersion;
        },
        enumerable: true,
        configurable: true
    });
    return SPHttpClientResponse;
}(_httpClient_HttpClientResponse__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SPHttpClientResponse);


/***/ }),

/***/ "@microsoft/sp-core-library":
/*!*********************************************!*\
  !*** external "@microsoft/sp-core-library" ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__microsoft_sp_core_library__;

/***/ }),

/***/ "@microsoft/sp-diagnostics":
/*!********************************************!*\
  !*** external "@microsoft/sp-diagnostics" ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__microsoft_sp_diagnostics__;

/***/ }),

/***/ "resx-strings":
/*!*******************************!*\
  !*** external "resx-strings" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_resx_strings__;

/***/ })

/******/ })}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));;


/***/ }),

/***/ "@microsoft/sp-core-library":
/*!*********************************************!*\
  !*** external "@microsoft/sp-core-library" ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__microsoft_sp_core_library__;

/***/ }),

/***/ "@microsoft/sp-diagnostics":
/*!********************************************!*\
  !*** external "@microsoft/sp-diagnostics" ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__microsoft_sp_diagnostics__;

/***/ })

/******/ })});;
//# sourceMappingURL=sp-http_en-us.js.map
(function(){
if (!window.__setWebpackPublicPathLoaderSrcRegistry__) window.__setWebpackPublicPathLoaderSrcRegistry__={};
var scripts = document.getElementsByTagName('script');
if (scripts && scripts.length) {
  for (var i = 0; i < scripts.length; i++) {
    if (!scripts[i]) continue;
    var path = scripts[i].getAttribute('src');
    if (path) window.__setWebpackPublicPathLoaderSrcRegistry__[path]=true;
  }
}
})();